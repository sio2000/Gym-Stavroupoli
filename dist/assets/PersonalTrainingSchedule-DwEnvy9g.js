import{d as L,u as E,r as l,z as p,s as N,j as e,n as k,b as y,U as C,e as R,q as b,D as T,T as U}from"./index-DKfP5R6K.js";import{Z as M}from"./zap-C_tGDRDL.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),O=()=>{console.log("[PersonalTrainingSchedule] Component rendering");const{user:a}=E();console.log("[PersonalTrainingSchedule] User from useAuth:",a==null?void 0:a.email,"ID:",a==null?void 0:a.id);const[t,i]=l.useState(null),[d,o]=l.useState(!0),[S,w]=l.useState(!1),[j,x]=l.useState(!1),m=l.useRef(!1),[u,h]=l.useState(null),v=["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"];l.useEffect(()=>{if(console.log("[PersonalTrainingSchedule] ===== USEEFFECT TRIGGERED ====="),console.log("[PersonalTrainingSchedule] User:",a==null?void 0:a.email,"ID:",a==null?void 0:a.id),console.log("[PersonalTrainingSchedule] User object:",a),console.log("[PersonalTrainingSchedule] hasLoadedRef.current:",m.current),console.log("[PersonalTrainingSchedule] isLoading:",j),console.log("[PersonalTrainingSchedule] loading state:",d),u&&(console.log("[PersonalTrainingSchedule] Clearing existing timeout"),clearTimeout(u),h(null)),!a){console.log("[PersonalTrainingSchedule] No user, resetting hasLoadedRef and stopping loading"),m.current=!1,o(!1);return}if(m.current){console.log("[PersonalTrainingSchedule] Already loaded for this user, skipping");return}console.log("[PersonalTrainingSchedule] Starting load for user:",a.email),m.current=!0,P(),console.log("[PersonalTrainingSchedule] Setting 10 second timeout");const s=setTimeout(()=>{console.warn("[PersonalTrainingSchedule] Load timeout reached, stopping loading"),o(!1),x(!1)},1e4);return h(s),()=>{console.log("[PersonalTrainingSchedule] useEffect cleanup"),s&&clearTimeout(s)}},[a]);const P=async()=>{if(console.log("[PersonalTrainingSchedule] ===== LOADING STARTED ====="),console.log("[PersonalTrainingSchedule] User ID:",a==null?void 0:a.id),console.log("[PersonalTrainingSchedule] User email:",a==null?void 0:a.email),j){console.log("[PersonalTrainingSchedule] Already loading, skipping...");return}x(!0);try{if(o(!0),!(a!=null&&a.id)){console.error("[PersonalTrainingSchedule] No user ID found"),p.error("Δεν βρέθηκε χρήστης. Κάντε επανασύνδεση."),i(null);return}console.log("[PersonalTrainingSchedule] Querying personal_training_schedules...");const{data:s,error:g}=await N.from("personal_training_schedules").select("id,user_id,month,year,schedule_data,status,created_by,created_at,updated_at,trainer_name,accepted_at,declined_at").eq("user_id",a.id).order("created_at",{ascending:!1}).limit(1);if(console.log("[PersonalTrainingSchedule] Query result - data:",s,"error:",g),g){console.error("[PersonalTrainingSchedule] Query error:",g),p.error(`Σφάλμα βάσης δεδομένων: ${g.message}`),i(null);return}if(s&&s.length>0){console.log("[PersonalTrainingSchedule] Found schedule data:",s[0]);const r=s[0],n={id:r.id,userId:r.user_id,month:r.month,year:r.year,scheduleData:r.schedule_data,status:r.status,createdBy:r.created_by,createdAt:r.created_at,updatedAt:r.updated_at,acceptedAt:r.accepted_at,declinedAt:r.declined_at};if(console.log("[PersonalTrainingSchedule] Loaded schedule:",n),n.status==="pending")try{const c=new Date().toISOString(),{error:f}=await N.from("personal_training_schedules").update({status:"accepted",accepted_at:c,updated_at:c}).eq("id",n.id);f?console.error("[PersonalTrainingSchedule] Auto-accept update error:",f):(n.status="accepted",n.acceptedAt=c,n.updatedAt=c)}catch(c){console.error("[PersonalTrainingSchedule] Auto-accept exception:",c)}i(n)}else console.log("[PersonalTrainingSchedule] No schedule found for user"),i(null)}catch(s){console.error("[PersonalTrainingSchedule] Exception while loading schedule:",s),p.error("Σφάλμα κατά τη φόρτωση του προγράμματος"),i(null)}finally{console.log("[PersonalTrainingSchedule] ===== LOADING COMPLETED ====="),o(!1),x(!1),u&&(clearTimeout(u),h(null))}},D=s=>{switch(s){case"personal":return e.jsx(T,{className:"h-5 w-5 text-blue-600"});case"kickboxing":return e.jsx(M,{className:"h-5 w-5 text-red-600"});case"combo":return e.jsx(U,{className:"h-5 w-5 text-green-600"});default:return e.jsx(T,{className:"h-5 w-5 text-gray-600"})}},_=s=>{switch(s){case"personal":return"Personal Training";case"kickboxing":return"Kick Boxing";case"combo":return"Combo Training";default:return s}},A=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"accepted":return"bg-green-100 text-green-800";case"declined":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},I=s=>{switch(s){case"pending":return"Εκκρεμεί Απόφαση";case"accepted":return"Αποδεκτό";case"declined":return"Απορρίφθηκε";default:return s}};return console.log("[PersonalTrainingSchedule] Rendering - loading:",d,"user:",a==null?void 0:a.email,"schedule:",!!t),d?(console.log("[PersonalTrainingSchedule] Rendering loading screen"),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Φόρτωση προγράμματος..."}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["User: ",(a==null?void 0:a.email)||"No user"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Loading state: ",d?"true":"false"]})]})})):t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Πρόγραμμα Personal Training"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[v[t.month-1]," ",t.year]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${A(t.status)}`,children:I(t.status)})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Προγραμματισμένες Σεσίες"}),t.scheduleData.sessions.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(y,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"Δεν υπάρχουν προγραμματισμένες σεσίες"})]}):e.jsx("div",{className:"space-y-4",children:t.scheduleData.sessions.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:D(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:_(s.type)}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.startTime," - ",s.endTime]})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("el-GR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx("span",{children:s.trainer})]}),s.room&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx("span",{children:"📍"}),e.jsx("span",{children:s.room})]}),s.notes&&e.jsxs("div",{className:"flex items-start space-x-2 text-sm text-gray-600 mt-2",children:[e.jsx(q,{className:"h-4 w-4 mt-0.5"}),e.jsx("span",{children:s.notes})]})]})]})]})},s.id))})]}),(t.scheduleData.notes||t.scheduleData.specialInstructions)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Πληροφορίες Προγράμματος"}),e.jsxs("div",{className:"space-y-4",children:[t.scheduleData.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Σημειώσεις"}),e.jsx("p",{className:"text-gray-600",children:t.scheduleData.notes})]}),t.scheduleData.specialInstructions&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Ειδικές Οδηγίες"}),e.jsx("p",{className:"text-gray-600",children:t.scheduleData.specialInstructions})]})]})]}),t.status==="accepted"&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-green-900",children:"Πρόγραμμα Αποδεκτό"}),e.jsx("p",{className:"text-green-700 mt-1",children:"Το πρόγραμμα έχει γίνει αποδεκτό! Θα λάβετε ειδοποιήσεις για τις προπονήσεις σας."})]})]})}),t.status==="declined"&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(b,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-900",children:"Πρόγραμμα Απορριφθέν"}),e.jsx("p",{className:"text-red-700 mt-1",children:"Παρακαλώ περάστε από το γυμναστήριο για να συζητήσουμε τις ώρες που σας βολεύουν."})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-12 w-12 text-red-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Πρόγραμμα Απορρίφθηκε"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Παρακαλώ περάστε από το γυμναστήριο για να συζητήσουμε τις ώρες που σας βολεύουν."}),e.jsx("button",{onClick:()=>w(!1),className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Κατάλαβα"})]})})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Δεν βρέθηκε πρόγραμμα"}),e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχει διαθέσιμο πρόγραμμα Personal Training για εσάς."})]})})};export{O as default};
