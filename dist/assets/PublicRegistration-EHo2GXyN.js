import{d as H,r as c,G as o,z as d,j as e,e as y,E,A as D}from"./index-DKfP5R6K.js";import{A as J}from"./award-BgVyqLj7.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=H("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),W=()=>{var k,C,P,S;const[s,h]=c.useState({email:"",password:"",confirmPassword:"",first_name:"",last_name:"",phone:"",date_of_birth:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",language:"el",selectedPackage:"",selectedDuration:"",acceptTerms:!1,acceptPrivacy:!1,acceptMarketing:!1}),[b,q]=c.useState([]),[m,F]=c.useState([]),[f,j]=c.useState(!1),[g,$]=c.useState(!1),[p,A]=c.useState(!1),[n,N]=c.useState(1),[R,M]=c.useState(!1),w=[{id:1,title:"Προσωπικά Στοιχεία",description:"Βασικές πληροφορίες"},{id:2,title:"Επιλογή Πακέτου",description:"Συνδρομή και διάρκεια"},{id:3,title:"Επιβεβαίωση",description:"Έλεγχος και υποβολή"}];c.useEffect(()=>{T()},[]);const T=async()=>{try{const{data:r,error:a}=await o.from("membership_packages").select("*").eq("is_active",!0).order("name");if(a)throw a;q(r||[])}catch(r){console.error("Error loading packages:",r),d.error("Σφάλμα κατά τη φόρτωση των πακέτων")}},z=async r=>{try{const{data:a,error:l}=await o.from("membership_package_durations").select("*").eq("package_id",r).eq("is_active",!0).order("duration_days");if(l)throw l;F(a||[])}catch(a){console.error("Error loading package durations:",a),d.error("Σφάλμα κατά τη φόρτωση των επιλογών διάρκειας")}},t=r=>{const{name:a,value:l,type:x}=r.target,i=r.target.checked;h(u=>({...u,[a]:x==="checkbox"?i:l}))},G=r=>{h(a=>({...a,selectedPackage:r,selectedDuration:""})),z(r)},v=r=>{switch(r){case 1:return!!(s.email&&s.password&&s.confirmPassword&&s.first_name&&s.last_name&&s.phone&&s.password===s.confirmPassword);case 2:return!!(s.selectedPackage&&s.selectedDuration);case 3:return s.acceptTerms&&s.acceptPrivacy;default:return!1}},L=()=>{v(n)?N(r=>r+1):d.error("Παρακαλώ συμπληρώστε όλα τα απαραίτητα πεδία")},B=()=>{N(r=>r-1)},I=async r=>{if(r.preventDefault(),!v(3)){d.error("Παρακαλώ συμπληρώστε όλα τα απαραίτητα πεδία");return}j(!0);try{const{data:a,error:l}=await o.auth.signUp({email:s.email,password:s.password,options:{data:{first_name:s.first_name,last_name:s.last_name,language:s.language}}});if(l)throw l;if(!a.user)throw new Error("Failed to create user");const{error:x}=await o.from("user_profiles").insert([{user_id:a.user.id,email:s.email,first_name:s.first_name,last_name:s.last_name,phone:s.phone,date_of_birth:s.date_of_birth||null,address:s.address,emergency_contact_name:s.emergency_contact_name,emergency_contact_phone:s.emergency_contact_phone,language:s.language,role:"user"}]);if(x)throw x;const i=m.find(U=>U.id===s.selectedDuration);if(!i)throw new Error("Selected duration not found");const{error:u}=await o.from("membership_requests").insert([{user_id:a.user.id,package_id:s.selectedPackage,duration_type:i.duration_type,requested_price:i.price,classes_count:i.classes_count,status:"pending"}]);if(u)throw u;M(!0),d.success("Η εγγραφή σας ολοκληρώθηκε επιτυχώς! Θα ενημερωθείτε για την έγκριση.")}catch(a){console.error("Error during registration:",a),d.error("Σφάλμα κατά την εγγραφή. Παρακαλώ δοκιμάστε ξανά.")}finally{j(!1)}},O=()=>b.find(r=>r.id===s.selectedPackage),_=()=>m.find(r=>r.id===s.selectedDuration);return R?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(y,{className:"h-10 w-10 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Εγγραφή Ολοκληρώθηκε!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Η εγγραφή σας υποβλήθηκε επιτυχώς. Θα ενημερωθείτε μέσω email για την έγκριση του αιτήματός σας."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors",children:"Συνδεθείτε"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full border border-gray-300 text-gray-700 py-3 px-6 rounded-lg hover:bg-gray-50 transition-colors",children:"Αρχική Σελίδα"})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Εγγραφή στο FreeGym"}),e.jsx("p",{className:"text-gray-600",children:"Γίνετε μέλος της οικογένειάς μας και ξεκινήστε το ταξίδι σας προς την υγεία"})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-center space-x-4",children:w.map((r,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${n>=r.id?"bg-primary-600 border-primary-600 text-white":"bg-white border-gray-300 text-gray-500"}`,children:n>r.id?e.jsx(y,{className:"h-5 w-5"}):e.jsx("span",{className:"text-sm font-semibold",children:r.id})}),e.jsxs("div",{className:"ml-3 hidden sm:block",children:[e.jsx("p",{className:`text-sm font-medium ${n>=r.id?"text-primary-600":"text-gray-500"}`,children:r.title}),e.jsx("p",{className:"text-xs text-gray-500",children:r.description})]}),a<w.length-1&&e.jsx("div",{className:`w-8 h-0.5 mx-4 ${n>r.id?"bg-primary-600":"bg-gray-300"}`})]},r.id))})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:e.jsxs("form",{onSubmit:I,children:[n===1&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Προσωπικά Στοιχεία"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Όνομα *"}),e.jsx("input",{type:"text",name:"first_name",value:s.first_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Επώνυμο *"}),e.jsx("input",{type:"text",name:"last_name",value:s.last_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Τηλέφωνο *"}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Κωδικός Πρόσβασης *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:g?"text":"password",name:"password",value:s.password,onChange:t,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"button",onClick:()=>$(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:g?e.jsx(E,{className:"h-5 w-5"}):e.jsx(D,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Επιβεβαίωση Κωδικού *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:t,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"button",onClick:()=>A(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?e.jsx(E,{className:"h-5 w-5"}):e.jsx(D,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ημερομηνία Γέννησης"}),e.jsx("input",{type:"date",name:"date_of_birth",value:s.date_of_birth,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Γλώσσα"}),e.jsxs("select",{name:"language",value:s.language,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"el",children:"Ελληνικά"}),e.jsx("option",{value:"en",children:"English"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Διεύθυνση"}),e.jsx("textarea",{name:"address",value:s.address,onChange:t,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Περιγράψτε την διεύθυνσή σας..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Όνομα Επικοινωνίας Έκτακτης Ανάγκης"}),e.jsx("input",{type:"text",name:"emergency_contact_name",value:s.emergency_contact_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Τηλέφωνο Επικοινωνίας Έκτακτης Ανάγκης"}),e.jsx("input",{type:"tel",name:"emergency_contact_phone",value:s.emergency_contact_phone,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),n===2&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Επιλογή Πακέτου"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:b.map(r=>{var a;return e.jsx("div",{className:`border-2 rounded-xl p-6 cursor-pointer transition-all ${s.selectedPackage===r.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,onClick:()=>G(r.id),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(J,{className:"h-8 w-8 text-primary-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:r.name}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),e.jsxs("div",{className:"text-2xl font-bold text-primary-600 mb-4",children:["€",((a=r.price)==null?void 0:a.toFixed(2))||"0.00"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[r.duration_days," ημέρες"]})]})},r.id)})}),s.selectedPackage&&m.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Επιλέξτε Διάρκεια:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map(r=>{var a;return e.jsx("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-all ${s.selectedDuration===r.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,onClick:()=>h(l=>({...l,selectedDuration:r.id})),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:r.duration_type}),e.jsx("p",{className:"text-sm text-gray-600",children:r.classes_count?`${r.classes_count} μαθήματα`:`${r.duration_days} ημέρες`})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-primary-600",children:["€",((a=r.price)==null?void 0:a.toFixed(2))||"0.00"]})})]})},r.id)})})]})]}),n===3&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Επιβεβαίωση"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Σύνοψη Εγγραφής"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Όνομα:"}),e.jsxs("span",{className:"font-medium",children:[s.first_name," ",s.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:s.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Τηλέφωνο:"}),e.jsx("span",{className:"font-medium",children:s.phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Πακέτο:"}),e.jsx("span",{className:"font-medium",children:(k=O())==null?void 0:k.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Διάρκεια:"}),e.jsx("span",{className:"font-medium",children:(C=_())==null?void 0:C.duration_type})]}),e.jsxs("div",{className:"flex justify-between border-t pt-4",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Συνολικό Κόστος:"}),e.jsxs("span",{className:"text-lg font-bold text-primary-600",children:["€",((S=(P=_())==null?void 0:P.price)==null?void 0:S.toFixed(2))||"0.00"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptTerms",checked:s.acceptTerms,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",required:!0}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Αποδέχομαι τους ",e.jsx("a",{href:"/terms",className:"text-primary-600 hover:underline",children:"Όρους Χρήσης"})," *"]})]}),e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptPrivacy",checked:s.acceptPrivacy,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",required:!0}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Αποδέχομαι την ",e.jsx("a",{href:"/privacy",className:"text-primary-600 hover:underline",children:"Πολιτική Απορρήτου"})," *"]})]}),e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptMarketing",checked:s.acceptMarketing,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Θέλω να λαμβάνω ενημερώσεις και προσφορές μέσω email"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-8 py-6 flex justify-between",children:[e.jsx("button",{type:"button",onClick:B,disabled:n===1,className:`px-6 py-3 rounded-lg font-medium transition-colors ${n===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Προηγούμενο"}),n<3?e.jsxs("button",{type:"button",onClick:L,className:"flex items-center space-x-2 bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx("span",{children:"Επόμενο"}),e.jsx(K,{className:"h-4 w-4"})]}):e.jsx("button",{type:"submit",disabled:f,className:"flex items-center space-x-2 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Εγγραφή..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Ολοκλήρωση Εγγραφής"}),e.jsx(y,{className:"h-4 w-4"})]})})]})]})})]})})};export{W as default};
