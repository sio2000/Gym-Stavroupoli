const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/membershipApi-CeeYu9fp.js","assets/index-CFMUBE6X.js","assets/index-Cr85AvQg.css"])))=>i.map(i=>d[i]);
var Na=Object.defineProperty;var wa=(n,u,v)=>u in n?Na(n,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):n[u]=v;var Ws=(n,u,v)=>wa(n,typeof u!="symbol"?u+"":u,v);import{d as ut,r as d,z as h,j as e,p as Oe,q as ot,e as _a,m as Mr,s as O,X as Fe,U as Ce,t as _r,b as Se,T as Cs,o as Ds,C as Hs,M as Er,R as Pr,v as As,h as Pa,u as Sa,w as it,P as Sr,_ as ka}from"./index-CFMUBE6X.js";import{g as Aa,a as kr,b as Ca,c as dt,d as Ar,f as ks,r as Da,v as $a,e as Ta,s as Ua,h as Ma,i as Cr,j as Ea}from"./groupAssignmentApi-Da9ehAQ-.js";import{s as Ia,g as La,a as Ra,b as Ga}from"./pilatesScheduleApi-CT7TZWOE.js";import{R as Ys}from"./refresh-cw-O70fajy1.js";import{S as De}from"./search-B82Z2Z2-.js";import{P as $s}from"./plus-ElNEziUt.js";import{getGroupTrainingCalendarEvents as Oa}from"./groupTrainingCalendarApi-B0D_qXf3.js";import{C as Fa,a as za}from"./chevron-right-B1ZLNb5D.js";import{getDurationLabel as xt,formatPrice as ze,getMembershipPackages as Ka,getPilatesPackageDurations as Wa,getMembershipRequests as Dr,updatePilatesPackagePricing as Ba,updateMembershipPackageDuration as Va,approveUltimateMembershipRequest as Ha,approveMembershipRequest as Ya,rejectMembershipRequest as $r,getMembershipPackageDurations as Ja}from"./membershipApi-CeeYu9fp.js";import{s as Tr}from"./programApprovalApi-DdkMfcOB.js";import{A as Bs}from"./award-BLOIAWGT.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=ut("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=ut("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=ut("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Xa=()=>{const[n,u]=d.useState([]),[v,A]=d.useState(!1),[m,D]=d.useState(!1),[U,y]=d.useState({}),[ge,ae]=d.useState({}),[F,ee]=d.useState(()=>{const t=new Date("2025-09-13T00:00:00.000Z");return console.log("Admin: Using fixed week - 13 Sep:",t.toISOString()),t}),[X,W]=d.useState(null),[_,Q]=d.useState(!1),p=["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00"];d.useEffect(()=>{console.log("Admin: useEffect triggered - currentWeek changed to:",F.toISOString()),S();const t=Ia(()=>{S()});return()=>{try{t.unsubscribe()}catch{}}},[F]);const S=async()=>{try{A(!0);const t=await La();u(t);const i={},w=T();console.log("Loading slots for week:",w),console.log("Existing slots from DB:",t.length),w.forEach(P=>{p.forEach(oe=>{const ie=`${P}-${oe}`,he=t.find($e=>$e.date===P&&$e.start_time===`${oe}:00`);i[ie]=he?he.is_active:!0,Object.keys(i).length<=5&&console.log(`Grid key: ${ie}, existingSlot: ${!!he}, is_active: ${he==null?void 0:he.is_active}, final: ${i[ie]}`)})}),console.log("All existing slots for this week:"),t.forEach(P=>{console.log(`  - ${P.date} ${P.start_time} (active: ${P.is_active})`)}),console.log("Initialized grid with slots:",Object.keys(i).length),console.log("Grid state sample:",Object.entries(i).slice(0,5));const C=Object.values(i).filter(Boolean).length,B=Object.values(i).filter(P=>!P).length;console.log(`Grid summary: ${C} active, ${B} inactive`),y(i);const $=w[0],V=w[w.length-1],Z=await Ra($,V),g={};Z.forEach(P=>{const oe=`${P.date}-${P.start_time.slice(0,5)}`;g[oe]={booked:P.booked_count||0,cap:P.max_capacity}}),ae(g)}catch(t){console.error("Error loading slots:",t),h.error("Σφάλμα φόρτωσης προγράμματος pilates")}finally{A(!1)}},T=()=>{const t=[],i=new Date(F);console.log("Admin: getWeekDates - currentWeek:",i);for(let w=0;w<14;w++){const C=new Date(i);C.setDate(i.getDate()+w),t.push(C.toISOString().split("T")[0]),console.log(`Admin: Day ${w}: ${C.toISOString().split("T")[0]}`)}return t},E=t=>{const i=new Date(t);return["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"][i.getDay()]},se=(t,i)=>{const w=`${t}-${i}`;y(C=>({...C,[w]:!C[w]}))},M=async()=>{try{D(!0);const t=[],i=T();i.forEach(V=>{p.forEach(Z=>{const g=`${V}-${Z}`;t.push({date:V,time:Z,is_active:U[g]||!1})})}),console.log("=== SAVE SCHEDULE START ==="),console.log("Saving schedule with all slots:",t.length),console.log("Week dates:",i),console.log("Current grid state sample:",Object.entries(U).slice(0,10));const{data:w,error:C}=await O.from("pilates_schedule_slots").select("*").in("date",i);if(C)throw console.error("Error fetching existing slots:",C),C;if(console.log("Found existing slots:",(w==null?void 0:w.length)||0),w&&w.length>0&&console.log("Sample existing slots:",w.slice(0,3)),w&&w.length>0){const{error:V}=await O.from("pilates_schedule_slots").delete().in("date",i);if(V)throw console.error("Error deleting existing slots:",V),V;console.log("✅ Deleted existing slots for week")}else console.log("ℹ️ No existing slots to delete");const B=t.map(V=>({date:V.date,start_time:V.time,end_time:x(V.time),max_capacity:4,is_active:V.is_active}));console.log("Creating all slots:",B.slice(0,3)),console.log("Active slots count:",B.filter(V=>V.is_active).length),console.log("Inactive slots count:",B.filter(V=>!V.is_active).length);const{error:$}=await O.from("pilates_schedule_slots").insert(B);if($)throw console.error("Error creating new slots:",$),$;console.log("✅ Created all slots:",B.length),console.log("=== SAVE SCHEDULE COMPLETE ==="),h.success("Πρόγραμμα αποθηκεύθηκε επιτυχώς!"),await S()}catch(t){console.error("Error saving schedule:",t),h.error("Σφάλμα αποθήκευσης προγράμματος")}finally{D(!1)}},x=t=>{const[i,w]=t.split(":").map(Number),C=new Date;return C.setHours(i+1,w),C.toTimeString().slice(0,5)},Y=t=>{const i=new Date(F);t==="prev"?i.setDate(i.getDate()-14):i.setDate(i.getDate()+14),ee(i)},a=t=>new Date(t).toLocaleDateString("el-GR",{day:"numeric",month:"short"}),L=async(t,i,w)=>{try{Q(!0);const C=await Ga(t);W({slotId:t,date:i,time:w,bookings:C})}catch(C){console.error("Error loading slot info:",C),h.error("Σφάλμα φόρτωσης πληροφοριών slot")}finally{Q(!1)}};if(v)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const N=T();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Πρόγραμμα Pilates"}),e.jsx("p",{className:"text-gray-600",children:"Κάντε κλικ στις ώρες που δεν θέλετε να είναι διαθέσιμες"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{const t=new Date,i=t.getDay(),w=new Date(t),C=i===0?-6:1-i;w.setDate(t.getDate()+C),w.setHours(0,0,0,0),ee(w),console.log("Admin: Force refreshed currentWeek to:",w.toISOString())},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"🔄 Refresh"}),e.jsx("button",{onClick:()=>Y("prev"),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"← Προηγούμενη"}),e.jsx("button",{onClick:()=>Y("next"),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Επόμενη →"}),e.jsxs("button",{onClick:M,disabled:m,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{children:m?"Αποθήκευση...":"Αποθήκευση"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:["2 εβδομάδες: ",a(N[0])," - ",a(N[13])]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Κάντε κλικ στις κόκκινες ώρες για να τις απενεργοποιήσετε (δεν θα εμφανίζονται στους χρήστες)"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500 border-r border-gray-200 min-w-[100px]",children:"Ώρα"}),N.map((t,i)=>e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-500 border-r border-gray-200 min-w-[120px]",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-bold",children:E(t)}),e.jsx("span",{className:"text-xs text-gray-400",children:a(t)})]})},t))]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 border-r border-gray-200 bg-gray-50",children:t}),N.map((i,w)=>{const C=`${i}-${t}`,B=U[C],$=new Date(i).getDay(),V=$===0||$===6,Z=ge[C],g=(Z==null?void 0:Z.booked)??0,P=(Z==null?void 0:Z.cap)??4;return e.jsx("td",{className:"px-4 py-3 text-center border-r border-gray-200",children:V?e.jsx("div",{className:"w-full h-8 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Σαβ/Κυρ"})}):e.jsxs("div",{className:"relative w-full h-8",children:[e.jsx("button",{onClick:()=>se(i,t),className:`w-full h-8 rounded transition-all duration-200 flex items-center justify-center ${B?g>=P?"bg-red-100 text-red-800 border-2 border-red-300":"bg-green-100 text-green-800 hover:bg-green-200 border-2 border-green-300":"bg-red-100 text-red-800 hover:bg-red-200 border-2 border-red-300"}`,children:B?e.jsxs("span",{className:"text-xs font-semibold",children:[g,"/",P]}):e.jsx(ot,{className:"h-5 w-5"})}),B&&g>0&&g<P&&e.jsx("button",{onClick:oe=>{oe.stopPropagation();const ie=n.find(he=>he.date===i&&he.start_time===`${t}:00`);ie&&L(ie.id,i,t)},className:"absolute top-0 right-0 w-4 h-4 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center text-white text-xs transition-colors",title:"Πληροφορίες κρατήσεων",children:e.jsx(Qa,{size:10})})]})},C)})]},t))})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Εξήγηση"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 border-2 border-green-300 rounded flex items-center justify-center",children:e.jsx(_a,{className:"h-5 w-5 text-green-800"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Διαθέσιμο"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Οι χρήστες μπορούν να κλείσουν μαθήματα"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 border-2 border-red-300 rounded flex items-center justify-center",children:e.jsx(ot,{className:"h-5 w-5 text-red-800"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Απενεργοποιημένο"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Δεν εμφανίζεται στους χρήστες"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Σαβ/Κυρ"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Σαββατοκύριακο"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Δεν υπάρχουν μαθήματα"})]})]})]})]}),X&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Κρατήσεις για ",a(X.date)," στις ",X.time]}),e.jsx("button",{onClick:()=>W(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ot,{size:20})})]}),_?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Φόρτωση..."})]}):e.jsx("div",{className:"space-y-3",children:X.bookings.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[X.bookings.length," κρατήσεις:"]}),X.bookings.map((t,i)=>{var w,C,B;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[(w=t.user)==null?void 0:w.first_name," ",(C=t.user)==null?void 0:C.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:(B=t.user)==null?void 0:B.email})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Κράτηση: ",new Date(t.booking_date).toLocaleDateString("el-GR")]})]},t.id||i)})]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Δεν υπάρχουν κρατήσεις για αυτό το slot"})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Mr,{className:"h-5 w-5 text-blue-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Σημαντικές Πληροφορίες"}),e.jsxs("ul",{className:"text-sm text-blue-700 mt-1 space-y-1",children:[e.jsx("li",{children:"• Κάθε ώρα έχει χωρητικότητα 4 χρήστες (4 κρεβάτια pilates)"}),e.jsx("li",{children:"• Κάντε κλικ στις ώρες που δεν θέλετε να δουλεύετε"}),e.jsx("li",{children:"• Το πρόγραμμα εμφανίζεται στους χρήστες με ενεργή pilates συνδρομή"}),e.jsx("li",{children:"• Μην ξεχάσετε να αποθηκεύσετε τις αλλαγές!"}),e.jsx("li",{children:'• Κάντε κλικ στο μπλε κουμπί "i" για να δείτε τις κρατήσεις ενός slot'})]})]})]})})]})},Vs=async(n,u,v,A,m="",D)=>{try{console.log("[saveCashTransaction] Saving transaction:",{userId:n,amount:u,transactionType:v,programId:A,createdBy:m,notes:D});const{data:U,error:y}=await O.from("user_cash_transactions").insert({user_id:n,amount:u,transaction_type:v,program_id:A,created_by:m,notes:D}).select().single();return y?(console.error("[saveCashTransaction] Error saving transaction:",y),!1):(console.log("[saveCashTransaction] Transaction saved successfully:",U),!0)}catch(U){return console.error("[saveCashTransaction] Exception saving transaction:",U),!1}},Za=async()=>{try{console.log("[getCashRegisterTotals] Fetching totals...");const{data:n,error:u}=await O.from("user_cash_transactions").select("amount, transaction_type");if(u)return console.error("[getCashRegisterTotals] Error fetching totals:",u),{total_cash:0,total_pos:0,total_transactions:0};const v=(n==null?void 0:n.reduce((A,m)=>(m.transaction_type==="cash"?A.total_cash+=m.amount:m.transaction_type==="pos"&&(A.total_pos+=m.amount),A.total_transactions+=1,A),{total_cash:0,total_pos:0,total_transactions:0}))||{total_cash:0,total_pos:0,total_transactions:0};return console.log("[getCashRegisterTotals] Totals calculated:",v),v}catch(n){return console.error("[getCashRegisterTotals] Exception fetching totals:",n),{total_cash:0,total_pos:0,total_transactions:0}}},qa=async()=>{try{console.log("[getCashSummaryPerUser] Fetching user summaries...");const{data:n,error:u}=await O.from("user_cash_transactions").select(`
        user_id,
        amount,
        transaction_type,
        created_at,
        user_profiles!user_cash_transactions_user_id_fkey(
          first_name,
          last_name,
          email
        )
      `).order("created_at",{ascending:!1});if(u)return console.error("[getCashSummaryPerUser] Error fetching user summaries:",u),[];if(console.log("[getCashSummaryPerUser] Raw data received:",(n==null?void 0:n.length)||0,"records"),!n||n.length===0)return console.log("[getCashSummaryPerUser] No data found, returning empty array"),[];const v=new Map;n.forEach(m=>{const D=m.user_id,U=m.user_profiles;v.has(D)||v.set(D,{user_id:D,user_name:U?`${U.first_name||""} ${U.last_name||""}`.trim():`User ${D.slice(0,8)}`,user_email:(U==null?void 0:U.email)||"No email",cash_total:0,pos_total:0,cash_count:0,pos_count:0});const y=v.get(D);m.transaction_type==="cash"?(y.cash_total+=m.amount,y.cash_count+=1,(!y.last_cash_date||new Date(m.created_at)>new Date(y.last_cash_date))&&(y.last_cash_date=m.created_at)):m.transaction_type==="pos"&&(y.pos_total+=m.amount,y.pos_count+=1,(!y.last_pos_date||new Date(m.created_at)>new Date(y.last_pos_date))&&(y.last_pos_date=m.created_at))});const A=Array.from(v.values()).sort((m,D)=>D.cash_total+D.pos_total-(m.cash_total+m.pos_total));return console.log("[getCashSummaryPerUser] Processed summaries:",A),A}catch(n){return console.error("[getCashSummaryPerUser] Exception fetching user summaries:",n),[]}},el=()=>{const[n,u]=d.useState({total_cash:0,total_pos:0,total_transactions:0}),[v,A]=d.useState([]),[m,D]=d.useState(!1),[U,y]=d.useState(""),[ge,ae]=d.useState([]),F=async()=>{try{D(!0);const[_,Q]=await Promise.all([Za(),qa()]);u(_),A(Q)}catch(_){console.error("Error loading cash register data:",_),h.error("Σφάλμα κατά τη φόρτωση των δεδομένων ταμείου")}finally{D(!1)}};d.useEffect(()=>{F()},[]);const ee=_=>{if(!_.trim()){ae([]);return}const Q=v.filter(p=>p.user_name.toLowerCase().includes(_.toLowerCase())||p.user_email.toLowerCase().includes(_.toLowerCase()));ae(Q)},X=_=>{y(_),ee(_)},W=U?ge:v;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"💰 Ταμείο"}),e.jsx("p",{className:"text-green-100 text-sm sm:text-base",children:"Συνολικά ποσά και ανάλυση χρηστών"})]}),e.jsxs("button",{onClick:F,disabled:m,className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm disabled:opacity-50",children:[e.jsx(Ys,{className:`h-4 w-4 ${m?"animate-spin":""}`}),e.jsx("span",{children:"🔄 Ανανέωση"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-green-800 mb-2",children:"💵 Συνολικά Μετρητά"}),e.jsx("p",{className:"text-green-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold text-green-900",children:["€",n.total_cash.toFixed(2)]}),e.jsx("div",{className:"text-sm text-green-600",children:"ευρώ"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"💳 Συνολικά POS"}),e.jsx("p",{className:"text-blue-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-900",children:["€",n.total_pos.toFixed(2)]}),e.jsx("div",{className:"text-sm text-blue-600",children:"ευρώ"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-purple-800 mb-2",children:"📊 Συνολικές Συναλλαγές"}),e.jsx("p",{className:"text-purple-600",children:"Όλες οι συναλλαγές"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-purple-900",children:n.total_transactions}),e.jsx("div",{className:"text-sm text-purple-600",children:"συναλλαγές"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"👥 Ανάλυση Χρηστών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Μετρητά και POS ανά χρήστη"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση χρήστη...",value:U,onChange:_=>X(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm"})]}),U&&e.jsx("button",{onClick:()=>X(""),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"p-6",children:m?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ys,{className:"h-8 w-8 mx-auto mb-4 text-gray-400 animate-spin"}),e.jsx("p",{className:"text-gray-500",children:"Φόρτωση δεδομένων..."})]}):W.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(gt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν υπάρχουν συναλλαγές ακόμα"}),e.jsx("p",{className:"text-sm mt-2",children:"Οι συναλλαγές θα εμφανιστούν εδώ όταν δημιουργηθούν"})]}):e.jsxs("div",{className:"space-y-4",children:[W.map((_,Q)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:_.user_name.split(" ").map(p=>p[0]).join("").slice(0,2)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:_.user_name}),e.jsx("p",{className:"text-sm text-gray-600",children:_.user_email}),e.jsxs("div",{className:"flex space-x-4 text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["💵 ",_.cash_count," μετρητά"]}),e.jsxs("span",{children:["💳 ",_.pos_count," POS"]})]})]})]}),e.jsx("div",{className:"text-right space-y-2",children:e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["€",_.cash_total.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Μετρητά"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["€",_.pos_total.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"POS"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["€",(_.cash_total+_.pos_total).toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Σύνολο"})]})]})})]})},_.user_id)),U&&ge.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(De,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν βρέθηκαν χρήστες με αυτό το όνομα"}),e.jsx("p",{className:"text-sm mt-2",children:"Δοκιμάστε ένα διαφορετικό όρο αναζήτησης"})]})]})})]})]})},sl=({selectedUser:n,programId:u,weeklyFrequency:v,onAssignmentComplete:A})=>{const[m,D]=d.useState([]),[U,y]=d.useState([]),[ge,ae]=d.useState(null),[F,ee]=d.useState(null),[X,W]=d.useState([]),[_,Q]=d.useState(!1),[p,S]=d.useState(""),[T,E]=d.useState([]);d.useEffect(()=>{se()},[n.id,u]);const se=async()=>{Q(!0);try{await Promise.all([M(),x(),Y()])}catch(g){console.error("Failed to load group assignment data:",g),h.error("Σφάλμα κατά τη φόρτωση των δεδομένων")}finally{Q(!1)}},M=async()=>{try{const g=await Aa(ge||void 0);D(g)}catch(g){throw console.error("Failed to load available slots:",g),g}},x=async()=>{try{const g=await kr(n.id,u);y(g)}catch(g){throw console.error("Failed to load user assignments:",g),g}},Y=async()=>{try{const g=await Ca(n.id,u);E(g)}catch(g){throw console.error("Failed to load weekly assignment summary:",g),g}},a=async g=>{try{const P=await Ma(g);W(P)}catch(P){console.error("Failed to load slot assignments:",P),h.error("Σφάλμα κατά τη φόρτωση των αναθέσεων")}},L=async g=>{ee(g),await a(g.groupIdentifier)},N=async()=>{if(!F){h.error("Παρακαλώ επιλέξτε μια ομαδική θέση");return}try{Q(!0);const g=await $a(n.id,u,F.groupIdentifier,F.dayOfWeek,F.startTime,F.endTime,v);if(!g.isValid){h.error(`Δεν είναι δυνατή η ανάθεση: ${g.errorMessage}`);return}const P=await Ta(u,n.id,F.groupIdentifier,v,p);if(P.success){h.success("Η ανάθεση δημιουργήθηκε επιτυχώς!"),S(""),await se(),await a(F.groupIdentifier);const oe=await kr(n.id,u);oe.length>=v&&await Ua(n.id,u,oe)&&h.success(`🎉 Το πρόγραμμα ολοκληρώθηκε! Ο χρήστης ${n.firstName} ${n.lastName} θα λάβει ενημέρωση.`),A&&A()}else h.error(`Σφάλμα: ${P.message}`)}catch(g){console.error("Failed to assign user:",g),h.error("Σφάλμα κατά τη δημιουργία της ανάθεσης")}finally{Q(!1)}},t=async g=>{if(confirm("Είστε σίγουροι ότι θέλετε να αφαιρέσετε αυτή την ανάθεση;"))try{Q(!0),await Da(g)?(h.success("Η ανάθεση αφαιρέθηκε επιτυχώς"),await se(),F&&await a(F.groupIdentifier)):h.error("Σφάλμα κατά την αφαίρεση της ανάθεσης")}catch(P){console.error("Failed to remove assignment:",P),h.error("Σφάλμα κατά την αφαίρεση της ανάθεσης")}finally{Q(!1)}},i=()=>U.length,w=()=>Math.max(0,v-i()),C=()=>i()>=v,B=()=>{const g=i(),P=v;return g===0?`Δεν έχουν γίνει αναθέσεις ακόμα. Απαιτούνται ${P} αναθέσεις.`:g<P?`Έχουν γίνει ${g} από ${P} απαιτούμενες αναθέσεις. Απομένουν ${P-g}.`:"✅ Ολοκληρώθηκαν όλες οι αναθέσεις! Ο χρήστης θα λάβει ενημέρωση για το πρόγραμμά του."},$=()=>[{value:null,label:"Όλες οι ημέρες"},{value:1,label:"Δευτέρα"},{value:2,label:"Τρίτη"},{value:3,label:"Τετάρτη"},{value:4,label:"Πέμπτη"},{value:5,label:"Παρασκευή"},{value:6,label:"Σάββατο"}],V=g=>g.isFull?"bg-red-100 border-red-300 text-red-700":g.availableSpots<=1?"bg-yellow-100 border-yellow-300 text-yellow-700":"bg-green-100 border-green-300 text-green-700",Z=g=>U.some(P=>P.groupIdentifier===g.groupIdentifier);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-6 w-6 text-blue-600"}),e.jsxs("h3",{className:"text-xl font-bold text-blue-800",children:["Ανάθεση Ομαδικών Θέσεων - ",n.firstName," ",n.lastName]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:C()?e.jsxs("div",{className:"flex items-center space-x-2 bg-green-100 px-3 py-1 rounded-full",children:[e.jsx(_r,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Ολοκληρώθηκε"})]}):e.jsxs("div",{className:"flex items-center space-x-2 bg-orange-100 px-3 py-1 rounded-full",children:[e.jsx(ht,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Σε εξέλιξη"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Στόχος Εβδομάδας"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Τρέχουσες Αναθέσεις"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i()})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Υπολείπονται"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:w()})]})]}),e.jsx("div",{className:`mt-4 p-4 rounded-lg ${C()?"bg-green-50 border border-green-200":"bg-blue-50 border border-blue-200"}`,children:e.jsx("p",{className:`text-sm font-medium ${C()?"text-green-700":"text-blue-700"}`,children:B()})})]}),U.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Se,{className:"h-5 w-5 mr-2 text-blue-600"}),"Τρέχουσες Αναθέσεις"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:U.map(g=>e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-blue-800",children:[dt(g.dayOfWeek)," - ",Ar(g.groupType)]}),e.jsxs("div",{className:"text-sm text-blue-600",children:[ks(g.startTime)," - ",ks(g.endTime)]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["Προπονητής: ",g.trainer]})]}),e.jsx("button",{onClick:()=>t(g.id),className:"text-red-600 hover:text-red-800 p-1",title:"Αφαίρεση ανάθεσης",children:e.jsx(Cs,{className:"h-4 w-4"})})]}),g.notes&&e.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Σημειώσεις: ",g.notes]})]},g.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(Ds,{className:"h-5 w-5 mr-2 text-green-600"}),"Διαθέσιμες Ομαδικές Θέσεις"]}),e.jsx("select",{value:ge||"",onChange:g=>{const P=g.target.value?parseInt(g.target.value):null;ae(P),M()},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:$().map(g=>e.jsx("option",{value:g.value||"",children:g.label},g.value||"all"))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(g=>{const P=Z(g),oe=!P&&!g.isFull&&!C();return e.jsxs("div",{className:`rounded-lg p-4 border-2 cursor-pointer transition-all ${(F==null?void 0:F.id)===g.id?"border-blue-500 bg-blue-50":`border-gray-200 hover:border-gray-300 ${V(g)}`} ${oe?"":"opacity-60"}`,onClick:()=>oe&&L(g),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:dt(g.dayOfWeek)}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center mt-1",children:[e.jsx(Hs,{className:"h-4 w-4 mr-1"}),ks(g.startTime)," - ",ks(g.endTime)]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center mt-1",children:[e.jsx(Er,{className:"h-4 w-4 mr-1"}),g.trainer," - ",g.room]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:Ar(g.groupType)}),e.jsxs("div",{className:"text-xs text-gray-600",children:[g.currentAssignments,"/",g.maxCapacity]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.isFull?"bg-red-100 text-red-800":g.availableSpots<=1?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:g.isFull?"Πλήρες":`${g.availableSpots} διαθέσιμες`})}),P&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"Ανατεθειμένο"})]})]},g.id)})})]}),F&&!C()&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx($s,{className:"h-5 w-5 mr-2 text-green-600"}),"Ανάθεση στη θέση: ",dt(F.dayOfWeek)," - ",ks(F.startTime)]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Σημειώσεις (προαιρετικό)"}),e.jsx("textarea",{value:p,onChange:g=>S(g.target.value),placeholder:"Προσθέστε σημειώσεις για αυτή την ανάθεση...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),X.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Τρέχοντα μέλη αυτής της ομάδας:"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:X.map(g=>{var P,oe;return e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["• ",(P=g.userInfo)==null?void 0:P.first_name," ",(oe=g.userInfo)==null?void 0:oe.last_name]},g.id)})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:N,disabled:_,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),_?"Δημιουργία...":"Δημιουργία Ανάθεσης"]}),e.jsx("button",{onClick:()=>ee(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Ακύρωση"})]})]})]}),C()&&e.jsx("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(_r,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Οι αναθέσεις ολοκληρώθηκαν!"}),e.jsxs("p",{className:"text-green-600",children:["Ο χρήστης έχει ανατεθεί σε ",i()," ομαδικές θέσεις αυτή την εβδομάδα."]})]})]})})]})},tl=({selectedGroupRoom:n,weeklyFrequency:u,monthlyTotal:v,selectedUserIds:A,onSlotsChange:m})=>{const[D,U]=d.useState({}),y=u*4,ge=d.useRef("");d.useEffect(()=>{const p=`${JSON.stringify(A)}-${u}-${n}`;if(ge.current===p){console.log("[GroupAssignmentInterface] Configuration unchanged, skipping initialization");return}console.log("[GroupAssignmentInterface] Initializing sessions...",{selectedUserIds:A,weeklyFrequency:u,selectedGroupRoom:n,monthlySessions:y});const S={};A.forEach(T=>{S[T]=Array.from({length:y},(E,se)=>({id:`session-${T}-${se}`,date:new Date().toISOString().split("T")[0],startTime:"18:00",endTime:"19:00",trainer:"Mike",room:"Αίθουσα Mike",groupType:parseInt(n),notes:""}))}),U(S),ge.current=p,m&&setTimeout(()=>{console.log("[GroupAssignmentInterface] Notifying parent after initialization..."),m(S)},100)},[A,u,n,y,m]);const ae=async(p,S,T,E)=>{var x;console.log("[GroupAssignmentInterface] Updating session:",{userId:p,sessionId:S,field:T,value:E});const se=(x=D[p])==null?void 0:x.find(Y=>Y.id===S);if(!se){console.error("[GroupAssignmentInterface] Current session not found:",{userId:p,sessionId:S});return}const M={...se,[T]:E};if(T==="date"||T==="startTime"||T==="endTime"||T==="room"||T==="groupType")try{const Y=await Cr(M.date,M.startTime,M.endTime,M.room,M.groupType,p);if(!Y.isAvailable){h.error(`❌ Η αίθουσα ${M.room} είναι γεμάτη για ${M.date} ${M.startTime}-${M.endTime}. Χωρητικότητα: ${Y.currentOccupancy+1}/${Y.maxCapacity}. Παρακαλώ επιλέξτε διαφορετική ώρα, ημερομηνία ή αίθουσα.`);return}}catch(Y){console.error("Error checking room capacity:",Y),console.warn("[GroupAssignmentInterface] Capacity check failed, but allowing change to proceed")}U(Y=>{const a={...Y,[p]:Y[p].map(L=>L.id===S?M:L)};return console.log("[GroupAssignmentInterface] Session updated successfully:",{userId:p,sessionId:S,field:T,value:E}),m&&setTimeout(()=>{console.log("[GroupAssignmentInterface] Notifying parent of session update..."),m(a)},50),a})},F=async p=>{if((D[p]||[]).length>=y){h.error(`Ο χρήστης μπορεί να έχει μέγιστο ${y} σεσίες τον μήνα (${u} φορές/εβδομάδα × 4 εβδομάδες)`);return}const T={id:`session-${p}-${Date.now()}`,date:new Date().toISOString().split("T")[0],startTime:"18:00",endTime:"19:00",trainer:"Mike",room:"Αίθουσα Mike",groupType:parseInt(n),notes:""};try{const E=await Cr(T.date,T.startTime,T.endTime,T.room,T.groupType);if(!E.isAvailable){h.error(`❌ Η αίθουσα ${T.room} είναι γεμάτη για ${T.date} ${T.startTime}-${T.endTime}. Χωρητικότητα: ${E.currentOccupancy}/${E.maxCapacity}. Παρακαλώ επιλέξτε διαφορετική ώρα ή ημερομηνία.`);return}}catch(E){console.error("Error checking room capacity for new session:",E)}U(E=>{const se={...E,[p]:[...E[p]||[],T]};return m&&setTimeout(()=>{console.log("[GroupAssignmentInterface] Notifying parent of session addition..."),m(se)},50),se})},ee=(p,S)=>{U(T=>{const E={...T,[p]:T[p].filter(se=>se.id!==S)};return m&&setTimeout(()=>{console.log("[GroupAssignmentInterface] Notifying parent of session removal..."),m(E)},50),E})},X=p=>{var S;return((S=D[p])==null?void 0:S.length)||0},W=p=>X(p)===y,_=["Mike","Jordan"],Q=["Αίθουσα Mike","Αίθουσα Jordan"];return e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold text-blue-800 flex items-center",children:[e.jsx(Ds,{className:"h-5 w-5 mr-2"}),"Διαχείριση Ομαδικών Αναθέσεων"]}),e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Προσθέστε σεσίες για κάθε χρήστη (",y," σεσίες/μήνα = ",u," φορές/εβδομάδα × 4 εβδομάδες)",e.jsx("br",{}),e.jsx("span",{className:"text-purple-600 font-medium",children:"💡 Μπορείτε να επιλέξετε διαφορετικό Group Size για κάθε σεσία (2, 3, ή 6 άτομα)"})]})]})}),e.jsx("div",{className:"space-y-6",children:A.map(p=>{const S=D[p]||[],T=W(p);return e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-blue-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full ${T?"bg-green-100":"bg-orange-100"}`,children:e.jsx(Ds,{className:`h-4 w-4 ${T?"text-green-600":"text-orange-600"}`})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-gray-800",children:["Χρήστης ",p.slice(-8)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[S.length,"/",y," σεσίες προγραμματισμένες"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-7 gap-0 text-sm font-semibold text-gray-700",children:[e.jsx("div",{className:"p-3 border-r border-gray-200",children:"📅 Ημερομηνία"}),e.jsx("div",{className:"p-3 border-r border-gray-200",children:"🕐 Έναρξη"}),e.jsx("div",{className:"p-3 border-r border-gray-200",children:"🕕 Λήξη"}),e.jsx("div",{className:"p-3 border-r border-gray-200",children:"👤 Προπονητής"}),e.jsx("div",{className:"p-3 border-r border-gray-200",children:"🏠 Αίθουσα"}),e.jsx("div",{className:"p-3 border-r border-gray-200",children:"👥 Group Size"}),e.jsx("div",{className:"p-3",children:"🗑️"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:S.map((E,se)=>e.jsxs("div",{className:"grid grid-cols-7 gap-0 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsx("input",{type:"date",value:E.date,onChange:M=>ae(p,E.id,"date",M.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500"})}),e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsx("input",{type:"time",value:E.startTime,onChange:M=>ae(p,E.id,"startTime",M.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500"})}),e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsx("input",{type:"time",value:E.endTime,onChange:M=>ae(p,E.id,"endTime",M.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500"})}),e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsx("select",{value:E.trainer,onChange:M=>ae(p,E.id,"trainer",M.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500",children:_.map(M=>e.jsx("option",{value:M,children:M},M))})}),e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsx("select",{value:E.room,onChange:M=>ae(p,E.id,"room",M.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500",children:Q.map(M=>e.jsx("option",{value:M,children:M},M))})}),e.jsx("div",{className:"p-2 border-r border-gray-200",children:e.jsxs("select",{value:E.groupType,onChange:M=>ae(p,E.id,"groupType",parseInt(M.target.value)),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:2,children:"2 άτομα"}),e.jsx("option",{value:3,children:"3 άτομα"}),e.jsx("option",{value:6,children:"6 άτομα"})]})}),e.jsx("div",{className:"p-2 flex items-center justify-center",children:e.jsx("button",{onClick:()=>ee(p,E.id),className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors",title:"Διαγραφή σεσίας",children:e.jsx(Cs,{className:"h-4 w-4"})})})]},E.id))}),S.length<y&&e.jsx("div",{className:"border-t border-gray-200 bg-blue-50",children:e.jsx("div",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>F(p),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mx-auto text-sm",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsx("span",{children:"Προσθήκη Σεσίας"})]})})})]})]},p)})}),e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-green-800",children:"Περίληψη Προγραμματισμού"}),e.jsxs("p",{className:"text-sm text-green-600",children:[A.filter(p=>W(p)).length,"/",A.length," χρήστες έχουν ",y," σεσίες/μήνα"]})]}),e.jsx("div",{className:"text-2xl",children:A.every(p=>W(p))?"✅":"⏳"})]}),!A.every(p=>W(p))&&e.jsxs("div",{className:"mt-2 text-sm text-orange-600",children:["⚠️ Προσθέστε ",y," σεσίες για κάθε χρήστη (",u," φορές/εβδομάδα × 4 εβδομάδες)"]})]})]})},rl=({featureEnabled:n=!0})=>{const[u,v]=d.useState(()=>new Date),[A,m]=d.useState([]),[D,U]=d.useState(!1),[y,ge]=d.useState(null),[ae,F]=d.useState(!1),[ee,X]=d.useState(!1),W=u.getMonth()+1,_=u.getFullYear(),Q=d.useCallback(async()=>{if(n){U(!0);try{const N=`${_}-${W.toString().padStart(2,"0")}-01`,t=new Date(_,W,0).toISOString().split("T")[0];console.log("[GroupTrainingCalendar] Loading events for:",{startDate:N,endDate:t});const i=await Oa(N,t);m(i.events),console.log("[GroupTrainingCalendar] Loaded events:",i.events.length)}catch(N){console.error("[GroupTrainingCalendar] Error loading events:",N),h.error("Αποτυχία φόρτωσης ημερολογίου")}finally{U(!1)}}},[_,W,n]);d.useEffect(()=>{Q()},[Q]);const p=()=>{v(N=>new Date(N.getFullYear(),N.getMonth()-1,1))},S=()=>{v(N=>new Date(N.getFullYear(),N.getMonth()+1,1))},T=()=>{v(new Date)},E=N=>{const t=N.toISOString().split("T")[0];return A.filter(i=>i.start.startsWith(t))},se=(N,t)=>{const i=N/t*100;return i===0?"text-gray-600":i<=50?"text-green-700":i<100?"text-yellow-700":"text-red-700"},M=(N,t)=>{const i=N/t*100;return i===0?"bg-gray-100":i<=50?"bg-green-200":i<100?"bg-yellow-200":"bg-red-200"},x=(N,t)=>N>=t,Y=async N=>{try{U(!0),console.log("[GroupTrainingCalendar] Event clicked:",N);const t=N.id.replace("group-","");console.log("[GroupTrainingCalendar] Event key:",t),ge(N),F(!0)}catch(t){console.error("[GroupTrainingCalendar] Error loading event details:",t),h.error("Failed to load event details")}finally{U(!1)}},a=async()=>{X(!0);try{await Q(),h.success("Ημερολόγιο ανανεώθηκε")}catch(N){console.error("[GroupTrainingCalendar] Error refreshing:",N),h.error("Αποτυχία ανανέωσης ημερολογίου")}finally{X(!1)}},L=()=>{const N=new Date(_,W,0).getDate(),t=new Date(_,W-1,1).getDay(),i=[];for(let w=0;w<t;w++)i.push(e.jsx("div",{className:"min-h-32 bg-gray-50 rounded-lg"},`empty-${w}`));for(let w=1;w<=N;w++){const C=new Date(_,W-1,w),B=E(C);i.push(e.jsxs("div",{className:"min-h-32 bg-white border border-gray-200 rounded-lg p-2 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1 flex-shrink-0",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:w}),B.length>0&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full",children:B.length})]}),e.jsx("div",{className:"space-y-1 flex-grow",children:B.map(($,V)=>{const Z=x($.participants_count,$.capacity);return e.jsx("div",{onClick:()=>Y($),className:`rounded-lg cursor-pointer hover:opacity-90 transition-all duration-200 ${M($.participants_count,$.capacity)} border border-opacity-20 shadow-sm hover:shadow-md p-2`,title:"Click to view session details",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-sm text-gray-800 mb-1",children:$.start.split("T")[1].substring(0,5)}),e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[e.jsx("span",{className:"text-lg",children:$.capacity===1?"👤":$.capacity===2?"👥👥":$.capacity===3?"👥👥👥":$.capacity===6?"👥👥👥👥👥👥":"👥"}),e.jsxs("span",{className:"text-xs font-bold text-gray-700",children:[$.participants_count,"/",$.capacity]})]}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:$.capacity===1?"1 άτομο (Individual)":$.capacity===2?"2 άτομα":$.capacity===3?"3 άτομα":$.capacity===6?"6 άτομα":`${$.capacity} άτομα`}),Z&&e.jsx("div",{className:"text-xs text-red-600 font-bold mt-1",children:"🔒 ΓΕΜΑΤΟ"})]})},V)})})]},w))}return i};return n?e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx("span",{className:"text-blue-600",children:"📅"}),e.jsx("span",{children:"Κλεισμένες Ομαδικές Σεσίες"})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Μηνιαία προβολή -"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Ελεύθερα"})]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Μισά"})]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Γεμάτα"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:p,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:D,children:e.jsx(Fa,{className:"h-4 w-4"})}),e.jsx("button",{onClick:T,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",disabled:D,children:"Σήμερα"}),e.jsxs("button",{onClick:a,className:"px-3 py-1 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-1",disabled:D||ee,children:[ee?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Ανανέωση"})]}),e.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:D,children:e.jsx(za,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:new Date(_,W-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})})})]}),e.jsx("div",{className:"p-4 sm:p-6",children:D?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading calendar events..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"].map(N=>e.jsx("div",{className:"text-center text-sm font-bold text-gray-700 py-3 bg-gray-100 rounded-lg",children:N},N))}),e.jsx("div",{className:"grid grid-cols-7 gap-2 auto-rows-min",children:L()})]})}),ae&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Λεπτομέρειες Σεσίας"}),e.jsx("button",{onClick:()=>F(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Hs,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"font-medium",children:[new Date(y.start).toLocaleDateString("el-GR")," στις ",y.start.split("T")[1].substring(0,5)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Er,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:y.room})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{children:["Προπονητής: ",y.trainer]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 ${x(y.participants_count,y.capacity)?"bg-red-50 border border-red-200":"bg-blue-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-medium text-lg",children:"Χωρητικότητα Μαθήματος"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:y.capacity===1?"👤":y.capacity===2?"👥👥":y.capacity===3?"👥👥👥":y.capacity===6?"👥👥👥👥👥👥":"👥"}),e.jsxs("span",{className:`px-3 py-2 rounded-full text-lg font-bold ${M(y.participants_count,y.capacity)} ${se(y.participants_count,y.capacity)}`,children:[y.participants_count,"/",y.capacity]}),x(y.participants_count,y.capacity)&&e.jsx("span",{className:"text-sm text-red-600 font-bold bg-red-100 px-3 py-2 rounded-lg",children:"🔒 ΓΕΜΑΤΟ"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800 mb-2",children:y.capacity===1?"Individual Training - 1 άτομο":y.capacity===2?"Μάθημα για 2 άτομα":y.capacity===3?"Μάθημα για 3 άτομα":y.capacity===6?"Μάθημα για 6 άτομα":`Μάθημα για ${y.capacity} άτομα`}),e.jsx("div",{className:"text-sm text-gray-600",children:y.participants_count===0?"Κανένας συμμετέχων":y.participants_count===1?"1 συμμετέχων":`${y.participants_count} συμμετέχοντες`})]}),x(y.participants_count,y.capacity)&&e.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-100 p-3 rounded-lg",children:"⚠️ Αυτό το μάθημα είναι γεμάτο. Δεν επιτρέπονται νέες κρατήσεις."})]}),y.participants.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Συμμετέχοντες"}),e.jsx("div",{className:"space-y-2",children:y.participants.map((N,t)=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-medium",children:N.name.split(" ").map(i=>i[0]).join("").toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:N.name}),e.jsx("div",{className:"text-xs text-gray-600",children:N.email})]})]},t))})]})]})]})})})]}):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mr,{className:"h-5 w-5 text-yellow-600"}),e.jsx("span",{className:"text-yellow-800",children:"Το Ημερολόγιο Ομαδικής Προπόνησης είναι απενεργοποιημένο"})]})})},al=({ultimateRequests:n,ultimateLoading:u,ultimateSearchTerm:v,setUltimateSearchTerm:A,selectedRequestOptions:m,handleRequestOptionChange:D,updateInstallmentAmounts:U,deleteUltimateRequest:y,loadUltimateRequests:ge,handleApproveRequest:ae,handleRejectRequest:F,loading:ee,requestProgramApprovalStatus:X,handleRequestProgramApprovalChange:W,handleSaveRequestProgramOptions:_,requestPendingUsers:Q,requestFrozenOptions:p})=>{const[S,T]=Pr.useState(1),E=50,se=100,M=()=>{const t=n.filter(i=>{var C,B,$;return v===""||`${((C=i.user)==null?void 0:C.first_name)||""} ${((B=i.user)==null?void 0:B.last_name)||""}`.toLowerCase().includes(v.toLowerCase())||((($=i.user)==null?void 0:$.email)||"").toLowerCase().includes(v.toLowerCase())});if(t.length>se){const i=(S-1)*E,w=i+E;return t.slice(i,w)}return t},x=()=>n.filter(t=>{var w,C,B;return v===""||`${((w=t.user)==null?void 0:w.first_name)||""} ${((C=t.user)==null?void 0:C.last_name)||""}`.toLowerCase().includes(v.toLowerCase())||(((B=t.user)==null?void 0:B.email)||"").toLowerCase().includes(v.toLowerCase())}).length,Y=()=>{const t=x();return Math.ceil(t/E)},a=()=>x()>se,L=t=>Q.has(t),N=t=>p[t]||{};return Pr.useEffect(()=>{T(1)},[v]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-4xl mr-3",children:"👑"}),"Ultimate Συνδρομές"]}),e.jsx("p",{className:"text-gray-300 mt-2 text-lg",children:"Διαχείριση αιτημάτων για πακέτα Ultimate με και χωρίς δόσεις"})]}),e.jsxs("button",{onClick:ge,disabled:u,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105 font-medium",children:[u?e.jsx(As,{className:"h-5 w-5 animate-spin"}):e.jsx(De,{className:"h-5 w-5"}),e.jsx("span",{children:"Ανανέωση"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-2xl shadow-lg border border-gray-600 p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-blue-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"🔍 Αναζήτηση με όνομα χρήστη ή email...",value:v,onChange:t=>A(t.target.value),className:"w-full pl-12 pr-4 py-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400 text-lg font-medium"})]})}),v&&e.jsx("button",{onClick:()=>A(""),className:"px-4 py-4 text-gray-400 hover:text-white transition-colors bg-gray-600 rounded-xl hover:bg-gray-500",children:e.jsx(Fe,{className:"h-5 w-5"})})]})}),a()&&!u&&e.jsx("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-2xl shadow-lg border border-gray-600 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-white font-medium",children:["Σελίδα ",S," από ",Y()," • Σύνολο: ",x()," αιτήματα"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>T(1),disabled:S===1,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Πρώτη"}),e.jsx("button",{onClick:()=>T(t=>Math.max(t-1,1)),disabled:S===1,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Προηγούμενη"}),e.jsxs("span",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium",children:[S," / ",Y()]}),e.jsx("button",{onClick:()=>T(t=>Math.min(t+1,Y())),disabled:S===Y(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Επόμενη"}),e.jsx("button",{onClick:()=>T(Y()),disabled:S===Y(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Τελευταία"})]})]})}),u?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx(As,{className:"h-12 w-12 animate-spin text-blue-400 mx-auto mb-4"}),e.jsx("span",{className:"text-gray-300 font-medium text-lg",children:"Φόρτωση Ultimate αιτημάτων..."})]})}):M().length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-full p-6 w-24 h-24 mx-auto mb-6 shadow-2xl",children:e.jsx(Pa,{className:"h-12 w-12 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:v?"🔍 Δεν βρέθηκαν αποτελέσματα":"👑 Δεν υπάρχουν Ultimate αιτήματα"}),e.jsx("p",{className:"text-gray-300 text-lg",children:v?"Δοκιμάστε διαφορετικό όνομα για την αναζήτηση.":"Όταν οι χρήστες υποβάλουν αιτήματα για το πακέτο Ultimate, θα εμφανίζονται εδώ."})]}):e.jsx("div",{className:"grid gap-8",children:M().map(t=>{var i,w,C,B,$,V,Z,g,P,oe,ie,he,$e,ns,Ke,We,os,Be,Te,is,Ue,ds,Ve,He,Ye,Je,cs,ms,xs,gs,Me,je,Ee,Ne,Ts,Us,Ms,we,Es,us,hs,_e,Ie,Pe;return e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl shadow-2xl border border-gray-600 p-8 hover:shadow-3xl transition-all duration-300 transform hover:scale-102",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-6 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-start space-x-6",children:[e.jsxs("div",{className:"relative",children:[(i=t.user)!=null&&i.profile_photo?e.jsxs("div",{className:"w-16 h-16 rounded-2xl overflow-hidden shadow-2xl border-3 border-blue-400",children:[e.jsx("img",{src:t.user.profile_photo,alt:`${(w=t.user)==null?void 0:w.first_name} ${(C=t.user)==null?void 0:C.last_name}`,className:"w-full h-full object-cover",onError:G=>{G.currentTarget.style.display="none";const Qe=G.currentTarget.nextElementSibling;Qe&&(Qe.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center hidden",children:e.jsx(Ce,{className:"h-8 w-8 text-white"})})]}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-2xl",children:e.jsx(Ce,{className:"h-8 w-8 text-white"})}),t.status==="pending"&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full border-2 border-white shadow-lg animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h4",{className:"text-2xl font-bold text-white mb-2",children:[(B=t.user)==null?void 0:B.first_name," ",($=t.user)==null?void 0:$.last_name]}),e.jsxs("p",{className:"text-gray-300 mb-3 flex items-center text-lg",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),(V=t.user)==null?void 0:V.email]}),e.jsxs("div",{className:"flex items-center space-x-3 flex-wrap",children:[e.jsx("span",{className:"inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",children:"👑 Ultimate Package"}),e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsx("span",{className:"text-gray-200 font-medium",children:xt(t.duration_type)}),t.has_installments&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-xl text-sm font-medium bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg",children:"💳 Με Δόσεις"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-green-400 to-green-500 bg-clip-text text-transparent mb-2",children:ze(t.requested_price)}),e.jsxs("div",{className:"text-gray-300 flex items-center justify-end",children:[e.jsx(Se,{className:"h-4 w-4 mr-2 text-blue-400"}),e.jsx("span",{className:"font-medium",children:new Date(t.created_at).toLocaleDateString("el-GR")})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3",children:[t.status==="pending"&&e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("button",{onClick:()=>ae(t.id),disabled:ee,className:"px-8 py-4 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-2xl hover:from-green-700 hover:to-green-800 transition-all duration-200 text-lg font-bold shadow-2xl hover:shadow-3xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 transform hover:scale-110",children:[e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"✅ Εγκρίνω"})]}),e.jsxs("button",{onClick:()=>F(t.id),disabled:ee,className:"px-8 py-4 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-2xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-lg font-bold shadow-2xl hover:shadow-3xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 transform hover:scale-110",children:[e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{children:"❌ Απορρίπτω"})]})]}),t.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-green-500/20 to-green-600/20 rounded-xl p-3 border border-green-500/30",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl text-sm font-bold shadow-lg",children:"✅ Εγκεκριμένο"})]}),t.status==="rejected"&&e.jsxs("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-red-500/20 to-red-600/20 rounded-xl p-3 border border-red-500/30",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full animate-pulse"}),e.jsx("span",{className:"px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl text-sm font-bold shadow-lg",children:"❌ Απορριφθέν"})]}),e.jsxs("button",{onClick:()=>{window.confirm("Είστε σίγουροι ότι θέλετε να διαγράψετε αυτό το Ultimate αίτημα; Αυτή η ενέργεια δεν μπορεί να αναιρεθεί.")&&y(t.id)},className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-sm font-medium flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx(Cs,{className:"h-4 w-4"}),e.jsx("span",{children:"🗑️ Διαγραφή"})]})]})]})]}),t.has_installments&&e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-500/20 to-blue-600/20 rounded-2xl p-6 border border-blue-500/30 shadow-xl",children:[e.jsxs("h4",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"text-3xl mr-3",children:"💳"}),"Διαχείριση Δόσεων"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"1️⃣"}),"1η Δόση"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:((Z=m[t.id])==null?void 0:Z.installment1Amount)||t.installment_1_amount||"",onChange:G=>D(t.id,"installment1Amount",G.target.value),placeholder:"Ποσό",className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400 text-lg font-medium"}),e.jsxs("select",{value:((g=m[t.id])==null?void 0:g.installment1PaymentMethod)||t.installment_1_payment_method||"cash",onChange:G=>D(t.id,"installment1PaymentMethod",G.target.value),className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white text-lg font-medium",children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((P=m[t.id])==null?void 0:P.installment1DueDate)||t.installment_1_due_date||"",onChange:G=>D(t.id,"installment1DueDate",G.target.value),className:"w-full p-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"2️⃣"}),"2η Δόση"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:((oe=m[t.id])==null?void 0:oe.installment2Amount)||t.installment_2_amount||"",onChange:G=>D(t.id,"installment2Amount",G.target.value),placeholder:"Ποσό",className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400 text-lg font-medium"}),e.jsxs("select",{value:((ie=m[t.id])==null?void 0:ie.installment2PaymentMethod)||t.installment_2_payment_method||"cash",onChange:G=>D(t.id,"installment2PaymentMethod",G.target.value),className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white text-lg font-medium",children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((he=m[t.id])==null?void 0:he.installment2DueDate)||t.installment_2_due_date||"",onChange:G=>D(t.id,"installment2DueDate",G.target.value),className:"w-full p-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"3️⃣"}),"3η Δόση"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:(($e=m[t.id])==null?void 0:$e.installment3Amount)||t.installment_3_amount||"",onChange:G=>D(t.id,"installment3Amount",G.target.value),placeholder:"Ποσό",className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400 text-lg font-medium"}),e.jsxs("select",{value:((ns=m[t.id])==null?void 0:ns.installment3PaymentMethod)||t.installment_3_payment_method||"cash",onChange:G=>D(t.id,"installment3PaymentMethod",G.target.value),className:"w-full p-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white text-lg font-medium",children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((Ke=m[t.id])==null?void 0:Ke.installment3DueDate)||t.installment_3_due_date||"",onChange:G=>D(t.id,"installment3DueDate",G.target.value),className:"w-full p-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white"})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-500/30 to-blue-600/30 rounded-2xl border border-blue-500/50 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-blue-300 text-lg",children:"💰 Σύνολο Δόσεων:"}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-green-400 to-green-500 bg-clip-text text-transparent",children:ze(Number(((We=m[t.id])==null?void 0:We.installment1Amount)||t.installment_1_amount||0)+Number(((os=m[t.id])==null?void 0:os.installment2Amount)||t.installment_2_amount||0)+Number(((Be=m[t.id])==null?void 0:Be.installment3Amount)||t.installment_3_amount||0))})]}),e.jsxs("div",{className:"text-blue-200 mt-2 font-medium",children:["📊 Από ",ze(t.requested_price)," (Πακέτο Ultimate)"]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:()=>{var qe,fs,Is,Ls,Xs,Zs,qs,et,es;const G=parseFloat(((qe=m[t.id])==null?void 0:qe.installment1Amount)||t.installment_1_amount||"0"),Qe=parseFloat(((fs=m[t.id])==null?void 0:fs.installment2Amount)||t.installment_2_amount||"0"),bs=parseFloat(((Is=m[t.id])==null?void 0:Is.installment3Amount)||t.installment_3_amount||"0"),Js=((Ls=m[t.id])==null?void 0:Ls.installment1PaymentMethod)||t.installment_1_payment_method||"cash",ps=((Xs=m[t.id])==null?void 0:Xs.installment2PaymentMethod)||t.installment_2_payment_method||"cash",xe=((Zs=m[t.id])==null?void 0:Zs.installment3PaymentMethod)||t.installment_3_payment_method||"cash",Xe=((qs=m[t.id])==null?void 0:qs.installment1DueDate)||t.installment_1_due_date,Ze=((et=m[t.id])==null?void 0:et.installment2DueDate)||t.installment_2_due_date,Qs=((es=m[t.id])==null?void 0:es.installment3DueDate)||t.installment_3_due_date;U(t.id,G,Qe,bs,Js,ps,xe,Xe,Ze,Qs)},className:"px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-2xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center space-x-3 shadow-2xl hover:shadow-3xl transform hover:scale-110 font-bold text-lg",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{children:"💾 Αποθήκευση Δόσεων & Ημερομηνιών"})]})})]}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-6 border border-purple-500/30 shadow-xl",children:[e.jsxs("h4",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"text-3xl mr-3",children:"⚙️"}),"Program Options"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>{var G;L(t.id)||D(t.id,"oldMembers",!((G=m[t.id])!=null&&G.oldMembers))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${L(t.id)?(Te=N(t.id))!=null&&Te.oldMembers?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(is=m[t.id])!=null&&is.oldMembers?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:L(t.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"👴 Παλαιά μέλη"}),(L(t.id)?(Ue=N(t.id))==null?void 0:Ue.oldMembers:(ds=m[t.id])==null?void 0:ds.oldMembers)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),L(t.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🏋️‍♂️"}),"Kettlebell Points",L(t.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",value:L(t.id)?((Ve=N(t.id))==null?void 0:Ve.kettlebellPoints)||"":((He=m[t.id])==null?void 0:He.kettlebellPoints)||"",onChange:G=>{L(t.id)||D(t.id,"kettlebellPoints",G.target.value)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${L(t.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-purple-500 focus:border-purple-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε αριθμό...",disabled:L(t.id)})]}),e.jsx("button",{type:"button",onClick:()=>{var G;L(t.id)||D(t.id,"cash",!((G=m[t.id])!=null&&G.cash))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${L(t.id)?(Ye=N(t.id))!=null&&Ye.cash?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(Je=m[t.id])!=null&&Je.cash?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:L(t.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"💰 Μετρητά"}),(L(t.id)?(cs=N(t.id))==null?void 0:cs.cash:(ms=m[t.id])==null?void 0:ms.cash)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),L(t.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})}),e.jsx("button",{type:"button",onClick:()=>{var G;L(t.id)||D(t.id,"pos",!((G=m[t.id])!=null&&G.pos))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${L(t.id)?(xs=N(t.id))!=null&&xs.pos?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(gs=m[t.id])!=null&&gs.pos?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:L(t.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"💳 POS"}),(L(t.id)?(Me=N(t.id))==null?void 0:Me.pos:(je=m[t.id])==null?void 0:je.pos)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),L(t.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})})]}),(((Ee=m[t.id])==null?void 0:Ee.cash)||((Ne=N(t.id))==null?void 0:Ne.cash))&&e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-green-500/20 to-green-600/20 rounded-2xl p-5 border border-green-500/30",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💰"}),"Ποσό Μετρητών (€)",L(t.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:L(t.id)?((Us=(Ts=N(t.id))==null?void 0:Ts.cashAmount)==null?void 0:Us.toString())||"":((we=(Ms=m[t.id])==null?void 0:Ms.cashAmount)==null?void 0:we.toString())||"",onChange:G=>{L(t.id)||D(t.id,"cashAmount",parseFloat(G.target.value)||0)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${L(t.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-green-500 focus:border-green-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε ποσό σε €...",disabled:L(t.id)})]}),(((Es=m[t.id])==null?void 0:Es.pos)||((us=N(t.id))==null?void 0:us.pos))&&e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-blue-500/20 to-blue-600/20 rounded-2xl p-5 border border-blue-500/30",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💳"}),"Ποσό POS (€)",L(t.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:L(t.id)?((_e=(hs=N(t.id))==null?void 0:hs.posAmount)==null?void 0:_e.toString())||"":((Pe=(Ie=m[t.id])==null?void 0:Ie.posAmount)==null?void 0:Pe.toString())||"",onChange:G=>{L(t.id)||D(t.id,"posAmount",parseFloat(G.target.value)||0)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${L(t.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε ποσό σε €...",disabled:L(t.id)})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-4",children:[e.jsx("button",{onClick:()=>W(t.id,"approved"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${X[t.id]==="approved"?"bg-gradient-to-r from-green-600 to-green-700 text-white border-2 border-green-400":"bg-gradient-to-r from-green-500/20 to-green-600/20 text-green-300 border-2 border-green-500/30 hover:from-green-500/30 hover:to-green-600/30"}`,children:"✅ Έγκριση"}),e.jsx("button",{onClick:()=>W(t.id,"rejected"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${X[t.id]==="rejected"?"bg-gradient-to-r from-red-600 to-red-700 text-white border-2 border-red-400":"bg-gradient-to-r from-red-500/20 to-red-600/20 text-red-300 border-2 border-red-500/30 hover:from-red-500/30 hover:to-red-600/30"}`,children:"❌ Απόρριψη"}),e.jsx("button",{onClick:()=>W(t.id,"pending"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${X[t.id]==="pending"?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white border-2 border-yellow-400":"bg-gradient-to-r from-yellow-500/20 to-yellow-600/20 text-yellow-300 border-2 border-yellow-500/30 hover:from-yellow-500/30 hover:to-yellow-600/30"}`,children:"⏳ Αναμονή"}),e.jsxs("button",{onClick:()=>_(t.id),disabled:ee||X[t.id]==="none",className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-2xl hover:from-purple-700 hover:to-purple-800 transition-all duration-200 text-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center shadow-2xl hover:shadow-3xl transform hover:scale-105",children:[ee?e.jsx(As,{className:"h-5 w-5 animate-spin mr-2"}):e.jsx(Oe,{className:"h-5 w-5 mr-2"}),"💾 Αποθήκευση Program Options"]})]})]})]},t.id)})})]})};class ll extends d.Component{constructor(){super(...arguments);Ws(this,"state",{hasError:!1});Ws(this,"handleRefresh",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0}),window.location.reload()});Ws(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})})}static getDerivedStateFromError(v){return{hasError:!0,error:v}}componentDidCatch(v,A){console.error("ErrorBoundary caught an error:",v,A),this.setState({error:v,errorInfo:A}),console.error("Production error:",{error:v,errorInfo:A})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ht,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Κάτι πήγε στραβά"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Παρουσιάστηκε ένα απροσδόκητο σφάλμα στην εφαρμογή. Παρακαλώ δοκιμάστε να ανανεώσετε τη σελίδα."}),!1,e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:this.handleReset,className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"Δοκιμή Ξανά"}),e.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Ανανέωση Σελίδας"})]})]})]})}):this.props.children}}const ct=async(n,u)=>{try{const{error:v}=await O.from("user_old_members_usage").insert({user_id:n,created_by:u});return v?(console.error("Error marking old members as used:",v),!1):!0}catch(v){return console.error("Exception marking old members as used:",v),!1}},mt=async(n,u,v,A)=>{try{if(u<=0)return!0;const{error:m}=await O.from("user_kettlebell_points").insert({user_id:n,points:u,program_id:v,created_by:A});return m?(console.error("Error saving kettlebell points:",m),!1):!0}catch(m){return console.error("Exception saving kettlebell points:",m),!1}},nl=async()=>{try{console.log("[getTotalKettlebellPoints] Starting to fetch total points...");const{data:n,error:u}=await O.from("user_kettlebell_points").select("points");if(u)return console.error("[getTotalKettlebellPoints] Error getting total kettlebell points:",u),0;const v=(n==null?void 0:n.reduce((A,m)=>A+m.points,0))||0;return console.log("[getTotalKettlebellPoints] Total points calculated:",v,"from",(n==null?void 0:n.length)||0,"records"),v}catch(n){return console.error("[getTotalKettlebellPoints] Exception getting total kettlebell points:",n),0}},ol=async()=>{try{console.log("[getKettlebellPointsSummary] Starting to fetch kettlebell points...");const{data:n,error:u}=await O.from("user_kettlebell_points").select(`
        user_id,
        points,
        created_at,
        user_profiles!user_kettlebell_points_user_id_fkey(
          first_name,
          last_name,
          email
        )
      `).order("created_at",{ascending:!1});if(u)return console.error("[getKettlebellPointsSummary] Error getting kettlebell points summary:",u),[];if(console.log("[getKettlebellPointsSummary] Raw data received:",(n==null?void 0:n.length)||0,"records"),console.log("[getKettlebellPointsSummary] Sample data:",n==null?void 0:n.slice(0,2)),!n||n.length===0)return console.log("[getKettlebellPointsSummary] No data found, returning empty array"),[];const v=new Map;n.forEach(m=>{const D=m.user_id,U=m.user_profiles;v.has(D)||v.set(D,{user_id:D,user_name:U?`${U.first_name||""} ${U.last_name||""}`.trim():`User ${D.slice(0,8)}`,user_email:(U==null?void 0:U.email)||"No email",total_points:0,points_count:0,last_updated:m.created_at});const y=v.get(D);y.total_points+=m.points,y.points_count+=1,new Date(m.created_at)>new Date(y.last_updated)&&(y.last_updated=m.created_at)});const A=Array.from(v.values()).sort((m,D)=>D.total_points-m.total_points);return console.log("[getKettlebellPointsSummary] Processed summary:",A),A}catch(n){return console.error("[getKettlebellPointsSummary] Exception getting kettlebell points summary:",n),[]}},il=async n=>{try{const{data:u,error:v}=await O.from("user_kettlebell_points").select("*").eq("user_id",n).order("created_at",{ascending:!1});return v?(console.error("Error getting user kettlebell points:",v),[]):u||[]}catch(u){return console.error("Exception getting user kettlebell points:",u),[]}},Ur=["Mike","Jordan"],dl=100,Nl=()=>{var At,Ct,Dt,$t,Tt,Ut,Mt,Et,It,Lt,Rt,Gt,Ot,Ft,zt,Kt;const{user:n}=Sa(),[u,v]=d.useState("personal-training"),[A,m]=d.useState([]),[D,U]=d.useState([]),[y,ge]=d.useState(1),[ae]=d.useState(10),[F,ee]=d.useState({"personal-training":!1,"membership-packages":!1,"ultimate-subscriptions":!1,"pilates-schedule":!1,"kettlebell-points":!1,"cash-register":!1}),X=d.useMemo(()=>{const s=(y-1)*ae,r=s+ae;return A.slice(s,r)},[A,y,ae]);Math.ceil(A.length/ae);const[W]=d.useState(null),[_,Q]=d.useState(null),[p,S]=d.useState(!1),[T,E]=d.useState(!1),[se,M]=d.useState(!1),[x,Y]=d.useState({code:"",selectedUserId:""}),[a,L]=d.useState("individual"),[N,t]=d.useState("personal"),[i,w]=d.useState([]),[C,B]=d.useState(null),[$,V]=d.useState(null),[Z,g]=d.useState(0),[P,oe]=d.useState(1),[ie,he]=d.useState(2),[$e,ns]=d.useState(!1),[Ke,We]=d.useState(null),[os,Be]=d.useState(null),[Te,is]=d.useState({}),[Ue,ds]=d.useState(""),[Ve,He]=d.useState("dropdown"),[Ye]=d.useState(""),[Je]=d.useState("all"),[cs]=d.useState(!0),[ms,xs]=d.useState(new Set),[gs,Me]=d.useState(""),[je,Ee]=d.useState({}),[Ne,Ts]=d.useState([]),[Us,Ms]=d.useState(0),[we,Es]=d.useState(""),[us,hs]=d.useState([]),[_e,Ie]=d.useState(""),[Pe,G]=d.useState(""),[Qe,bs]=d.useState(!1),[Js,ps]=d.useState(!1),[xe,Xe]=d.useState("none"),[Ze,Qs]=d.useState([]),[qe,fs]=d.useState(!1),[Is,Ls]=d.useState(""),[Xs,Zs]=d.useState(!1),[qs,et]=d.useState(1),[es,bt]=d.useState(new Set),[st,pt]=d.useState({}),k=s=>es.has(s),fe=s=>st[s]||null,b=s=>Gs.has(s),te=s=>Os[s]||null;d.useEffect(()=>{g($?$*4:0)},[$]),d.useEffect(()=>{a==="individual"&&(B(null),V(null),g(0)),a==="combination"&&t("personal")},[a]),d.useEffect(()=>{(a==="group"&&i.length>0||a==="combination"&&x.selectedUserId)&&(C||(console.log("[AdminPanel] Auto-setting default group room to 3 for",a),B("3")))},[a,i.length,x.selectedUserId]),d.useEffect(()=>{var s,r;if((a==="individual"||a==="combination")&&x.selectedUserId){const l=fe(x.selectedUserId);l&&(Me(l.kettlebellPoints||""),Ie(((s=l.cashAmount)==null?void 0:s.toString())||""),G(((r=l.posAmount)==null?void 0:r.toString())||""))}},[x.selectedUserId,a]);const[ye,pe]=d.useState([{id:"tmp-1",date:new Date().toISOString().split("T")[0],startTime:"18:00",endTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:""}]),[Ir,Lr]=d.useState([]),[Rr,tt]=d.useState([]),[ve,Gr]=d.useState(null),[ke,Rs]=d.useState(null),[rt,ys]=d.useState(""),[at,Or]=d.useState([]),[Ae,ss]=d.useState(1),[ts,Fr]=d.useState(""),js=6,[J,zr]=d.useState({}),[rs,ft]=d.useState({}),[Gs,yt]=d.useState(new Set),[Os,jt]=d.useState({}),[Kr,vt]=d.useState([]),Wr=[{id:"personal-training",name:"Personal Training Πρόγραμμα",icon:Se},{id:"membership-packages",name:"Πακέτα Συνδρομών",icon:it},{id:"ultimate-subscriptions",name:"👑 Ultimate Συνδρομές",icon:Ce},{id:"pilates-schedule",name:"Πρόγραμμα Pilates",icon:Hs},{id:"kettlebell-points",name:"Kettlebell Points",icon:Bs},{id:"cash-register",name:"Ταμείο",icon:gt}],Br=["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],Vr=s=>{const r=["user1@freegym.gr","user2@freegym.gr"],l=["PERSONAL2024","KICKBOX2024"],o=!!s.email&&r.includes(s.email),c=!!s.personalTrainingCode&&l.includes(s.personalTrainingCode);return o||c},Nt=A.filter(s=>{if(!Ue)return!0;const r=Ue.toLowerCase();return s.firstName.toLowerCase().includes(r)||s.lastName.toLowerCase().includes(r)||s.email.toLowerCase().includes(r)||`${s.firstName} ${s.lastName}`.toLowerCase().includes(r)});D.filter(s=>{const r=!Ye||(()=>{const o=Ye.toLowerCase();return s.user.firstName.toLowerCase().includes(o)||s.user.lastName.toLowerCase().includes(o)||s.user.email.toLowerCase().includes(o)||`${s.user.firstName} ${s.user.lastName}`.toLowerCase().includes(o)})(),l=Je==="all"||s.status===Je;return r&&l}),d.useEffect(()=>{ge(1)},[Ye,Je]);const wt=["06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00"],Hr=async()=>{try{console.log("[AdminPanel] Checking admin role in database...");const{data:s,error:r}=await O.from("user_profiles").select("user_id, role, first_name, last_name, email").eq("user_id",n==null?void 0:n.id).single();return r?(console.error("[AdminPanel] Error checking admin profile:",r),!1):(console.log("[AdminPanel] Admin profile in database:",s),console.log("[AdminPanel] Admin role in database:",s==null?void 0:s.role),(s==null?void 0:s.role)==="admin")}catch(s){return console.error("[AdminPanel] Exception checking admin role:",s),!1}},Yr=async()=>{try{console.log("[AdminPanel] Testing if we can create data...");const s={user_id:n==null?void 0:n.id,month:1,year:2e3,schedule_data:{sessions:[]},status:"pending",created_by:n==null?void 0:n.id},{data:r,error:l}=await O.from("personal_training_schedules").insert(s).select();return l?(console.log("[AdminPanel] Cannot create data - RLS blocking:",l.message),!1):r&&r.length>0?(await O.from("personal_training_schedules").delete().eq("id",r[0].id),console.log("[AdminPanel] Can create data - RLS working correctly"),!0):!1}catch(s){return console.error("[AdminPanel] Exception testing data creation:",s),!1}},Jr=async(s,r)=>{if(!r){console.log("[AdminPanel] No admin ID available for test data creation");return}try{console.log("[AdminPanel] Creating test schedule for user:",s.email);const l={user_id:s.id,month:new Date().getMonth()+1,year:new Date().getFullYear(),schedule_data:{sessions:[{id:"test-1",date:new Date().toISOString().split("T")[0],startTime:"18:00",endTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",notes:"Test session created by admin"}],notes:"Test program created by admin",specialInstructions:"This is test data"},status:"pending",created_by:r},{data:o,error:c}=await O.from("personal_training_schedules").insert(l).select();c?console.error("[AdminPanel] Error creating test schedule:",c):(console.log("[AdminPanel] Test schedule created successfully:",o),setTimeout(()=>{lt()},1e3))}catch(l){console.error("[AdminPanel] Exception creating test schedule:",l)}},lt=d.useCallback(async()=>{console.log("[AdminPanel] ===== DATA LOADING STARTED ====="),console.log("[AdminPanel] Current user:",n==null?void 0:n.email,"Role:",n==null?void 0:n.role);try{S(!0),console.log("[AdminPanel] Querying user_profiles table...");const{data:s,error:r}=await O.from("user_profiles").select("*").order("created_at",{ascending:!1});if(console.log("[AdminPanel] User profiles query result - rows:",s==null?void 0:s.length,"error:",r),r)throw console.error("[AdminPanel] User profiles error:",r),r;console.log("[AdminPanel] Querying personal_training_schedules table..."),console.log("[AdminPanel] Current auth user ID:",n==null?void 0:n.id),console.log("[AdminPanel] Current auth user role:",n==null?void 0:n.role),console.log("[AdminPanel] Attempting to query personal_training_schedules...");let l=[],o=null;const{data:c,error:f}=await O.from("personal_training_schedules").select("id,user_id,month,year,schedule_data,status,created_by,created_at,updated_at,trainer_name,accepted_at,declined_at").order("created_at",{ascending:!1});if(f){console.log("[AdminPanel] Direct query failed:",f);const{data:j,error:q}=await O.from("personal_training_schedules").select("id, user_id, status").limit(10);if(q){console.log("[AdminPanel] Limited query also failed:",q);const{count:be,error:le}=await O.from("personal_training_schedules").select("*",{count:"exact",head:!0});console.log("[AdminPanel] Count query result:",be,"error:",le)}else console.log("[AdminPanel] Limited query succeeded:",j),l=j||[]}else console.log("[AdminPanel] Direct query succeeded:",c),l=c||[];if(o=f,console.log("[AdminPanel] Schedules query result - rows:",l==null?void 0:l.length,"error:",o),(l==null?void 0:l.length)===0&&!o){console.log("[AdminPanel] Query succeeded but returned 0 rows - checking RLS policies...");const j=await Hr();console.log("[AdminPanel] Is admin in database:",j);const{count:q,error:be}=await O.from("personal_training_schedules").select("*",{count:"exact",head:!0});console.log("[AdminPanel] Total rows in table (bypassing RLS):",q,"error:",be),q&&q>0&&(console.warn("[AdminPanel] RLS is blocking access to existing data! Table has",q,"rows but query returns 0."),console.warn("[AdminPanel] Admin role might not be properly configured in RLS policies."),console.warn("[AdminPanel] Please run the SQL script: database/fix_admin_rls_policies.sql"))}if(o){console.error("[AdminPanel] Schedules query failed with error:",o),console.log("[AdminPanel] Error code:",o.code),console.log("[AdminPanel] Error message:",o.message),console.log("[AdminPanel] Error details:",o.details),console.log("[AdminPanel] Error hint:",o.hint),console.log("[AdminPanel] Attempting to check table existence...");const{data:j,error:q}=await O.from("personal_training_schedules").select("count").limit(1);console.log("[AdminPanel] Table check result:",j,"error:",q)}if(o&&(console.error("[AdminPanel] Schedules error:",o),console.log("[AdminPanel] RLS might be blocking access. Checking if we can insert test data..."),console.log("[AdminPanel] Continuing with empty schedules due to RLS restrictions")),!s||s.length===0){console.log("[AdminPanel] No users found in database - setting empty states"),m([]),U([]);return}console.log("[AdminPanel] Transforming user profiles...");const R=s.map(j=>({id:j.user_id,email:j.email||`user-${j.user_id.slice(0,8)}@example.com`,firstName:j.first_name||"",lastName:j.last_name||"",profile_photo:j.profile_photo||"",profile_photo_locked:j.profile_photo_locked||!1,dob:j.dob||"",address:j.address||"",emergency_contact:j.emergency_contact||"",dob_locked:j.dob_locked||!1,hasPersonalTrainingCode:!1,personalTrainingCode:void 0,packageType:void 0}));console.log("[AdminPanel] Transformed users count:",R.length),m(R),ee(j=>({...j,"personal-training":!0})),console.log("[AdminPanel] Creating program statuses from schedules..."),console.log("[AdminPanel] Schedules data:",l);const de=(l||[]).map(j=>{console.log("[AdminPanel] Processing schedule:",j.id,"for user:",j.user_id);const q=R.find(le=>le.id===j.user_id);if(!q)return console.warn(`[AdminPanel] User not found for schedule ${j.id}, user_id: ${j.user_id}`),null;const be={user:q,schedule:{id:j.id,userId:j.user_id,month:j.month,year:j.year,status:j.status,scheduleData:j.schedule_data,createdBy:j.created_by,createdAt:j.created_at,updatedAt:j.updated_at,acceptedAt:j.accepted_at,declinedAt:j.declined_at},status:j.status};return console.log("[AdminPanel] Created program status:",be),be}).filter(j=>j!==null);console.log("[AdminPanel] Final program statuses count:",de.length),de.length===0&&R.length>0&&(console.log("[AdminPanel] No schedules found. Creating test data to verify system..."),await Yr()?await Jr(R[0],n==null?void 0:n.id):(console.warn("[AdminPanel] Cannot create test data due to RLS restrictions."),console.warn("[AdminPanel] Please fix RLS policies by running: database/fix_admin_rls_policies.sql"))),U(de),console.log("[AdminPanel] Checking personal training codes...");const{data:re,error:I}=await O.from("personal_training_codes").select("*").limit(5);console.log("[AdminPanel] Personal training codes check - rows:",re==null?void 0:re.length,"error:",I),await Qr(R),ee(j=>({...j,"personal-training":!0})),console.log("[AdminPanel] ===== DATA LOADING COMPLETED SUCCESSFULLY =====")}catch(s){console.error("[AdminPanel] ===== DATA LOADING FAILED ====="),console.error("[AdminPanel] Error details:",s);const r=s instanceof Error?s.message:"Unknown error";h.error(`Σφάλμα κατά τη φόρτωση των χρηστών: ${r}`),m([]),U([])}finally{S(!1)}},[n==null?void 0:n.email,n==null?void 0:n.role]),Qr=async s=>{try{const{data:r,error:l}=await O.from("personal_training_codes").select("user_id, code, package_type, sessions_remaining").eq("is_active",!0);if(l){console.error("Error fetching personal training codes:",l),m(s);return}const o=s.map(c=>{const f=r==null?void 0:r.find(R=>R.user_id===c.id);return f?{...c,hasPersonalTrainingCode:!0,personalTrainingCode:f.code,packageType:f.package_type}:c});m(o)}catch(r){console.error("Error checking personal training codes:",r)}},[Xr,as]=d.useState({});d.useEffect(()=>{if(console.log("[AdminPanel] useEffect triggered - user:",n==null?void 0:n.email,"role:",n==null?void 0:n.role,"activeTab:",u),!n){console.log("[AdminPanel] No user logged in");return}if(n.role!=="admin"){console.warn("[AdminPanel] User is not admin! Role:",n.role,"Email:",n.email);return}if(Xr[u]){console.log(`[AdminPanel] ${u} is already loading, skipping...`);return}u==="personal-training"&&!F["personal-training"]?(console.log("[AdminPanel] Loading data for personal-training tab"),as(s=>({...s,[u]:!0})),lt().finally(()=>as(s=>({...s,[u]:!1})))):u==="membership-packages"&&!F["membership-packages"]?(console.log("[AdminPanel] Loading membership packages"),as(s=>({...s,[u]:!0})),_t().finally(()=>as(s=>({...s,[u]:!1})))):u==="kettlebell-points"&&!F["kettlebell-points"]?(console.log("[AdminPanel] Loading kettlebell points"),as(s=>({...s,[u]:!0})),nt().finally(()=>as(s=>({...s,[u]:!1})))):console.log(`[AdminPanel] ${u} data already loaded, skipping reload`)},[n==null?void 0:n.id,u]);const Zr=()=>{if(!_)return;const s={id:Date.now().toString(),date:new Date().toISOString().split("T")[0],startTime:"09:00",endTime:"10:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",notes:""},r={..._,scheduleData:{..._.scheduleData,sessions:[..._.scheduleData.sessions,s]}};Q(r)},ls=(s,r,l)=>{if(!_)return;const o=_.scheduleData.sessions.map(f=>f.id===s?{...f,[r]:l}:f),c={..._,scheduleData:{..._.scheduleData,sessions:o}};Q(c)},qr=s=>{if(!_)return;const r=_.scheduleData.sessions.filter(o=>o.id!==s),l={..._,scheduleData:{..._.scheduleData,sessions:r}};Q(l)},ea=async()=>{if(!(!_||!W))try{S(!0),h.success(`Το πρόγραμμα για τον ${W.firstName} ${W.lastName} αποθηκεύτηκε!`),E(!1)}catch{h.error("Σφάλμα κατά την αποθήκευση του προγράμματος")}finally{S(!1)}},sa=async()=>{if(xe==="none"||!n){h.error("Παρακαλώ επιλέξτε μια κατάσταση έγκρισης");return}try{S(!0);const s=a==="individual"||a==="combination"?[x.selectedUserId]:i;if(s.length===0){h.error("Δεν υπάρχουν επιλεγμένοι χρήστες");return}if(a==="group"){if(!C||!$){h.error("Παρακαλώ επιλέξτε Ομαδική Αίθουσα και συχνότητα εβδομάδας");return}if(i.length===0){h.error("Παρακαλώ επιλέξτε τουλάχιστον έναν χρήστη για το ομαδικό πρόγραμμα");return}}if(a==="combination"&&ie>0&&(!C||!$)){h.error("Για συνδυασμένο πρόγραμμα με ομαδικές σεσίες, παρακαλώ επιλέξτε Ομαδική Αίθουσα και συχνότητα εβδομάδας");return}for(const o of s){const c=k(o),f=c?fe(o):je[o];if(!f)continue;await Tr(o,xe,{oldMembersUsed:f.oldMembers||!1,kettlebellPoints:f.kettlebellPoints?parseInt(f.kettlebellPoints):0,cashAmount:f.cashAmount||0,posAmount:f.posAmount||0,createdBy:n.id,groupRoomSize:a==="group"||a==="combination"?parseInt(C):null,weeklyFrequency:a==="group"||a==="combination"?$:null,monthlyTotal:a==="group"||a==="combination"?Z:null,notes:`Program options saved with ${xe} status${c?" (from frozen state)":""}${a==="group"||a==="combination"?` - Ομαδική Αίθουσα: ${C} χρήστες, ${$} φορές/εβδομάδα`:""}`})?console.log(`Program approval state saved for user ${o}: ${xe}${c?" (from frozen state)":""}`):console.warn(`Failed to save program approval state for user ${o}`)}if(xe==="approved")await ta(s);else if(xe==="rejected")console.log("Program options rejected - no actions executed"),h("Program Options απορρίφθηκαν - δεν εκτελέστηκαν ενέργειες",{icon:"ℹ️"});else if(xe==="pending"){console.log("Program options pending - saving locally and freezing UI");const o={...st},c=new Set(es);for(const f of s){const R=je[f];R&&(o[f]={oldMembers:R.oldMembers,kettlebellPoints:R.kettlebellPoints,cash:R.cash,pos:R.pos,cashAmount:R.cashAmount,posAmount:R.posAmount,groupRoomSize:a==="group"||a==="combination"?parseInt(C):null,weeklyFrequency:a==="group"||a==="combination"?$:null,monthlyTotal:a==="group"||a==="combination"?Z:null},c.add(f))}pt(o),bt(c),h("Program Options τοποθετήθηκαν στην αναμονή - οι επιλογές παγώθηκαν",{icon:"⏳"})}if(Xe("none"),xe==="approved"||xe==="rejected"){const o=new Set(es),c={...st};for(const f of s)k(f)&&(o.delete(f),delete c[f]);bt(o),pt(c)}const r=s.some(o=>k(o)),l={approved:r?"εγκρίθηκε και εκτελέστηκαν οι ενέργειες (από frozen state)":"εγκρίθηκε και εκτελέστηκαν οι ενέργειες",rejected:r?"απορρίφθηκε (από frozen state)":"απορρίφθηκε",pending:"τοποθετήθηκε στην αναμονή"};h.success(`Program Options ${l[xe]} επιτυχώς!`)}catch(s){console.error("Error saving program options:",s),h.error("Σφάλμα κατά την αποθήκευση των Program Options")}finally{S(!1)}},ta=async s=>{console.log("Executing approved program actions for users:",s);try{for(const r of s){const l=k(r),o=l?fe(r):je[r];o&&(o.oldMembers&&(await ct(r,(n==null?void 0:n.id)||"")?(console.log(`[APPROVED] Old Members marked as used for user: ${r}${l?" (from frozen state)":""}`),xs(f=>new Set([...f,r]))):console.warn(`[APPROVED] Failed to mark Old Members as used for user: ${r}${l?" (from frozen state)":""}`)),o.kettlebellPoints&&parseInt(o.kettlebellPoints)>0&&(await mt(r,parseInt(o.kettlebellPoints),void 0,(n==null?void 0:n.id)||"")?console.log(`[APPROVED] Kettlebell Points saved for user: ${r}, Points: ${o.kettlebellPoints}${l?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save Kettlebell Points for user: ${r}${l?" (from frozen state)":""}`)),o.cashAmount&&o.cashAmount>0&&(await Vs(r,o.cashAmount,"cash",void 0,(n==null?void 0:n.id)||"","Cash transaction from approved program creation")?console.log(`[APPROVED] Cash transaction saved for user: ${r}, Amount: €${o.cashAmount}${l?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save Cash transaction for user: ${r}${l?" (from frozen state)":""}`)),o.posAmount&&o.posAmount>0&&(await Vs(r,o.posAmount,"pos",void 0,(n==null?void 0:n.id)||"","POS transaction from approved program creation")?console.log(`[APPROVED] POS transaction saved for user: ${r}, Amount: €${o.posAmount}${l?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save POS transaction for user: ${r}${l?" (from frozen state)":""}`)))}h.success("Έγιναν όλες οι απαραίτητες ενέργειες για τα εγκεκριμένα προγράμματα!")}catch(r){console.error("Error executing approved program actions:",r),h.error("Σφάλμα κατά την εκτέλεση των ενεργειών")}},ra=async()=>{var r,l,o;const s=a==="individual"||a==="combination"?[x.selectedUserId]:i;if(s.length===0){h.error("Παρακαλώ επιλέξτε χρήστη/ες");return}try{S(!0),console.log("[ADMIN] Starting to create personal training program..."),console.log("[ADMIN] User type:",N);for(const re of s){const I=A.find(K=>K.id===re);if(!I){h.error(`Δεν βρέθηκε ο χρήστης με ID: ${re}`);continue}console.log("[ADMIN] Selected user:",I.firstName,I.lastName,"ID:",I.id),console.log("[ADMIN] Admin user ID:",n==null?void 0:n.id);let j=[];if(a==="group")if(N==="paspartu"){const K=Te[I.id]||[];K.length>0?j=K.map((H,ne)=>({id:`group-session-${ne+1}`,date:H.date,startTime:H.startTime,endTime:H.endTime,type:"personal",trainer:H.trainer||"Mike",room:H.room||"Αίθουσα Mike",notes:`Group Paspartu Session ${ne+1} - ${H.notes||""}`})):(j=ye.map(H=>({id:H.id,date:H.date,startTime:H.startTime,endTime:H.endTime,type:H.type,trainer:H.trainer||"Mike",room:H.room,notes:H.notes+" (Group Paspartu)"})),console.log(`[ADMIN] Using ${j.length} program sessions for Group Paspartu user: ${I.email}`))}else j=[];else a==="combination"?j=ye.slice(0,P).map(K=>({id:K.id,date:K.date,startTime:K.startTime,endTime:K.endTime,type:K.type,trainer:K.trainer||"Mike",room:K.room,notes:K.notes+" (Personal - Συνδυασμός)"})):j=ye.map(K=>({id:K.id,date:K.date,startTime:K.startTime,endTime:K.endTime,type:K.type,trainer:K.trainer||"Mike",room:K.room,notes:K.notes}));const q={user_id:I.id,trainer_name:a==="group"?"Mike":((r=j[0])==null?void 0:r.trainer)||"Mike",month:new Date().getMonth()+1,year:new Date().getFullYear(),schedule_data:{sessions:j,notes:a==="group"?"Group program - Οι σεσίες θα προστεθούν μέσω του Group Assignment Interface":a==="combination"?`Combination program - ${P} Personal + ${ie} Group sessions`:"",trainer:a==="group"?"Mike":((l=j[0])==null?void 0:l.trainer)||"Mike",specialInstructions:a==="group"?"Ομαδικό πρόγραμμα - Οι λεπτομέρειες των σεσίων διαχειρίζονται ξεχωριστά":a==="combination"?`Συνδυασμένο πρόγραμμα - Περιλαμβάνει ${P} ατομικές σεσίες και ${ie} ομαδικές σεσίες`:"",groupRoomSize:a==="group"||a==="combination"?parseInt(C):null,weeklyFrequency:a==="group"||a==="combination"?$:null,monthlyTotal:a==="group"||a==="combination"?Z:null,combinationPersonalSessions:a==="combination"?P:null,combinationGroupSessions:a==="combination"?ie:null},status:"accepted",created_by:n==null?void 0:n.id,user_type:N,is_flexible:N==="paspartu",training_type:a,group_room_size:a==="group"||a==="combination"?parseInt(C):null,weekly_frequency:a==="group"||a==="combination"?$:null,monthly_total:a==="group"||a==="combination"?Z:null};console.log("[ADMIN] Schedule payload:",q),console.log("[ADMIN] Inserting schedule into personal_training_schedules...");const{data:be,error:le}=await O.from("personal_training_schedules").insert(q).select().single();if(le)throw console.error("[ADMIN] Schedule insertion error:",le),le;if(console.log("[ADMIN] Schedule inserted successfully for user:",I.email),a==="combination"&&j.length>0){console.log("[ADMIN] Creating group_sessions for combination individual sessions...",j);const K=j.map(me=>({session_date:me.date,start_time:me.startTime,end_time:me.endTime,trainer:me.trainer,room:me.room,group_type:null,notes:me.notes+" (Individual - Combination Program)"})),{data:H,error:ne}=await O.from("group_sessions").insert(K.map(me=>({program_id:be.id,user_id:I.id,session_date:me.session_date,start_time:me.start_time,end_time:me.end_time,trainer:me.trainer,room:me.room,group_type:me.group_type,notes:me.notes,is_active:!0,created_by:(n==null?void 0:n.id)||""})));ne?(console.error("[ADMIN] Error creating group_sessions for combination individual sessions:",ne),h.error("Σφάλμα κατά τη δημιουργία των ατομικών σεσίων του συνδυασμού")):console.log("[ADMIN] Created group_sessions for combination individual sessions:",H)}const ce=je[I.id];if(ce&&(ce.oldMembers&&(await ct(I.id,(n==null?void 0:n.id)||"")?console.log("[ADMIN] Old Members marked as used for user:",I.email):console.warn("[ADMIN] Failed to mark Old Members as used for user:",I.email)),ce.kettlebellPoints&&parseInt(ce.kettlebellPoints)>0&&(await mt(I.id,parseInt(ce.kettlebellPoints),be.id,(n==null?void 0:n.id)||"")?console.log("[ADMIN] Kettlebell Points saved for user:",I.email,"Points:",ce.kettlebellPoints):console.warn("[ADMIN] Failed to save Kettlebell Points for user:",I.email))),N==="paspartu"){console.log("[ADMIN] Handling Paspartu user - replacing old schedule and managing deposits...");const{error:K}=await O.rpc("replace_paspartu_schedule",{p_user_id:I.id,p_new_schedule_id:be.id});K?(console.error("[ADMIN] Error replacing old Paspartu schedule:",K),console.warn("[ADMIN] Failed to replace old schedule, but new schedule was created successfully")):console.log("[ADMIN] Old Paspartu schedule replaced successfully for user:",I.email);let H=5,ne=0;a==="combination"?(ne=P+ie,console.log(`[ADMIN] Combination Paspartu: ${P} personal + ${ie} group = ${ne} used deposits`)):a==="individual"?(ne=0,console.log("[ADMIN] Individual Paspartu: Credit 5 lessons, no deduction (original behavior)")):a==="group"&&(ne=0,console.log("[ADMIN] Group Paspartu: Credit 5 lessons, no deduction (same as Individual)")),ne>H&&(console.warn(`[ADMIN] Warning: Used deposits (${ne}) exceeds total deposits (${H}). Setting to max.`),ne=H);const{error:me}=await O.rpc("reset_lesson_deposit_for_new_program",{p_user_id:I.id,p_total_lessons:H,p_created_by:n==null?void 0:n.id});if(me)console.error("[ADMIN] Lesson deposit reset error:",me),console.warn("[ADMIN] Failed to reset lesson deposit, but schedule was created successfully");else if(console.log(`[ADMIN] Lesson deposit reset successfully for Paspartu user: ${I.email}`),console.log(`[ADMIN] Deposits: ${H} total, ${ne} will be used, ${H-ne} remaining`),ne>0){const{error:Ss}=await O.from("lesson_deposits").update({used_lessons:ne,updated_at:new Date().toISOString()}).eq("user_id",I.id);Ss?console.error("[ADMIN] Error updating used deposits:",Ss):console.log(`[ADMIN] Updated used deposits to ${ne} for user: ${I.email}`)}}if(N==="paspartu"){console.log("[ADMIN] Ensuring lesson deposit exists for Paspartu user:",I.email);const{data:K}=await O.from("lesson_deposits").select("id").eq("user_id",I.id).single();if(K)console.log("[ADMIN] Lesson deposit already exists for Paspartu user:",I.email);else{const{error:H}=await O.from("lesson_deposits").insert({user_id:I.id,total_lessons:5,used_lessons:0});H?console.error("[ADMIN] Error creating lesson deposit:",H):console.log("[ADMIN] Lesson deposit created successfully for Paspartu user:",I.email)}}console.log("[ADMIN] Creating Personal Training membership...");const{data:Ge,error:_s}=await O.from("membership_packages").select("id").eq("name","Personal Training").eq("is_active",!0).single();if(_s||!Ge){console.error("[ADMIN] Error finding Personal Training package:",_s),console.warn("[ADMIN] Personal Training package not found, skipping membership creation");continue}const Ks={user_id:I.id,package_id:Ge.id,duration_type:"lesson",start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_active:!0,approved_by:n==null?void 0:n.id,approved_at:new Date().toISOString()},{error:Ps}=await O.from("memberships").insert(Ks);Ps?(console.error("[ADMIN] Membership insertion error:",Ps),console.warn("[ADMIN] Failed to create membership, but schedule was created successfully")):console.log("[ADMIN] Personal Training membership created successfully for user:",I.email)}const c=s.map(re=>{const I=A.find(j=>j.id===re);return I?`${I.firstName} ${I.lastName}`:"Άγνωστος"}).join(", "),f=N==="personal"?"Personal":"Paspartu",R=a==="individual"?"Ατομικό":a==="combination"?"Συνδυασμένο":"Ομαδικό",de=a==="individual"||a==="combination"?"τον χρήστη":"τους χρήστες";if(h.success(`Το πρόγραμμα ${R} ${f} Training δημιουργήθηκε επιτυχώς για ${de}: ${c}!`),(a==="group"||a==="combination")&&s.length>0&&Object.keys(Te).length>0){console.log("[AdminPanel] Creating group sessions for selected slots:",Te);for(const re of s){const I=Te[re];if(I&&I.length>0){const{data:j}=await O.from("personal_training_schedules").select("id").eq("user_id",re).in("training_type",["group","combination"]).order("created_at",{ascending:!1}).limit(1);if(j&&j.length>0){const q=j[0].id,be=I.map(ce=>({session_date:ce.date,start_time:ce.startTime,end_time:ce.endTime,trainer:ce.trainer,room:ce.room,group_type:ce.groupType,notes:ce.notes||"Group session created by admin"})),le=await Ea(re,q,be,(n==null?void 0:n.id)||"");if(le.success){if(console.log(`[AdminPanel] Created ${le.createdCount} group sessions for user ${re}`),le.blockedSessions&&le.blockedSessions.length>0){const ce=le.blockedSessions.length,Ge=le.createdCount||0;h.error(`Δημιουργήθηκαν ${Ge} σεσίες, αλλά ${ce} σεσίες αποκλείστηκαν λόγω γεμάτου capacity. Λεπτομέρειες: ${le.blockedSessions.slice(0,2).join(", ")}${ce>2?"...":""}`)}}else console.error("[AdminPanel] Error creating group sessions:",le.error),(o=le.error)!=null&&o.includes("capacity")?h.error(`Δεν μπορούν να δημιουργηθούν σεσίες: ${le.error}`):h.error(`Σφάλμα δημιουργίας σεσίων: ${le.error}`)}}}h.success("Το ομαδικό πρόγραμμα και οι αναθέσεις δημιουργήθηκαν επιτυχώς!")}else(a==="group"||a==="combination")&&s.length>0&&h(`Το ${a==="combination"?"συνδυασμένο":"ομαδικό"} πρόγραμμα δημιουργήθηκε. ${a==="combination"?"Μπορείτε να κάνετε ομαδικές αναθέσεις αργότερα από το Group Programs Overview.":"Μπορείτε να κάνετε αναθέσεις αργότερα από το Group Programs Overview."}`,{icon:"ℹ️"});M(!1),Y({code:"",selectedUserId:""}),L("individual"),t("personal"),w([]),is({}),B(null),V(null),g(0),ds(""),He("dropdown"),pe([{id:"tmp-1",date:new Date().toISOString().split("T")[0],startTime:"18:00",endTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:""}]),lt()}catch(c){if(console.error("[ADMIN] Error creating personal training program:",c),c&&typeof c=="object"&&"code"in c){const f=c;f.code==="23505"?h.error("Το πρόγραμμα υπάρχει ήδη για αυτόν τον χρήστη."):f.code==="23503"?h.error("Πρόβλημα με τα δεδομένα χρήστη. Ελέγξτε ότι ο χρήστης υπάρχει."):f.code==="PGRST301"?h.error("Πρόβλημα αυθεντικοποίησης. Κάντε επανασύνδεση."):h.error(`Σφάλμα βάσης δεδομένων: ${f.message||"Άγνωστο σφάλμα"}`)}else h.error("Σφάλμα κατά τη δημιουργία του προγράμματος")}finally{S(!1)}};if(!n||n.role!=="admin")return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Δεν έχετε δικαίωμα πρόσβασης"}),e.jsx("p",{className:"text-gray-600",children:"Μόνο οι διαχειριστές μπορούν να έχουν πρόσβαση σε αυτή τη σελίδα."})]})});const _t=d.useCallback(async()=>{try{S(!0);const s=await Ka(),r=["Personal Training","Premium","Βασικό + προσωπική προπόνηση","VIP","Premium + όλα τα προνόμια","Όλα από το premium","Απεριόριστη προσωπική προπόνηση","Βασικό","Πρόσβαση σε όλες τις αίθουσες","Όλες οι ομαδικές τάξεις"],l=s.filter(c=>!r.includes(c.name)&&!r.some(f=>{var R;return(R=c.description)==null?void 0:R.includes(f)}));Lr(l),ee(c=>({...c,"membership-packages":!0}));const o=await Wa();vt(o)}catch(s){console.error("Error loading membership packages:",s),h.error("Σφάλμα κατά τη φόρτωση των πακέτων")}finally{S(!1)}},[]),Pt=async s=>{try{const r=await Ja(s);tt(r)}catch(r){console.error("Error loading package durations:",r),h.error("Σφάλμα κατά τη φόρτωση των επιλογών διάρκειας")}},Fs=async()=>{try{const s=await Dr();Or(s),ss(1)}catch(s){console.error("Error loading membership requests:",s),h.error("Σφάλμα κατά τη φόρτωση των αιτημάτων")}},vs=()=>at.filter(r=>{var c,f,R,de,re;const l=((c=r.package)==null?void 0:c.name)==="Free Gym"||((f=r.package)==null?void 0:f.name)==="Pilates"||((R=r.package)==null?void 0:R.name)==="Ultimate",o=ts===""||`${((de=r.user)==null?void 0:de.first_name)||""} ${((re=r.user)==null?void 0:re.last_name)||""}`.toLowerCase().includes(ts.toLowerCase());return l&&o}).sort((r,l)=>new Date(l.created_at).getTime()-new Date(r.created_at).getTime()),aa=()=>{const s=vs(),r=(Ae-1)*js,l=r+js;return s.slice(r,l)},Le=()=>{const s=vs();return Math.ceil(s.length/js)},la=()=>{ss(s=>Math.max(s-1,1))},na=()=>{ss(s=>Math.min(s+1,Le()))},oa=()=>{ss(1)},ia=()=>{ss(Le())},da=s=>{Fr(s.target.value),ss(1)},ca=s=>{Gr(s),s.name==="Pilates"?tt(Kr):Pt(s.id)},ma=s=>{Rs(s),ys(s.price.toString())},xa=async()=>{if(!ke||!rt)return;const s=parseFloat(rt);if(isNaN(s)||s<0){h.error("Παρακαλώ εισάγετε έγκυρη τιμή");return}try{S(!0),(ve==null?void 0:ve.name)==="Pilates"?await Ba(ke.duration_type,s)&&(tt(l=>l.map(o=>o.id===ke.id?{...o,price:s}:o)),vt(l=>l.map(o=>o.id===ke.id?{...o,price:s}:o)),Rs(null),ys(""),h.success("Η τιμή Pilates ενημερώθηκε επιτυχώς")):await Va(ke.id,s)&&(Rs(null),ys(""),Pt((ve==null?void 0:ve.id)||""))}catch(r){console.error("Error updating price:",r)}finally{S(!1)}},ga=async s=>{var r;try{S(!0);const l=at.find(c=>c.id===s);((r=l==null?void 0:l.package)==null?void 0:r.name)==="Ultimate"?await Ha(s)&&(h.success("Το Ultimate αίτημα εγκρίθηκε επιτυχώς! Δημιουργήθηκαν 2 συνδρομές: Pilates + Open Gym"),Fs()):await Ya(s)&&(h.success("Το αίτημα εγκρίθηκε επιτυχώς!"),Fs())}catch(l){console.error("Error approving request:",l),h.error("Σφάλμα κατά την έγκριση του αιτήματος")}finally{S(!1)}},ua=async s=>{const r=prompt("Παρακαλώ εισάγετε τον λόγο απόρριψης:");if(r)try{S(!0),await $r(s,r)&&(h.success("Το αίτημα απορρίφθηκε επιτυχώς!"),Fs())}catch(l){console.error("Error rejecting request:",l),h.error("Σφάλμα κατά την απόρριψη του αιτήματος")}finally{S(!1)}},ue=(s,r,l)=>{zr(o=>({...o,[s]:{...o[s],[r]:l}}))},zs=(s,r)=>{ft(l=>({...l,[s]:r}))},St=async s=>{const r=rs[s];if(r==="none"||!n){h.error("Παρακαλώ επιλέξτε μια κατάσταση έγκρισης");return}try{S(!0);const l=J[s];if(!l){h.error("Δεν υπάρχουν επιλογές για αυτό το αίτημα");return}const o=at.find(f=>f.id===s);if(!o){h.error("Αίτημα δεν βρέθηκε");return}if(await Tr(o.user_id,r,{oldMembersUsed:l.oldMembers||!1,kettlebellPoints:l.kettlebellPoints?parseInt(l.kettlebellPoints):0,cashAmount:l.cashAmount||0,posAmount:l.posAmount||0,createdBy:n.id,notes:`Program options saved for membership request ${s} with ${r} status`})){if(console.log(`Program approval state saved for membership request: ${s}`),r==="pending"){const R=new Set(Gs),de={...Os};R.add(s),de[s]=l,yt(R),jt(de),h("Program Options τοποθετήθηκαν στην αναμονή - οι επιλογές παγώθηκαν",{icon:"⏳"})}else if(r==="approved"&&await ha(s,o.user_id,l),b(s)){const R=new Set(Gs),de={...Os};R.delete(s),delete de[s],yt(R),jt(de)}ft(R=>({...R,[s]:"none"}));const f={approved:"εγκρίθηκε και εκτελέστηκαν οι ενέργειες",rejected:"απορρίφθηκε",pending:"τοποθετήθηκε στην αναμονή"};h.success(`Program Options ${f[r]} επιτυχώς!`)}else h.error("Σφάλμα κατά την αποθήκευση των Program Options")}catch(l){console.error("Error saving request program options:",l),h.error("Σφάλμα κατά την αποθήκευση των Program Options")}finally{S(!1)}},ha=async(s,r,l)=>{console.log("Executing approved program actions for membership request:",s);try{l.oldMembers&&(await ct(r,(n==null?void 0:n.id)||"")?console.log(`[APPROVED] Old Members marked as used for membership request: ${s}`):console.warn(`[APPROVED] Failed to mark Old Members as used for membership request: ${s}`)),l.kettlebellPoints&&parseInt(l.kettlebellPoints)>0&&(await mt(r,parseInt(l.kettlebellPoints),void 0,(n==null?void 0:n.id)||"")?console.log(`[APPROVED] Kettlebell Points saved for membership request: ${s}, Points: ${l.kettlebellPoints}`):console.warn(`[APPROVED] Failed to save Kettlebell Points for membership request: ${s}`)),l.cashAmount&&l.cashAmount>0&&(await Vs(r,l.cashAmount,"cash",void 0,(n==null?void 0:n.id)||"","Cash transaction from approved membership request")?console.log(`[APPROVED] Cash transaction saved for membership request: ${s}, Amount: €${l.cashAmount}`):console.warn(`[APPROVED] Failed to save Cash transaction for membership request: ${s}`)),l.posAmount&&l.posAmount>0&&(await Vs(r,l.posAmount,"pos",void 0,(n==null?void 0:n.id)||"","POS transaction from approved membership request")?console.log(`[APPROVED] POS transaction saved for membership request: ${s}, Amount: €${l.posAmount}`):console.warn(`[APPROVED] Failed to save POS transaction for membership request: ${s}`)),h.success("Έγιναν όλες οι απαραίτητες ενέργειες για το εγκεκριμένο αίτημα!")}catch(o){console.error("Error executing approved program actions for membership request:",o),h.error("Σφάλμα κατά την εκτέλεση των ενεργειών")}},nt=d.useCallback(async()=>{try{S(!0);const[s,r]=await Promise.all([nl(),ol()]);Ms(s),Ts(r),ee(l=>({...l,"kettlebell-points":!0}))}catch(s){console.error("Error loading kettlebell points data:",s),h.error("Σφάλμα κατά τη φόρτωση των Kettlebell Points")}finally{S(!1)}},[]),ba=async s=>{try{const l=(await il(s)).reduce((o,c)=>o+c.points,0);Me(l.toString())}catch(r){console.error("Error loading user kettlebell points:",r),Me("")}},pa=s=>{if(!s.trim()){hs([]);return}const r=Ne.filter(l=>l.user_name.toLowerCase().includes(s.toLowerCase())||l.user_email.toLowerCase().includes(s.toLowerCase()));hs(r)},kt=s=>{Es(s),pa(s)};d.useEffect(()=>{u==="membership-packages"&&(_t(),Fs())},[u]),d.useEffect(()=>{u==="kettlebell-points"&&nt()},[u]),d.useEffect(()=>{(async()=>{if(n)try{const{data:r,error:l}=await O.from("user_old_members_usage").select("user_id");if(l){console.error("Error loading old members usage:",l);return}const o=new Set((r==null?void 0:r.map(c=>c.user_id))||[]);xs(o)}catch(r){console.error("Exception loading old members usage:",r)}})()},[n]);const Re=async()=>{try{fs(!0);const r=(await Ns(()=>Dr(),"φόρτωση Ultimate αιτημάτων")).filter(l=>{var o;return((o=l.package)==null?void 0:o.name)==="Ultimate"});r.length>dl&&(console.log(`[AdminPanel] Large Ultimate dataset detected: ${r.length} items`),h(`Φορτώθηκαν ${r.length} Ultimate αιτήματα. Χρησιμοποιείται σελιδοποίηση.`,{icon:"👑"})),Qs(r),ee(l=>({...l,"ultimate-subscriptions":!0}))}catch(s){ws(s,"φόρτωση Ultimate αιτημάτων")}finally{fs(!1)}},fa=async s=>{try{await Ns(async()=>{const{error:r}=await O.from("membership_requests").delete().eq("id",s);if(r)throw r;return!0},"διαγραφή Ultimate αιτήματος"),h.success("Το Ultimate αίτημα διαγράφηκε επιτυχώς"),await Re()}catch(r){ws(r,"διαγραφή Ultimate αιτήματος")}},ya=async s=>{var r;try{S(!0);const l=Ze.find(c=>c.id===s);((r=l==null?void 0:l.package)==null?void 0:r.name)==="Ultimate"&&(await Ns(async()=>{const{approveUltimateMembershipRequest:c}=await ka(async()=>{const{approveUltimateMembershipRequest:R}=await import("./membershipApi-CeeYu9fp.js");return{approveUltimateMembershipRequest:R}},__vite__mapDeps([0,1,2])),f=await c(s);if(!f)throw new Error("Approval failed");return f},"έγκριση Ultimate αιτήματος"),h.success("Το Ultimate αίτημα εγκρίθηκε επιτυχώς! Δημιουργήθηκαν 2 συνδρομές: Pilates + Open Gym"),Re())}catch(l){ws(l,"έγκριση Ultimate αιτήματος")}finally{S(!1)}},ja=async s=>{const r=prompt("Παρακαλώ εισάγετε τον λόγο απόρριψης:");if(r)try{S(!0),await Ns(async()=>{const l=await $r(s,r);if(!l)throw new Error("Rejection failed");return l},"απόρριψη Ultimate αιτήματος"),h.success("Το Ultimate αίτημα απορρίφθηκε επιτυχώς!"),Re()}catch(l){ws(l,"απόρριψη Ultimate αιτήματος")}finally{S(!1)}},va=async(s,r,l,o,c,f,R,de,re,I)=>{try{const j={installment_1_amount:r,installment_2_amount:l,installment_3_amount:o,installment_1_payment_method:c,installment_2_payment_method:f,installment_3_payment_method:R};de&&(j.installment_1_due_date=de),re&&(j.installment_2_due_date=re),I&&(j.installment_3_due_date=I),await Ns(async()=>{const{error:q}=await O.from("membership_requests").update(j).eq("id",s);if(q)throw q;return!0},"ενημέρωση δόσεων"),h.success("Οι δόσεις και ημερομηνίες ενημερώθηκαν επιτυχώς"),await Re()}catch(j){ws(j,"ενημέρωση δόσεων")}};d.useEffect(()=>{u==="ultimate-subscriptions"&&!F["ultimate-subscriptions"]&&(console.log("[AdminPanel] Loading Ultimate Subscriptions data..."),Re())},[u]),d.useEffect(()=>{u==="ultimate-subscriptions"&&Ze.length===0&&!qe&&(console.log("[AdminPanel] Ultimate Subscriptions tab active but no data, reloading..."),Re())},[u,Ze.length,qe]);const Ns=async(s,r="operation",l=3)=>{for(let o=1;o<=l;o++)try{return await s()}catch(c){if(console.error(`[AdminPanel] Database ${r} failed (attempt ${o}/${l}):`,c),o===l){const R=`Σφάλμα σύνδεσης με τη βάση δεδομένων κατά ${r}. Παρακαλώ ελέγξτε τη σύνδεσή σας και δοκιμάστε ξανά.`;throw h.error(R),c}const f=1e3*o;console.log(`[AdminPanel] Retrying ${r} in ${f}ms...`),await new Promise(R=>setTimeout(R,f))}throw new Error(`Failed to complete ${r} after ${l} attempts`)},ws=(s,r)=>{var l,o,c;console.error(`[AdminPanel] Database error in ${r}:`,s),(l=s.message)!=null&&l.includes("network")||(o=s.message)!=null&&o.includes("connection")?h.error("Πρόβλημα σύνδεσης δικτύου. Παρακαλώ ελέγξτε τη σύνδεσή σας."):(c=s.message)!=null&&c.includes("timeout")?h.error("Η λειτουργία διήρκησε πολύ. Παρακαλώ δοκιμάστε ξανά."):h.error(`Παρουσιάστηκε σφάλμα κατά ${r}. Παρακαλώ δοκιμάστε ξανά.`)};return d.useEffect(()=>{x.selectedUserId&&ba(x.selectedUserId)},[x.selectedUserId]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-xl shadow-xl p-4 sm:p-8 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-3xl font-bold mb-2",children:"🏋️‍♂️ Διαχείριση Γυμναστηρίου"}),e.jsxs("p",{className:"text-blue-100 text-sm sm:text-lg",children:["Καλώς ήρθες, ",e.jsx("span",{className:"font-semibold",children:n.firstName}),"!"]})]}),e.jsx("div",{className:"bg-white/20 rounded-xl p-3 sm:p-4 backdrop-blur-sm self-start sm:self-auto",children:e.jsx(Ds,{className:"h-8 w-8 sm:h-12 sm:w-12"})})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex overflow-x-auto space-x-2 sm:space-x-8 px-3 sm:px-6",children:Wr.map(s=>{const r=s.icon;return e.jsxs("button",{onClick:()=>v(s.id),className:`py-3 sm:py-4 px-2 sm:px-1 border-b-3 font-semibold text-xs sm:text-sm flex items-center space-x-2 sm:space-x-3 transition-all duration-200 whitespace-nowrap ${u===s.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(r,{className:`h-4 w-4 sm:h-5 sm:w-5 ${u===s.id?"text-blue-500":"text-gray-400"}`}),e.jsx("span",{className:"hidden sm:inline",children:s.name}),e.jsx("span",{className:"sm:hidden",children:s.name.split(" ")[0]})]},s.id)})})}),e.jsxs("div",{className:"p-3 sm:p-6",children:[p&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Φόρτωση δεδομένων χρήστη… Αυτό μπορεί να διαρκέσει λίγα δευτερόλεπτα."})]}),u==="personal-training"&&!p&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"💪 Personal Training Πρόγραμμα"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Διαχείριση προγραμμάτων προπόνησης"})]}),e.jsxs("button",{onClick:()=>M(!0),className:"flex items-center space-x-2 sm:space-x-3 px-4 sm:px-6 py-2 sm:py-3 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm sm:text-base",children:[e.jsx(Se,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{children:"🏋️‍♂️ Δημιουργία Προγράμματος"})]})]})}),W&&_&&!Vr({email:W.email,personalTrainingCode:W.personalTrainingCode})&&e.jsxs("div",{className:"bg-gradient-to-br from-white to-blue-50 border-2 border-blue-200 rounded-xl shadow-xl p-4 sm:p-8",id:"schedule-editor",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 sm:p-6 rounded-xl shadow-lg flex-1 sm:flex-none",children:[e.jsxs("h3",{className:"text-lg sm:text-2xl font-bold mb-1 sm:mb-2",children:["🏋️‍♂️ Πρόγραμμα για ",W.firstName," ",W.lastName]}),e.jsxs("p",{className:"text-blue-100 text-sm sm:text-lg",children:["📅 ",Br[_.month-1]," ",_.year]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 sm:space-x-2 sm:gap-0",children:T?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Zr,className:"flex items-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors text-sm",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Προσθήκη Σεσίας"}),e.jsx("span",{className:"sm:hidden",children:"Προσθήκη"})]}),e.jsxs("button",{onClick:ea,className:"flex items-center space-x-1 px-3 py-2 bg-primary-100 text-primary-700 rounded-md hover:bg-primary-200 transition-colors text-sm",children:[e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{children:"Αποθήκευση"})]}),e.jsx("button",{onClick:()=>E(!1),className:"flex items-center space-x-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-sm",children:e.jsx("span",{children:"Ακύρωση"})})]}):e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(Sr,{className:"h-4 w-4"}),e.jsx("span",{children:"Επεξεργασία"})]})})]}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:_.scheduleData.sessions.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"sm:col-span-2 lg:col-span-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Ημέρα"}),T?e.jsx("input",{type:"date",value:s.date,onChange:r=>ls(s.id,"date",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm"}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:new Date(s.date).toLocaleDateString("el-GR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Ώρα Έναρξης"}),T?e.jsx("select",{value:s.startTime,onChange:r=>ls(s.id,"startTime",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:wt.map(r=>e.jsx("option",{value:r,children:r},r))}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Ώρα Λήξης"}),T?e.jsx("select",{value:s.endTime,onChange:r=>ls(s.id,"endTime",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:wt.map(r=>e.jsx("option",{value:r,children:r},r))}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.endTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Τύπος"}),T?e.jsxs("select",{value:s.type,onChange:r=>ls(s.id,"type",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:[e.jsx("option",{value:"personal",children:"Personal Training"}),e.jsx("option",{value:"kickboxing",children:"Kick Boxing"}),e.jsx("option",{value:"combo",children:"Combo"})]}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900 capitalize",children:s.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Προπονητής"}),T?e.jsx("select",{value:s.trainer,onChange:r=>ls(s.id,"trainer",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:Ur.map(r=>e.jsx("option",{value:r,children:r},r))}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.trainer})]}),e.jsx("div",{className:"flex items-end sm:col-span-2 lg:col-span-1",children:T&&e.jsxs("button",{onClick:()=>qr(s.id),className:"flex items-center space-x-1 px-3 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors text-sm w-full sm:w-auto",children:[e.jsx(Cs,{className:"h-4 w-4"}),e.jsx("span",{children:"Διαγραφή"})]})})]}),s.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Σημειώσεις"}),T?e.jsx("input",{type:"text",value:s.notes,onChange:r=>ls(s.id,"notes",r.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",placeholder:"Σημειώσεις για τη σέσια"}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.notes})]})]},s.id))}),e.jsxs("div",{className:"mt-4 sm:mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Γενικές Σημειώσεις"}),T?e.jsx("textarea",{value:_.scheduleData.notes||"",onChange:s=>{const r={..._,scheduleData:{..._.scheduleData,notes:s.target.value}};Q(r)},className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",rows:3,placeholder:"Γενικές σημειώσεις για το πρόγραμμα..."}):e.jsx("p",{className:"text-sm text-gray-900",children:_.scheduleData.notes||"Δεν υπάρχουν σημειώσεις"})]})]}),cs&&e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl shadow-lg border-2 border-green-200",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(rl,{featureEnabled:cs})})})]}),u==="membership-packages"&&!p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Διαχείριση Πακέτων Συνδρομών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Ενημερώστε τις τιμές για κάθε πακέτο και διάρκεια"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Ir.map(s=>e.jsxs("div",{className:`border-2 rounded-xl p-6 cursor-pointer transition-all duration-200 ${(ve==null?void 0:ve.id)===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>ca(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s.name==="Pilates"?e.jsx("span",{className:"text-2xl",children:"🧘"}):e.jsx(Bs,{className:"h-6 w-6 text-blue-500"}),e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s.name})]}),e.jsx(it,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:s.description}),s.features&&e.jsx("ul",{className:"space-y-1",children:s.features.slice(0,3).map((r,l)=>e.jsxs("li",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mr-2"}),r]},l))})]},s.id))})})]}),ve&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Τιμές για ",ve.name]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Ενημερώστε τις τιμές για κάθε διάρκεια"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Rr.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Hs,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:xt(s.duration_type)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.duration_days," ημέρες"]})]})]}),e.jsx("button",{onClick:()=>ma(s),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(Sr,{className:"h-4 w-4"})})]}),(ke==null?void 0:ke.id)===s.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",value:rt,onChange:r=>ys(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Νέα τιμή",step:"0.01",min:"0"})}),e.jsx("button",{onClick:xa,disabled:p,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm disabled:opacity-50",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{Rs(null),ys("")},className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:e.jsx(Fe,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ze(s.price)}),e.jsx("div",{className:"text-sm text-gray-600",children:"EUR"})]})]},s.id))})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/10 rounded-xl backdrop-blur-sm",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Αιτήματα Συνδρομών"}),e.jsx("p",{className:"text-slate-200 mt-1",children:"Διαχειριστείτε τα αιτήματα συνδρομών από χρήστες"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση με όνομα χρήστη...",value:ts,onChange:da,className:"pl-12 pr-6 py-3 bg-white/10 border border-white/20 rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 w-full lg:w-80 text-white placeholder-slate-300 backdrop-blur-sm"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 border border-slate-200 rounded-xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"h-6 w-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Οδηγίες Διαχείρισης Αιτημάτων"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(De,{className:"h-3 w-3 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800 mb-1",children:"Αναζήτηση & Πλοήγηση"}),e.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed",children:["Χρησιμοποιήστε το πεδίο αναζήτησης για να βρείτε γρήγορα αιτήματα με όνομα χρήστη. Η λίστα εμφανίζεται σε ",e.jsx("span",{className:"font-semibold text-blue-700",children:"6άδες"})," - ελέγξτε την επόμενη σελίδα αν δεν βρείτε το επιθυμητό αίτημα."]})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg p-4 border border-amber-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(gt,{className:"h-3 w-3 text-amber-600"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-amber-800 mb-1 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full mr-2"}),"Σημαντική Προσοχή - Διαδικασία Πληρωμής"]}),e.jsxs("p",{className:"text-sm text-amber-700 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"ΠΡΩΤΑ"})," αποθηκεύουμε τα χρήματα στο σύστημα (Cash Register) και",e.jsx("span",{className:"font-semibold",children:" ΕΠΕΙΤΑ"})," επιλέγουμε για το αίτημα του χρήστη εάν εγκρίνεται ή απορρίπτεται."]})]})]})})]})]})]})}),e.jsx("div",{className:"p-8",children:vs().length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:ts?"Δεν βρέθηκαν αποτελέσματα":"Δεν υπάρχουν αιτήματα"}),e.jsx("p",{className:"text-gray-500",children:ts?`Για την αναζήτηση "${ts}"`:"Δεν έχουν υποβληθεί αιτήματα συνδρομών ακόμα"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-slate-50 rounded-xl p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Se,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-700",children:["Εμφάνιση ",(Ae-1)*js+1,"-",Math.min(Ae*js,vs().length)," από ",vs().length," αιτήματα"]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Οργανωμένα σε 6άδες για εύκολη πλοήγηση"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Le()>3&&e.jsx("button",{onClick:oa,disabled:Ae===1,className:"px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-200",title:"Πρώτη σελίδα",children:"««"}),e.jsxs("button",{onClick:la,disabled:Ae===1,className:"px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed flex items-center space-x-2 transition-all duration-200",children:[e.jsx("span",{children:"←"}),e.jsx("span",{children:"Προηγούμενο"})]}),e.jsxs("div",{className:"px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-lg min-w-[120px] text-center",children:[Ae," / ",Le()]}),e.jsxs("button",{onClick:na,disabled:Ae>=Le(),className:"px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed flex items-center space-x-2 transition-all duration-200",children:[e.jsx("span",{children:"Επόμενο"}),e.jsx("span",{children:"→"})]}),Le()>3&&e.jsx("button",{onClick:ia,disabled:Ae>=Le(),className:"px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-200",title:"Τελευταία σελίδα",children:"»»"})]})]})}),e.jsx("div",{className:"space-y-6",children:aa().map(s=>{var r,l,o,c,f,R,de,re,I,j,q,be,le,ce,Ge,_s,Ks,Ps,K,H,ne,me,Ss,Wt,Bt,Vt,Ht,Yt,Jt,Qt,Xt,Zt,qt,er,sr,tr,rr,ar,lr,nr,or,ir,dr,cr,mr,xr,gr,ur,hr,br,pr,fr,yr,jr,vr,Nr;return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[(r=s.user)!=null&&r.profile_photo?e.jsxs("div",{className:"w-12 h-12 rounded-xl overflow-hidden shadow-lg border-2 border-white",children:[e.jsx("img",{src:s.user.profile_photo,alt:`${(l=s.user)==null?void 0:l.first_name} ${(o=s.user)==null?void 0:o.last_name}`,className:"w-full h-full object-cover",onError:z=>{z.currentTarget.style.display="none";const wr=z.currentTarget.nextElementSibling;wr&&(wr.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center hidden",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})})]}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),s.status==="pending"&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h4",{className:"text-lg font-bold text-slate-900 mb-1",children:[(c=s.user)==null?void 0:c.first_name," ",(f=s.user)==null?void 0:f.last_name]}),e.jsxs("p",{className:"text-sm text-slate-600 mb-2 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-slate-300 rounded-full mr-2"}),(R=s.user)==null?void 0:R.email]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:(de=s.package)==null?void 0:de.name}),e.jsx("span",{className:"text-sm text-slate-500",children:"•"}),e.jsx("span",{className:"text-sm text-slate-600",children:xt(s.duration_type)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:ze(s.requested_price)}),e.jsxs("div",{className:"text-sm text-slate-500 flex items-center",children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),new Date(s.created_at).toLocaleDateString("el-GR")]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3",children:[s.status==="pending"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>ga(s.id),disabled:p,className:"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"Εγκρίνω"})]}),e.jsxs("button",{onClick:()=>ua(s.id),disabled:p,className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{children:"Απορρίπτω"})]})]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:"Εγκεκριμένο"})]}),s.status==="rejected"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-semibold",children:"Απορριφθέν"})]})]})]})]})}),(s.status==="pending"||s.status==="approved"&&b(s.id)||s.status==="rejected"&&b(s.id))&&e.jsx("div",{className:`border-t border-slate-200 ${b(s.id)?"bg-gradient-to-r from-yellow-50 to-amber-50":"bg-slate-50"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${b(s.id)?"bg-yellow-100":"bg-slate-100"}`,children:e.jsx(it,{className:`h-5 w-5 ${b(s.id)?"text-yellow-600":"text-slate-600"}`})}),e.jsxs("h5",{className:`text-lg font-semibold ${b(s.id)?"text-yellow-800":"text-slate-700"} flex items-center`,children:["Program Options",b(s.id)&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-yellow-200 text-yellow-800 rounded-full text-xs font-medium",children:"Κλειδωμένο"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[((re=s.package)==null?void 0:re.name)!=="Pilates"&&e.jsx("div",{className:`p-3 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:e.jsx("button",{onClick:()=>{var z;if(b(s.id)){h("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}ue(s.id,"oldMembers",!((z=J[s.id])!=null&&z.oldMembers))},className:`w-full p-3 rounded-lg text-left transition-colors ${(I=J[s.id])!=null&&I.oldMembers||(j=te(s.id))!=null&&j.oldMembers?"bg-green-100 text-green-800 border-2 border-green-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":"bg-gray-100 text-gray-700 border-2 border-gray-300 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ","👴 Παλαιά μέλη"]}),(((q=J[s.id])==null?void 0:q.oldMembers)||((be=te(s.id))==null?void 0:be.oldMembers))&&e.jsx("span",{className:"text-green-600",children:"✓"})]})})}),((le=s.package)==null?void 0:le.name)!=="Pilates"&&e.jsxs("div",{className:`p-3 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[b(s.id)&&"🔒 ","🏋️ Kettlebell Points"]}),e.jsx("input",{type:"number",value:b(s.id)?((ce=te(s.id))==null?void 0:ce.kettlebellPoints)||"":((Ge=J[s.id])==null?void 0:Ge.kettlebellPoints)||"",onChange:z=>{b(s.id)||ue(s.id,"kettlebellPoints",z.target.value)},placeholder:"Εισάγετε πόντους",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,disabled:b(s.id)})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-4 border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("span",{className:"text-2xl",children:"💳"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[b(s.id)&&"🔒 ","SECTION ΠΛΗΡΩΜΩΝ"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-3 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsx("button",{onClick:()=>{var z;if(b(s.id)){h("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}ue(s.id,"cash",!((z=J[s.id])!=null&&z.cash))},className:`w-full p-3 rounded-lg text-left transition-colors ${(_s=J[s.id])!=null&&_s.cash||(Ks=te(s.id))!=null&&Ks.cash?"bg-green-100 text-green-800 border-2 border-green-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":"bg-gray-100 text-gray-700 border-2 border-gray-300 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ","💰 Μετρητά"]}),(((Ps=J[s.id])==null?void 0:Ps.cash)||((K=te(s.id))==null?void 0:K.cash))&&e.jsx("span",{className:"text-green-600",children:"✓"})]})}),(((H=J[s.id])==null?void 0:H.cash)||((ne=te(s.id))==null?void 0:ne.cash))&&e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((me=te(s.id))==null?void 0:me.cashAmount)||"":((Ss=J[s.id])==null?void 0:Ss.cashAmount)||"",onChange:z=>{b(s.id)||ue(s.id,"cashAmount",parseFloat(z.target.value)||0)},placeholder:"Ποσό σε €",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-green-500 focus:border-green-500"}`,disabled:b(s.id)}),e.jsx("button",{onClick:()=>{b(s.id)},className:`mt-2 w-full px-3 py-1 text-sm rounded-lg ${b(s.id)?"bg-yellow-200 text-yellow-700 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,disabled:b(s.id),children:"✓ Επιλογή"})]})]}),e.jsxs("div",{className:`p-3 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsx("button",{onClick:()=>{var z;if(b(s.id)){h("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}ue(s.id,"pos",!((z=J[s.id])!=null&&z.pos))},className:`w-full p-3 rounded-lg text-left transition-colors ${(Wt=J[s.id])!=null&&Wt.pos||(Bt=te(s.id))!=null&&Bt.pos?"bg-blue-100 text-blue-800 border-2 border-blue-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":"bg-gray-100 text-gray-700 border-2 border-gray-300 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ","💳 POS"]}),(((Vt=J[s.id])==null?void 0:Vt.pos)||((Ht=te(s.id))==null?void 0:Ht.pos))&&e.jsx("span",{className:"text-blue-600",children:"✓"})]})}),(((Yt=J[s.id])==null?void 0:Yt.pos)||((Jt=te(s.id))==null?void 0:Jt.pos))&&e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((Qt=te(s.id))==null?void 0:Qt.posAmount)||"":((Xt=J[s.id])==null?void 0:Xt.posAmount)||"",onChange:z=>{b(s.id)||ue(s.id,"posAmount",parseFloat(z.target.value)||0)},placeholder:"Ποσό σε €",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,disabled:b(s.id)}),e.jsx("button",{onClick:()=>{b(s.id)},className:`mt-2 w-full px-3 py-1 text-sm rounded-lg ${b(s.id)?"bg-yellow-200 text-yellow-700 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,disabled:b(s.id),children:"✓ Επιλογή"})]})]})]})]}),((Zt=s.package)==null?void 0:Zt.name)==="Ultimate"&&s.has_installments&&e.jsxs("div",{className:`col-span-2 p-4 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-orange-50 border-orange-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("span",{className:"text-2xl",children:"💳"}),e.jsxs("h4",{className:"text-lg font-semibold text-orange-800",children:[b(s.id)&&"🔒 ","Διαχείριση Δόσεων Ultimate"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"1η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((qt=te(s.id))==null?void 0:qt.installment1Amount)||"":((er=J[s.id])==null?void 0:er.installment1Amount)||"",onChange:z=>{b(s.id)||ue(s.id,"installment1Amount",z.target.value)},placeholder:"Ποσό",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)}),e.jsxs("select",{value:b(s.id)?((sr=te(s.id))==null?void 0:sr.installment1PaymentMethod)||"cash":((tr=J[s.id])==null?void 0:tr.installment1PaymentMethod)||"cash",onChange:z=>{b(s.id)||ue(s.id,"installment1PaymentMethod",z.target.value)},className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id),children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((rr=te(s.id))==null?void 0:rr.installment1DueDate)||"":((ar=J[s.id])==null?void 0:ar.installment1DueDate)||"",onChange:z=>{b(s.id)||ue(s.id,"installment1DueDate",z.target.value)},className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"2η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((lr=te(s.id))==null?void 0:lr.installment2Amount)||"":((nr=J[s.id])==null?void 0:nr.installment2Amount)||"",onChange:z=>{b(s.id)||ue(s.id,"installment2Amount",z.target.value)},placeholder:"Ποσό",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)}),e.jsxs("select",{value:b(s.id)?((or=te(s.id))==null?void 0:or.installment2PaymentMethod)||"cash":((ir=J[s.id])==null?void 0:ir.installment2PaymentMethod)||"cash",onChange:z=>{b(s.id)||ue(s.id,"installment2PaymentMethod",z.target.value)},className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id),children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((dr=te(s.id))==null?void 0:dr.installment2DueDate)||"":((cr=J[s.id])==null?void 0:cr.installment2DueDate)||"",onChange:z=>{b(s.id)||ue(s.id,"installment2DueDate",z.target.value)},className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"3η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((mr=te(s.id))==null?void 0:mr.installment3Amount)||"":((xr=J[s.id])==null?void 0:xr.installment3Amount)||"",onChange:z=>{b(s.id)||ue(s.id,"installment3Amount",z.target.value)},placeholder:"Ποσό",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)}),e.jsxs("select",{value:b(s.id)?((gr=te(s.id))==null?void 0:gr.installment3PaymentMethod)||"cash":((ur=J[s.id])==null?void 0:ur.installment3PaymentMethod)||"cash",onChange:z=>{b(s.id)||ue(s.id,"installment3PaymentMethod",z.target.value)},className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id),children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((hr=te(s.id))==null?void 0:hr.installment3DueDate)||"":((br=J[s.id])==null?void 0:br.installment3DueDate)||"",onChange:z=>{b(s.id)||ue(s.id,"installment3DueDate",z.target.value)},className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,disabled:b(s.id)})]})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-orange-100 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-orange-800",children:"Σύνολο Δόσεων:"}),e.jsx("span",{className:"text-lg font-bold text-orange-900",children:ze((Number(((pr=J[s.id])==null?void 0:pr.installment1Amount)||0)||Number(((fr=te(s.id))==null?void 0:fr.installment1Amount)||0))+(Number(((yr=J[s.id])==null?void 0:yr.installment2Amount)||0)||Number(((jr=te(s.id))==null?void 0:jr.installment2Amount)||0))+(Number(((vr=J[s.id])==null?void 0:vr.installment3Amount)||0)||Number(((Nr=te(s.id))==null?void 0:Nr.installment3Amount)||0)))})]}),e.jsxs("div",{className:"text-sm text-orange-700 mt-1",children:["Από ",ze(s.requested_price)," (Πακέτο Ultimate)"]})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>zs(s.id,"approved"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${rs[s.id]==="approved"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:"✅ Έγκριση"}),e.jsx("button",{onClick:()=>zs(s.id,"rejected"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${rs[s.id]==="rejected"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:"❌ Απόρριψη"}),e.jsx("button",{onClick:()=>zs(s.id,"pending"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${rs[s.id]==="pending"?"bg-yellow-600 text-white":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"}`,children:"⏳ Αναμονή"}),e.jsxs("button",{onClick:()=>St(s.id),disabled:p||rs[s.id]==="none",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[p?e.jsx(As,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Αποθήκευση Program Options"]})]})]})})]},s.id)})})]})})]})]}),u==="pilates-schedule"&&!p&&e.jsx(Xa,{}),u==="cash-register"&&!p&&e.jsx(el,{}),u==="kettlebell-points"&&!p&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"🏋️‍♂️ Kettlebell Points Ranking"}),e.jsx("p",{className:"text-orange-100 text-sm sm:text-base",children:"Συνολικοί βαθμοί και κατάταξη χρηστών"})]}),e.jsxs("button",{onClick:nt,className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm",children:[e.jsx(Bs,{className:"h-4 w-4"}),e.jsx("span",{children:"🔄 Ανανέωση"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"📊 Συνολικοί Βαθμοί"}),e.jsx("p",{className:"text-blue-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-blue-900",children:Us}),e.jsx("div",{className:"text-sm text-blue-600",children:"βαθμοί"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"🏆 Κατάταξη Χρηστών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Βαθμοί Kettlebell ανά χρήστη"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση χρήστη...",value:we,onChange:s=>kt(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),we&&e.jsx("button",{onClick:()=>kt(""),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"p-6",children:Ne.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Bs,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν υπάρχουν βαθμοί Kettlebell ακόμα"}),e.jsx("p",{className:"text-sm mt-2",children:"Οι βαθμοί θα εμφανιστούν εδώ όταν δημιουργηθούν προγράμματα με Kettlebell Points"})]}):e.jsxs("div",{className:"space-y-4",children:[(we?us:Ne.slice(0,10)).map((s,r)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ${r===0?"bg-yellow-500":r===1?"bg-gray-400":r===2?"bg-orange-500":"bg-blue-500"}`,children:we?Ne.findIndex(l=>l.user_id===s.user_id)+1:r+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.user_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.user_email}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.points_count," ",s.points_count===1?"πρόγραμμα":"προγράμματα"," • Τελευταία ενημέρωση: ",new Date(s.last_updated).toLocaleDateString("el-GR")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.total_points}),e.jsx("div",{className:"text-sm text-gray-600",children:"βαθμοί"})]})]})},s.user_id)),we&&us.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(De,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν βρέθηκαν χρήστες με αυτό το όνομα"}),e.jsx("p",{className:"text-sm mt-2",children:"Δοκιμάστε ένα διαφορετικό όρο αναζήτησης"})]}),!we&&Ne.length>10&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Εμφανίζονται οι πρώτοι 10 από ",Ne.length," χρήστες"]})})]})})]})]}),u!=="personal-training"&&u!=="membership-packages"&&u!=="ultimate-subscriptions"&&u!=="pilates-schedule"&&u!=="kettlebell-points"&&u!=="cash-register"&&!p&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Αυτή η κατηγορία θα υλοποιηθεί σύντομα."})})]})]}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-t-xl sm:rounded-t-2xl p-4 sm:p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-2xl font-bold mb-1 sm:mb-2",children:"🏋️‍♂️ Δημιουργία Προγράμματος"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Δημιουργήστε νέο πρόγραμμα Personal Training"})]}),e.jsx("button",{onClick:()=>M(!1),className:"text-white/80 hover:text-white hover:bg-white/20 rounded-full p-2 transition-all duration-200 flex-shrink-0 ml-2",children:e.jsx(Fe,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})}),e.jsxs("div",{className:"p-4 sm:p-8",children:[e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 sm:p-6 border border-indigo-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-indigo-800 mb-3 sm:mb-4 flex items-center",children:"🏋️‍♂️ Τύπος Προπόνησης"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>L("individual"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${a==="individual"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"👤 Ατομικό"}),e.jsx("button",{type:"button",onClick:()=>L("group"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${a==="group"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"👥 Group"}),e.jsx("button",{type:"button",onClick:()=>L("combination"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${a==="combination"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"🔀 Συνδυασμός"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-4 sm:p-6 border border-blue-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-blue-800 mb-3 sm:mb-4 flex items-center",children:"👥 Τύπος Χρήστη"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>t("personal"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${N==="personal"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🏋️‍♂️ Personal User"}),a!=="combination"&&e.jsx("button",{type:"button",onClick:()=>t("paspartu"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${N==="paspartu"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🎯 Paspartu User"})]}),e.jsx("div",{className:"mt-3 text-sm text-blue-700",children:a==="combination"?e.jsx("span",{children:"📋 Combination Training: Μόνο Personal Users - κλειδωμένο πρόγραμμα με συγκεκριμένες ώρες"}):N==="personal"?e.jsx("span",{children:"📋 Personal Users: Παίρνουν κλειδωμένο πρόγραμμα με συγκεκριμένες ώρες"}):e.jsx("span",{children:"💳 Paspartu Users: Παίρνουν 5 μαθήματα και επιλέγουν ελεύθερα τις ώρες"})})]}),a==="combination"&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 sm:p-6 border border-purple-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-purple-800 mb-3 sm:mb-4 flex items-center",children:"🔀 Διαμόρφωση Συνδυασμού"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[e.jsx("label",{className:"block text-sm font-bold text-purple-700 mb-2",children:"👤 Ατομικές Σεσίες"}),e.jsx("select",{value:P,onChange:s=>oe(parseInt(s.target.value)),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs("option",{value:s,children:[s," σεσίες"]},s))})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[e.jsx("label",{className:"block text-sm font-bold text-purple-700 mb-2",children:"👥 Ομαδικές Σεσίες"}),e.jsx("select",{value:ie,onChange:s=>he(parseInt(s.target.value)),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[1,2,3,4,5].map(s=>e.jsxs("option",{value:s,children:[s," ",s===1?"φορά":"φορές","/εβδομάδα"]},s))})]})]}),e.jsxs("div",{className:"mt-3 text-sm text-purple-700 bg-purple-100 p-3 rounded-lg",children:[e.jsx("strong",{children:"📊 Σύνολο:"})," ",P," ατομικές σεσίες + ",ie," ",ie===1?"φορά":"φορές","/εβδομάδα ομαδικές"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("label",{className:"block text-lg font-bold text-blue-800 mb-4 flex items-center",children:["👤 ",a==="individual"?"Επιλογή Χρήστη":a==="combination"?"Επιλογή Χρήστη (Συνδυασμός)":"Επιλογή Χρηστών (Group)",(a==="individual"||a==="combination")&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded",children:["Selected: ",x.selectedUserId?"✅":"❌"]})]}),e.jsxs("div",{className:"flex space-x-3 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>He("dropdown"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${Ve==="dropdown"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"📋 Dropdown"}),e.jsx("button",{type:"button",onClick:()=>He("search"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${Ve==="search"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🔍 Αναζήτηση"})]}),Ve==="dropdown"?a==="individual"||a==="combination"?e.jsxs("select",{className:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-gray-700",value:x.selectedUserId,onChange:s=>{console.log("[AdminPanel] User selected:",s.target.value),Y({...x,selectedUserId:s.target.value})},children:[e.jsx("option",{value:"",children:"-- Επιλέξτε χρήστη --"}),A.length>0?A.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName," (",s.email,")"]},s.id)):e.jsx("option",{value:"",disabled:!0,children:"Δεν υπάρχουν χρήστες"})]}):e.jsx("div",{className:"max-h-48 overflow-y-auto border-2 border-blue-200 rounded-xl bg-white",children:X.length>0?X.map(s=>e.jsx("div",{className:`p-3 hover:bg-blue-50 cursor-pointer border-b border-blue-100 last:border-b-0 transition-all duration-200 ${i.includes(s.id)?"bg-blue-100 border-l-4 border-l-blue-500":""}`,onClick:()=>{i.includes(s.id)?w(r=>r.filter(l=>l!==s.id)):w(r=>[...r,s.id])},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.email})]})]})},s.id)):e.jsx("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Δεν υπάρχουν χρήστες"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",className:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-gray-700 placeholder-gray-400",placeholder:"🔍 Αναζήτηση με όνομα ή email...",value:Ue,onChange:s=>ds(s.target.value)}),Ue&&e.jsx("div",{className:"max-h-48 overflow-y-auto border-2 border-blue-200 rounded-xl bg-white shadow-lg",children:Nt.length>0?Nt.map(s=>e.jsxs("div",{className:`p-4 hover:bg-blue-50 cursor-pointer border-b border-blue-100 last:border-b-0 transition-all duration-200 ${a==="individual"||a==="combination"?x.selectedUserId===s.id?"bg-blue-100 border-l-4 border-l-blue-500":"":i.includes(s.id)?"bg-blue-100 border-l-4 border-l-blue-500":""}`,onClick:()=>{a==="individual"||a==="combination"?Y({...x,selectedUserId:s.id}):i.includes(s.id)?w(r=>r.filter(l=>l!==s.id)):w(r=>[...r,s.id])},children:[a==="group"&&e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.email})]},s.id)):e.jsx("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Δεν βρέθηκαν χρήστες"})})]}),(a==="individual"||a==="combination"?x.selectedUserId:i.length>0)&&e.jsx("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white text-sm",children:"✓"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold text-green-800",children:["✅ ",a==="individual"||a==="combination"?"Επιλεγμένος:":"Επιλεγμένοι:"]}),a==="individual"||a==="combination"?e.jsxs("div",{className:"text-xs text-green-600",children:[(At=A.find(s=>s.id===x.selectedUserId))==null?void 0:At.firstName," ",(Ct=A.find(s=>s.id===x.selectedUserId))==null?void 0:Ct.lastName," (",(Dt=A.find(s=>s.id===x.selectedUserId))==null?void 0:Dt.email,")"]}):e.jsxs("div",{className:"text-xs text-green-600",children:[i.map(s=>{const r=A.find(l=>l.id===s);return r?`${r.firstName} ${r.lastName}`:"Άγνωστος"}).join(", ")," (",i.length," χρήστες)"]})]})]})})]}),(a==="group"&&i.length>0||a==="combination"&&x.selectedUserId)&&e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-4 sm:p-6 border border-orange-200 mt-4",children:[e.jsxs("h4",{className:"text-lg sm:text-xl font-bold text-orange-800 mb-4 sm:mb-6 flex items-center",children:["🏠 ",a==="combination"?"Επιλογές Ομαδικής Αίθουσας (για Group Sessions)":"Επιλογές Ομαδικής Αίθουσας"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-purple-600",children:"💡"}),e.jsxs("div",{className:"text-sm text-purple-700",children:[e.jsx("strong",{children:"Νέα Λειτουργία:"})," Θα επιλέξετε το Group Size (2, 3, ή 6 άτομα) για κάθε σεσία ξεχωριστά στη Διαχείριση Ομαδικών Αναθέσεων"]})]})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-orange-700 mb-3",children:"Πόσες φορές την εβδομάδα θα παρακολουθούν οι χρήστες;"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>V(s),className:`p-3 rounded-lg border-2 transition-all duration-200 ${$===s?"bg-orange-600 text-white border-orange-600 shadow-lg":"bg-white text-orange-600 border-orange-300 hover:border-orange-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold",children:s}),e.jsxs("div",{className:"text-xs opacity-75",children:[s===1?"φορά":"φορές","/εβδομάδα"]})]})},s))})]})}),C&&$&&e.jsx("div",{className:"bg-orange-100 border border-orange-300 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Μηνιαίο Σύνολο"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[Z," συνεδρίες/μήνα"]}),e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(",$," φορές/εβδομάδα × 4 εβδομάδες)"]})]})}),C&&$&&e.jsx(tl,{selectedGroupRoom:C,weeklyFrequency:$,monthlyTotal:Z,selectedUserIds:a==="combination"?[x.selectedUserId]:i,onSlotsChange:is})]})]}),(a==="individual"||a==="combination"?x.selectedUserId:i.length>0)&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 sm:p-6 border border-purple-200 mt-4",children:[e.jsx("h4",{className:"text-lg sm:text-xl font-bold text-purple-800 mb-4 sm:mb-6 flex items-center",children:"⚙️ Επιλογές Προγράμματος"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[!(a==="individual"||a==="combination"?ms.has(x.selectedUserId):i.some(s=>ms.has(s)))&&e.jsx("div",{className:`rounded-lg p-4 border ${(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:e.jsx("button",{type:"button",onClick:()=>{const s=a==="individual"||a==="combination"?[x.selectedUserId]:i;if(s.some(l=>k(l))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ee(l=>{const o={...l};return s.forEach(c=>{var f;o[c]={...o[c],oldMembers:!((f=o[c])!=null&&f.oldMembers)}}),o})},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 relative shadow-lg ${(a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?($t=fe(x.selectedUserId))!=null&&$t.oldMembers?"bg-green-500 text-white":"bg-blue-500 text-white":(Tt=je[x.selectedUserId])!=null&&Tt.oldMembers?"bg-green-500 text-white hover:bg-green-600":"bg-blue-500 text-white hover:bg-blue-600":i.some(s=>{var r;return(r=je[s])==null?void 0:r.oldMembers})?"bg-green-500 text-white hover:bg-green-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"👴 Παλαιά μέλη"}),((a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?(Ut=fe(x.selectedUserId))==null?void 0:Ut.oldMembers:(Mt=je[x.selectedUserId])==null?void 0:Mt.oldMembers:i.some(s=>{var r;return(r=je[s])==null?void 0:r.oldMembers}))&&e.jsx("span",{className:"text-green-200",children:"✓"}),(a==="individual"?k(x.selectedUserId):i.some(s=>k(s)))&&e.jsx("span",{className:"text-yellow-600",children:"🔒"})]})})}),e.jsxs("div",{className:`rounded-lg p-4 border ${(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["🏋️‍♂️ Kettlebell Points",(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",value:(a==="individual"||a==="combination")&&x.selectedUserId&&k(x.selectedUserId)?((Et=fe(x.selectedUserId))==null?void 0:Et.kettlebellPoints)||"":gs,onChange:s=>{const r=a==="individual"?[x.selectedUserId]:i;if(r.some(o=>k(o))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Me(s.target.value),Ee(o=>{const c={...o};return r.forEach(f=>{c[f]={...c[f],kettlebellPoints:s.target.value}}),c})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(a==="individual"?k(x.selectedUserId):i.some(s=>k(s)))?"border-yellow-300 bg-yellow-50 focus:ring-yellow-500":"border-gray-300 focus:ring-purple-500 focus:border-purple-500"}`,placeholder:"Εισάγετε αριθμό...",disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s))})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["💰 Μετρητά (€)",(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),Qe?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",value:(a==="individual"||a==="combination")&&x.selectedUserId&&k(x.selectedUserId)?((Rt=(Lt=fe(x.selectedUserId))==null?void 0:Lt.cashAmount)==null?void 0:Rt.toString())||"":_e,onChange:s=>{if((a==="individual"||a==="combination"?[x.selectedUserId]:i).some(o=>k(o))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ie(s.target.value)},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(a==="individual"?k(x.selectedUserId):i.some(s=>k(s)))?"border-yellow-300 bg-yellow-50 focus:ring-yellow-500":"border-gray-300 focus:ring-green-500 focus:border-green-500"}`,placeholder:"Εισάγετε ποσό σε €...",autoFocus:!0,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s))}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{const s=a==="individual"||a==="combination"?[x.selectedUserId]:i;if(s.some(l=>k(l))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}_e&&parseFloat(_e)>0&&(Ee(l=>{const o={...l};return s.forEach(c=>{o[c]={...o[c],cash:!0,cashAmount:parseFloat(_e)}}),o}),h.success(`Μετρητά €${_e} προστέθηκαν! Θα αποθηκευτούν με το Save.`)),bs(!1),Ie("")},className:`flex-1 px-3 py-2 text-white rounded-lg transition-colors text-sm ${(a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?(Gt=fe(x.selectedUserId))!=null&&Gt.cash?"bg-green-600 cursor-not-allowed":"bg-yellow-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700":i.some(s=>k(s))?"bg-yellow-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)),children:"✓ Επιλογή"}),e.jsx("button",{type:"button",onClick:()=>{bs(!1),Ie("")},className:"flex-1 px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Ακύρωση"})]})]}):e.jsx("button",{type:"button",onClick:()=>{if((a==="individual"||a==="combination"?[x.selectedUserId]:i).some(l=>k(l))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}bs(!0)},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg ${(a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?(It=fe(x.selectedUserId))!=null&&It.cash?"bg-green-500 text-white cursor-not-allowed":"bg-yellow-500 text-white cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600":i.some(s=>k(s))?"bg-yellow-500 text-white cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"}`,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)),children:"💰 Μετρητά"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["💳 POS (€)",(a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),Js?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",value:(a==="individual"||a==="combination")&&x.selectedUserId&&k(x.selectedUserId)?((zt=(Ft=fe(x.selectedUserId))==null?void 0:Ft.posAmount)==null?void 0:zt.toString())||"":Pe,onChange:s=>{if((a==="individual"||a==="combination"?[x.selectedUserId]:i).some(o=>k(o))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}G(s.target.value)},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(a==="individual"?k(x.selectedUserId):i.some(s=>k(s)))?"border-yellow-300 bg-yellow-50 focus:ring-yellow-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Εισάγετε ποσό σε €...",autoFocus:!0,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s))}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{const s=a==="individual"||a==="combination"?[x.selectedUserId]:i;if(s.some(l=>k(l))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Pe&&parseFloat(Pe)>0&&(Ee(l=>{const o={...l};return s.forEach(c=>{o[c]={...o[c],pos:!0,posAmount:parseFloat(Pe)}}),o}),h.success(`POS €${Pe} προστέθηκε! Θα αποθηκευτεί με το Save.`)),ps(!1),G("")},className:`flex-1 px-3 py-2 text-white rounded-lg transition-colors text-sm ${(a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?(Kt=fe(x.selectedUserId))!=null&&Kt.pos?"bg-blue-600 cursor-not-allowed":"bg-yellow-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700":i.some(s=>k(s))?"bg-yellow-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)),children:"✓ Επιλογή"}),e.jsx("button",{type:"button",onClick:()=>{ps(!1),G("")},className:"flex-1 px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Ακύρωση"})]})]}):e.jsx("button",{type:"button",onClick:()=>{if((a==="individual"||a==="combination"?[x.selectedUserId]:i).some(l=>k(l))){h("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}ps(!0)},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg ${(a==="individual"||a==="combination")&&x.selectedUserId?k(x.selectedUserId)?(Ot=fe(x.selectedUserId))!=null&&Ot.pos?"bg-blue-500 text-white cursor-not-allowed":"bg-yellow-500 text-white cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600":i.some(s=>k(s))?"bg-yellow-500 text-white cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,disabled:a==="individual"||a==="combination"?k(x.selectedUserId):i.some(s=>k(s)),children:"💳 POS"})]}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{Xe("approved")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${xe==="approved"?"bg-green-600 text-white shadow-lg":"bg-green-500 text-white hover:bg-green-600 shadow-lg"}`,children:"✅ Έγκριση"})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{Xe("rejected")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${xe==="rejected"?"bg-red-600 text-white shadow-lg":"bg-red-500 text-white hover:bg-red-600 shadow-lg"}`,children:"❌ Απόρριψη"})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{Xe("pending")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${xe==="pending"?"bg-yellow-600 text-white shadow-lg":"bg-yellow-500 text-white hover:bg-yellow-600 shadow-lg"}`,children:"⏳ Στην Αναμονή"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4 border border-purple-200",children:[e.jsx("button",{type:"button",onClick:sa,disabled:xe==="none"||p,className:`w-full px-6 py-4 rounded-lg font-bold text-lg transition-all duration-200 ${xe==="none"||p?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 shadow-lg hover:shadow-xl"}`,children:p?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(As,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Αποθήκευση..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{children:"💾 Αποθήκευση Program Options"})]})}),xe==="none"&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:"Επιλέξτε Έγκριση, Απόρριψη ή Στην Αναμονή για να αποθηκεύσετε"})]})]})]}),a!=="group"&&e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-4 sm:p-6 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[e.jsxs("h4",{className:"text-lg sm:text-xl font-bold text-orange-800 flex items-center",children:["🏋️‍♂️ Προσωποποιημένο Πρόγραμμα",a==="combination"&&e.jsx("span",{className:"ml-2 text-sm bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:"Personal Sessions"})]}),e.jsxs("div",{className:`text-sm px-3 py-2 rounded-lg ${a==="combination"&&ye.length>P?"bg-red-100 text-red-700 border border-red-300":"text-gray-600 bg-gray-100"}`,children:["📊 Σύνολο: ",ye.length," σεσίας",a==="combination"&&e.jsxs("span",{className:`ml-2 ${ye.length>P?"text-red-600":"text-purple-600"}`,children:["(",P," θα χρησιμοποιηθούν)",ye.length>P&&e.jsx("span",{className:"ml-1 font-bold",children:"⚠️ Περισσότερες από όσες θα χρησιμοποιηθούν!"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border-2 border-gray-300 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 border-b-2 border-gray-400",children:e.jsxs("div",{className:`grid gap-0 text-sm font-bold text-gray-800 ${a==="individual"?"grid-cols-7":"grid-cols-8"}`,children:[e.jsx("div",{className:"col-span-1 text-center py-3 border-r border-gray-300 bg-gray-200",children:"#"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"📅 Ημερομηνία"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"🕐 Έναρξη"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"🕕 Λήξη"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"💪 Τύπος"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"🏠 Αίθουσα"}),a!=="individual"&&e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"👥 Group"}),e.jsx("div",{className:"col-span-1 py-3 px-2",children:"👨‍🏫 Προπονητής"})]})}),e.jsx("div",{className:"divide-y divide-gray-300",children:ye.map((s,r)=>e.jsxs("div",{className:`grid gap-0 hover:bg-blue-50 transition-colors ${a==="individual"?"grid-cols-7":"grid-cols-8"}`,children:[e.jsxs("div",{className:"col-span-1 flex items-center justify-center space-x-2 py-3 border-r border-gray-300 bg-gray-50",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700",children:r+1}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>pe(l=>l.filter((o,c)=>c!==r)),className:"text-red-600 hover:text-red-800 p-1 text-xs bg-red-100 rounded hover:bg-red-200",title:"Διαγραφή Σέσιας",children:e.jsx(Cs,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>pe(l=>{const o={...s,id:`tmp-${Date.now()}`};return[...l.slice(0,r+1),o,...l.slice(r+1)]}),className:"text-blue-600 hover:text-blue-800 p-1 text-xs bg-blue-100 rounded hover:bg-blue-200",title:"Αντιγραφή Σέσιας",children:e.jsx($s,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsx("input",{type:"date",className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.date,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,date:l.target.value}:c))})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsx("input",{type:"time",className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.startTime,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,startTime:l.target.value}:c))})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsx("input",{type:"time",className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.endTime,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,endTime:l.target.value}:c))})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.type,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,type:l.target.value}:c)),children:[e.jsx("option",{value:"personal",children:"Προσωπική"}),e.jsx("option",{value:"kickboxing",children:"Kick Boxing"}),e.jsx("option",{value:"combo",children:"Combo"})]})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.room,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,room:l.target.value}:c)),children:[e.jsx("option",{value:"Αίθουσα Mike",children:"Αίθουσα Mike"}),e.jsx("option",{value:"Αίθουσα Jordan",children:"Αίθουσα Jordan"})]})}),a!=="individual"&&e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:a==="combination"?e.jsx("div",{className:"w-full px-2 py-2 text-sm border-2 border-gray-200 rounded bg-gray-100 text-gray-600 font-medium",children:"🔒 1 άτομο (Ατομική)"}):e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.group||"",onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,group:l.target.value}:c)),children:[e.jsx("option",{value:"",children:"Επιλέξτε Group"}),e.jsx("option",{value:"2ΑτομαGroup",children:"2ΑτομαGroup"}),e.jsx("option",{value:"3ΑτομαGroup",children:"3ΑτομαGroup"}),e.jsx("option",{value:"6ΑτομαGroup",children:"6ΑτομαGroup"})]})}),e.jsx("div",{className:"col-span-1 p-2",children:e.jsx("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.trainer,onChange:l=>pe(o=>o.map((c,f)=>f===r?{...c,trainer:l.target.value}:c)),children:Ur.map(l=>e.jsx("option",{value:l,children:l},l))})})]},s.id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mt-4 space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>{if(a==="combination"&&ye.length>=P){h.error(`Για συνδυασμένο πρόγραμμα μπορείτε να έχετε μέγιστο ${P} ατομικές σεσίες`);return}pe(s=>{var r;return[...s,{id:`tmp-${Date.now()}`,date:new Date().toISOString().split("T")[0],startTime:"19:00",endTime:"20:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:a==="combination"?void 0:"2ΑτομαGroup",notes:((r=s[0])==null?void 0:r.notes)||""}]})},children:"➕ Προσθήκη Σέσιας"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>{var r;if(a==="combination"&&ye.length>=P){h.error(`Για συνδυασμένο πρόγραμμα μπορείτε να έχετε μέγιστο ${P} ατομικές σεσίες`);return}const s={id:`tmp-${Date.now()}`,date:new Date().toISOString().split("T")[0],startTime:"19:00",endTime:"20:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:((r=ye[0])==null?void 0:r.notes)||""};pe(l=>[...l,s])},children:"📋 Αντιγραφή Τελευταίας"}),ye.length>1&&e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>pe(s=>s.slice(0,-1)),children:"➖ Διαγραφή Τελευταίας"})]}),e.jsx("div",{className:"text-center sm:text-right",children:e.jsx("div",{className:"text-xs text-gray-500",children:"💡 Κάντε κλικ στα κελιά για επεξεργασία • Χρησιμοποιήστε τα κουμπιά για διαχείριση"})})]})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>M(!1),className:"flex-1 px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl hover:from-gray-600 hover:to-gray-700 transition-all duration-200 font-semibold shadow-lg",children:"❌ Ακύρωση"}),e.jsxs("button",{onClick:()=>{console.log("[AdminPanel] Button clicked - trainingType:",a,"selectedUserId:",x.selectedUserId),ra()},disabled:a==="individual"||a==="combination"?!x.selectedUserId:i.length===0,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-200 font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-green-500 disabled:hover:to-emerald-500",title:a==="individual"||a==="combination"?x.selectedUserId?"Δημιουργία Προγράμματος":"Παρακαλώ επιλέξτε χρήστη":i.length===0?"Παρακαλώ επιλέξτε χρήστες":"Δημιουργία Προγράμματος",children:["✅ Δημιουργία Προγράμματος",(a==="individual"||a==="combination")&&!x.selectedUserId&&e.jsx("span",{className:"ml-2 text-xs opacity-75",children:"(Επιλέξτε χρήστη)"})]})]})]})]})}),$e&&Ke&&os&&$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Διαχείριση Ομαδικών Αναθέσεων"}),e.jsx("button",{onClick:()=>{ns(!1),We(null),Be(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx(sl,{selectedUser:Ke,programId:os,weeklyFrequency:$,onAssignmentComplete:()=>{const s=i.findIndex(r=>r===Ke.id);if(s<i.length-1){const r=i[s+1],l=A.find(o=>o.id===r);l&&O.from("personal_training_schedules").select("id").eq("user_id",l.id).order("created_at",{ascending:!1}).limit(1).then(({data:o})=>{o&&o.length>0&&(We(l),Be(o[0].id),h.success(`Μετάβαση στον επόμενο χρήστη: ${l.firstName} ${l.lastName}`))})}else h.success("Όλες οι αναθέσεις ολοκληρώθηκαν!"),ns(!1),We(null),Be(null)}})})]})}),u==="ultimate-subscriptions"&&!p&&e.jsx(ll,{fallback:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-6 w-24 h-24 mx-auto mb-6",children:e.jsx(ht,{className:"h-12 w-12 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Σφάλμα στη φόρτωση Ultimate Συνδρομών"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Παρουσιάστηκε ένα σφάλμα. Παρακαλώ ανανεώστε τη σελίδα ή δοκιμάστε ξανά."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Ανανέωση Σελίδας"})]}),children:e.jsx("div",{className:"space-y-6",children:e.jsx(al,{ultimateRequests:Ze,ultimateLoading:qe,ultimateSearchTerm:Is,setUltimateSearchTerm:Ls,selectedRequestOptions:J,handleRequestOptionChange:ue,updateInstallmentAmounts:va,deleteUltimateRequest:fa,loadUltimateRequests:Re,handleApproveRequest:ya,handleRejectRequest:ja,loading:p,requestProgramApprovalStatus:rs,handleRequestProgramApprovalChange:zs,handleSaveRequestProgramOptions:St,requestPendingUsers:Gs,requestFrozenOptions:Os})})})]})};export{Nl as default};
