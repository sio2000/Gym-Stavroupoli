const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/referralService-DahqRKIV.js","assets/index-BmeQlVRf.js","assets/index-BW2mbWrF.css"])))=>i.map(i=>d[i]);
import{d as V,r as c,H as u,z as i,j as e,e as b,I as q,J as F,_ as K}from"./index-BmeQlVRf.js";import{getDurationDisplayText as Q}from"./membershipApi-CMfnHNpJ.js";import{A as W}from"./award-DqnVjZoB.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=V("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),re=()=>{var P,S,E,D;const[r,h]=c.useState({email:"",password:"",confirmPassword:"",first_name:"",last_name:"",phone:"",date_of_birth:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",language:"el",selectedPackage:"",selectedDuration:"",referralCode:"",acceptTerms:!1,acceptPrivacy:!1,acceptMarketing:!1}),[j,R]=c.useState([]),[g,$]=c.useState([]),[N,w]=c.useState(!1),[p,A]=c.useState(!1),[y,T]=c.useState(!1),[l,v]=c.useState(1),[M,O]=c.useState(!1),_=[{id:1,title:"Προσωπικά Στοιχεία",description:"Βασικές πληροφορίες"},{id:2,title:"Επιλογή Πακέτου",description:"Συνδρομή και διάρκεια"},{id:3,title:"Επιβεβαίωση",description:"Έλεγχος και υποβολή"}];c.useEffect(()=>{z()},[]);const z=async()=>{try{const{data:s,error:a}=await u.from("membership_packages").select("*").eq("is_active",!0).order("name");if(a)throw a;R(s||[])}catch(s){console.error("Error loading packages:",s),i.error("Σφάλμα κατά τη φόρτωση των πακέτων")}},I=async s=>{try{const{data:a,error:n}=await u.from("membership_package_durations").select("*").eq("package_id",s).eq("is_active",!0).order("duration_days");if(n)throw n;$(a||[])}catch(a){console.error("Error loading package durations:",a),i.error("Σφάλμα κατά τη φόρτωση των επιλογών διάρκειας")}},t=s=>{const{name:a,value:n,type:m}=s.target,o=s.target.checked;h(d=>({...d,[a]:m==="checkbox"?o:n}))},L=s=>{h(a=>({...a,selectedPackage:s,selectedDuration:""})),I(s)},k=s=>{switch(s){case 1:return!!(r.email&&r.password&&r.confirmPassword&&r.first_name&&r.last_name&&r.phone&&r.password===r.confirmPassword);case 2:return!!(r.selectedPackage&&r.selectedDuration);case 3:return r.acceptTerms&&r.acceptPrivacy;default:return!1}},B=()=>{k(l)?v(s=>s+1):i.error("Παρακαλώ συμπληρώστε όλα τα απαραίτητα πεδία")},G=()=>{v(s=>s-1)},H=async s=>{if(s.preventDefault(),!k(3)){i.error("Παρακαλώ συμπληρώστε όλα τα απαραίτητα πεδία");return}w(!0);try{const{data:a,error:n}=await u.auth.signUp({email:r.email,password:r.password,options:{data:{first_name:r.first_name,last_name:r.last_name,language:r.language}}});if(n)throw n;if(!a.user)throw new Error("Failed to create user");const{error:m}=await u.from("user_profiles").insert([{user_id:a.user.id,email:r.email,first_name:r.first_name,last_name:r.last_name,phone:r.phone,date_of_birth:r.date_of_birth||null,address:r.address,emergency_contact_name:r.emergency_contact_name,emergency_contact_phone:r.emergency_contact_phone,language:r.language,role:"user"}]);if(m)throw m;const o=g.find(x=>x.id===r.selectedDuration);if(!o)throw new Error("Selected duration not found");const{error:d}=await u.from("membership_requests").insert([{user_id:a.user.id,package_id:r.selectedPackage,duration_type:o.duration_type,requested_price:o.price,classes_count:o.classes_count,status:"pending"}]);if(d)throw d;if(r.referralCode.trim())try{const{processReferralSignup:x}=await K(async()=>{const{processReferralSignup:U}=await import("./referralService-DahqRKIV.js");return{processReferralSignup:U}},__vite__mapDeps([0,1,2])),f=await x(a.user.id,r.referralCode.trim());f.success?i.success(`Ευχαριστούμε! ${f.message}`):i.error(f.message)}catch(x){console.error("Error processing referral:",x),i.error("Σφάλμα επεξεργασίας κωδικού παραπομπής, αλλά η εγγραφή ολοκληρώθηκε επιτυχώς.")}O(!0),i.success("Η εγγραφή σας ολοκληρώθηκε επιτυχώς! Θα ενημερωθείτε για την έγκριση.")}catch(a){console.error("Error during registration:",a),i.error("Σφάλμα κατά την εγγραφή. Παρακαλώ δοκιμάστε ξανά.")}finally{w(!1)}},J=()=>j.find(s=>s.id===r.selectedPackage),C=()=>g.find(s=>s.id===r.selectedDuration);return M?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(b,{className:"h-10 w-10 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Εγγραφή Ολοκληρώθηκε!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Η εγγραφή σας υποβλήθηκε επιτυχώς. Θα ενημερωθείτε μέσω email για την έγκριση του αιτήματός σας."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors",children:"Συνδεθείτε"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full border border-gray-300 text-gray-700 py-3 px-6 rounded-lg hover:bg-gray-50 transition-colors",children:"Αρχική Σελίδα"})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Εγγραφή στο Get Fit"}),e.jsx("p",{className:"text-gray-600",children:"Γίνετε μέλος της οικογένειάς μας και ξεκινήστε το ταξίδι σας προς την υγεία"})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-center space-x-4",children:_.map((s,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${l>=s.id?"bg-primary-600 border-primary-600 text-white":"bg-white border-gray-300 text-gray-500"}`,children:l>s.id?e.jsx(b,{className:"h-5 w-5"}):e.jsx("span",{className:"text-sm font-semibold",children:s.id})}),e.jsxs("div",{className:"ml-3 hidden sm:block",children:[e.jsx("p",{className:`text-sm font-medium ${l>=s.id?"text-primary-600":"text-gray-500"}`,children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]}),a<_.length-1&&e.jsx("div",{className:`w-8 h-0.5 mx-4 ${l>s.id?"bg-primary-600":"bg-gray-300"}`})]},s.id))})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:e.jsxs("form",{onSubmit:H,children:[l===1&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Προσωπικά Στοιχεία"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Όνομα *"}),e.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Επώνυμο *"}),e.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Τηλέφωνο *"}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Κωδικός Πρόσβασης *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",name:"password",value:r.password,onChange:t,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"button",onClick:()=>A(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?e.jsx(q,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Επιβεβαίωση Κωδικού *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:t,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"button",onClick:()=>T(!y),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?e.jsx(q,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ημερομηνία Γέννησης"}),e.jsx("input",{type:"date",name:"date_of_birth",value:r.date_of_birth,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Γλώσσα"}),e.jsxs("select",{name:"language",value:r.language,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"el",children:"Ελληνικά"}),e.jsx("option",{value:"en",children:"English"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Διεύθυνση"}),e.jsx("textarea",{name:"address",value:r.address,onChange:t,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Περιγράψτε την διεύθυνσή σας..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Όνομα Επικοινωνίας Έκτακτης Ανάγκης"}),e.jsx("input",{type:"text",name:"emergency_contact_name",value:r.emergency_contact_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Τηλέφωνο Επικοινωνίας Έκτακτης Ανάγκης"}),e.jsx("input",{type:"tel",name:"emergency_contact_phone",value:r.emergency_contact_phone,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Κωδικός Παραπομπής (Προαιρετικό)"}),e.jsx("input",{type:"text",name:"referralCode",value:r.referralCode,onChange:t,placeholder:"Εισάγετε κωδικό παραπομπής",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Έχετε κωδικός παραπομπής; Εισάγετε τον εδώ για να κερδίσετε πόντους!"})]})]}),l===2&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Επιλογή Πακέτου"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:j.map(s=>{var a;return e.jsx("div",{className:`border-2 rounded-xl p-6 cursor-pointer transition-all ${r.selectedPackage===s.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,onClick:()=>L(s.id),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(W,{className:"h-8 w-8 text-primary-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"text-2xl font-bold text-primary-600 mb-4",children:["€",((a=s.price)==null?void 0:a.toFixed(2))||"0.00"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.duration_days," ημέρες"]})]})},s.id)})}),r.selectedPackage&&g.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Επιλέξτε Διάρκεια:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.sort((s,a)=>{var d;if(((d=r.selectedPackage)==null?void 0:d.name)==="Pilates"&&s.classes_count&&a.classes_count)return s.classes_count-a.classes_count;const n={lesson:1,month:30,semester:180,year:365},m=n[s.duration_type]||s.duration_days,o=n[a.duration_type]||a.duration_days;return m-o}).map(s=>{var a;return e.jsx("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-all ${r.selectedDuration===s.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,onClick:()=>h(n=>({...n,selectedDuration:s.id})),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.duration_type}),e.jsx("p",{className:"text-sm text-gray-600",children:s.classes_count?`${s.classes_count} μαθήματα`:Q(s.duration_type,s.duration_days)})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-primary-600",children:["€",((a=s.price)==null?void 0:a.toFixed(2))||"0.00"]})})]})},s.id)})})]})]}),l===3&&e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Επιβεβαίωση"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Σύνοψη Εγγραφής"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Όνομα:"}),e.jsxs("span",{className:"font-medium",children:[r.first_name," ",r.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:r.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Τηλέφωνο:"}),e.jsx("span",{className:"font-medium",children:r.phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Πακέτο:"}),e.jsx("span",{className:"font-medium",children:(P=J())==null?void 0:P.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Διάρκεια:"}),e.jsx("span",{className:"font-medium",children:(S=C())==null?void 0:S.duration_type})]}),e.jsxs("div",{className:"flex justify-between border-t pt-4",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Συνολικό Κόστος:"}),e.jsxs("span",{className:"text-lg font-bold text-primary-600",children:["€",((D=(E=C())==null?void 0:E.price)==null?void 0:D.toFixed(2))||"0.00"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptTerms",checked:r.acceptTerms,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",required:!0}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Αποδέχομαι τους ",e.jsx("a",{href:"/terms",className:"text-primary-600 hover:underline",children:"Όρους Χρήσης"})," *"]})]}),e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptPrivacy",checked:r.acceptPrivacy,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",required:!0}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Αποδέχομαι την ",e.jsx("a",{href:"/privacy",className:"text-primary-600 hover:underline",children:"Πολιτική Απορρήτου"})," *"]})]}),e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",name:"acceptMarketing",checked:r.acceptMarketing,onChange:t,className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Θέλω να λαμβάνω ενημερώσεις και προσφορές μέσω email"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-8 py-6 flex justify-between",children:[e.jsx("button",{type:"button",onClick:G,disabled:l===1,className:`px-6 py-3 rounded-lg font-medium transition-colors ${l===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Προηγούμενο"}),l<3?e.jsxs("button",{type:"button",onClick:B,className:"flex items-center space-x-2 bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx("span",{children:"Επόμενο"}),e.jsx(X,{className:"h-4 w-4"})]}):e.jsx("button",{type:"submit",disabled:N,className:"flex items-center space-x-2 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Εγγραφή..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Ολοκλήρωση Εγγραφής"}),e.jsx(b,{className:"h-4 w-4"})]})})]})]})})]})})};export{re as default};
