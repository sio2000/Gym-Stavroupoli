const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/membershipApi-BWxw4nWA.js","assets/index-ZmRz_kF8.js","assets/index-CL_ZVhm7.css"])))=>i.map(i=>d[i]);
var Nn=Object.defineProperty;var _n=(o,p,w)=>p in o?Nn(o,p,{enumerable:!0,configurable:!0,writable:!0,value:w}):o[p]=w;var kt=(o,p,w)=>_n(o,typeof p!="symbol"?p+"":p,w);import{d as sr,j as e,s as D,r as d,X as Ke,b as Me,z as c,U as Ve,q as Xt,n as $t,C as st,M as il,u as dl,R as At,t as qs,h as cl,L as ss,v as Zs,w as Pn,P as Sn,e as kn,x as tl,_ as An}from"./index-ZmRz_kF8.js";import{g as $n,a as rl,b as Cn,c as Qt,d as al,f as Ys,r as Mn,v as Un,e as Dn,s as In,h as En,i as Tn}from"./groupAssignmentApi-DZJLlsCI.js";import{P as Ln}from"./PilatesScheduleDisplay-DIa1EmwM.js";import{R as _s}from"./refresh-cw-bL_ilMEE.js";import{S as Be}from"./search-DgEtpkkJ.js";import{T as et,P as Fn,g as On,a as Rn,s as Gn,b as zn,c as Kn,d as Vn,G as Bn,e as Wn,f as Hn,h as Qs,i as Jt,m as Js}from"./programApprovalApi-DJg9-5DN.js";import{P as Ct}from"./plus-BG5DWusa.js";import{getDurationLabel as qt,formatPrice as Re,getMembershipPackages as Yn,getPilatesPackageDurations as Qn,getMembershipRequestsWithLockedInstallments as Jn,getUltimateMembershipRequests as Zn,updatePilatesPackagePricing as Xn,updateMembershipPackageDuration as qn,approveUltimateMembershipRequest as eo,approveMembershipRequest as so,rejectMembershipRequest as ll,getMembershipPackageDurations as to}from"./membershipApi-BWxw4nWA.js";import{C as ro,a as ao}from"./chevron-right-Dd30DhYX.js";import{A as Xs}from"./award-DLKJNSqY.js";import{i as lo}from"./installmentsEligibility-S0jv_ow-.js";import"./pilatesScheduleApi-BWbi5Hfr.js";import"./date-D_3Ba85T.js";import"./groupTrainingCalendarApi-C4SB04po.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=sr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=sr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=sr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),no=()=>e.jsx(Ln,{readOnly:!1,showAdminControls:!0,title:"Πρόγραμμα Pilates",subtitle:"Κάντε κλικ στις ώρες που δεν θέλετε να είναι διαθέσιμες"}),Ns=async(o,p,w,A,P="",M)=>{try{console.log("[saveCashTransaction] Saving transaction:",{userId:o,amount:p,transactionType:w,programId:A,createdBy:P,notes:M});const{data:N,error:z}=await D.from("user_cash_transactions").insert({user_id:o,amount:p,transaction_type:w,program_id:A,created_by:P,notes:M}).select().single();return z?(console.error("[saveCashTransaction] Error saving transaction:",z),!1):(console.log("[saveCashTransaction] Transaction saved successfully:",N),!0)}catch(N){return console.error("[saveCashTransaction] Exception saving transaction:",N),!1}},oo=async(o,p)=>{try{console.log("[getCashRegisterTotals] Fetching totals...");let w=D.from("user_cash_transactions").select("amount, transaction_type, created_at");if(o&&(w=w.gte("created_at",o)),p){const N=p.length===10?`${p}T23:59:59.999Z`:p;w=w.lte("created_at",N)}const{data:A,error:P}=await w;if(P)return console.error("[getCashRegisterTotals] Error fetching totals:",P),{total_cash:0,total_pos:0,total_transactions:0};const M=(A==null?void 0:A.reduce((N,z)=>(z.transaction_type==="cash"?N.total_cash+=z.amount:z.transaction_type==="pos"&&(N.total_pos+=z.amount),N.total_transactions+=1,N),{total_cash:0,total_pos:0,total_transactions:0}))||{total_cash:0,total_pos:0,total_transactions:0};return console.log("[getCashRegisterTotals] Totals calculated:",M),M}catch(w){return console.error("[getCashRegisterTotals] Exception fetching totals:",w),{total_cash:0,total_pos:0,total_transactions:0}}},io=async(o,p)=>{try{console.log("[getCashSummaryPerUser] Fetching user summaries...");let w=D.from("user_cash_transactions").select(`
        user_id,
        amount,
        transaction_type,
        created_at,
        user_profiles!user_cash_transactions_user_id_fkey(
          first_name,
          last_name,
          email
        )
      `).order("created_at",{ascending:!1});if(o&&(w=w.gte("created_at",o)),p){const z=p.length===10?`${p}T23:59:59.999Z`:p;w=w.lte("created_at",z)}const{data:A,error:P}=await w;if(P)return console.error("[getCashSummaryPerUser] Error fetching user summaries:",P),[];if(console.log("[getCashSummaryPerUser] Raw data received:",(A==null?void 0:A.length)||0,"records"),!A||A.length===0)return console.log("[getCashSummaryPerUser] No data found, returning empty array"),[];const M=new Map;A.forEach(z=>{const te=z.user_id,ie=z.user_profiles;M.has(te)||M.set(te,{user_id:te,user_name:ie?`${ie.first_name||""} ${ie.last_name||""}`.trim():`User ${te.slice(0,8)}`,user_email:(ie==null?void 0:ie.email)||"No email",cash_total:0,pos_total:0,cash_count:0,pos_count:0});const T=M.get(te);z.transaction_type==="cash"?(T.cash_total+=z.amount,T.cash_count+=1,(!T.last_cash_date||new Date(z.created_at)>new Date(T.last_cash_date))&&(T.last_cash_date=z.created_at)):z.transaction_type==="pos"&&(T.pos_total+=z.amount,T.pos_count+=1,(!T.last_pos_date||new Date(z.created_at)>new Date(T.last_pos_date))&&(T.last_pos_date=z.created_at))});const N=Array.from(M.values()).sort((z,te)=>te.cash_total+te.pos_total-(z.cash_total+z.pos_total));return console.log("[getCashSummaryPerUser] Processed summaries:",N),N}catch(w){return console.error("[getCashSummaryPerUser] Exception fetching user summaries:",w),[]}},co=()=>{const[o,p]=d.useState({total_cash:0,total_pos:0,total_transactions:0}),[w,A]=d.useState([]),[P,M]=d.useState(!1),[N,z]=d.useState(""),[te,ie]=d.useState([]),[T,fe]=d.useState(""),[je,ue]=d.useState(""),[I,me]=d.useState(1),W=10,L=async()=>{try{M(!0);const[g,he]=await Promise.all([oo(T||void 0,je||void 0),io(T||void 0,je||void 0)]);p(g),A(he)}catch(g){console.error("Error loading cash register data:",g),c.error("Σφάλμα κατά τη φόρτωση των δεδομένων ταμείου")}finally{M(!1)}};d.useEffect(()=>{L()},[]);const we=()=>{me(1),L()},Ue=g=>{if(!g.trim()){ie([]);return}const he=w.filter(u=>u.user_name.toLowerCase().includes(g.toLowerCase())||u.user_email.toLowerCase().includes(g.toLowerCase()));ie(he)},ee=g=>{z(g),Ue(g),me(1)},re=Math.ceil(w.length/W),m=(I-1)*W,ve=m+W,n=w.slice(m,ve),_e=()=>{me(g=>Math.max(g-1,1))},ae=()=>{me(g=>Math.min(g+1,re))},X=N?te:n;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"💰 Ταμείο"}),e.jsx("p",{className:"text-green-100 text-sm sm:text-base",children:"Συνολικά ποσά και ανάλυση χρηστών"})]}),e.jsxs("button",{onClick:L,disabled:P,className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm disabled:opacity-50",children:[e.jsx(_s,{className:`h-4 w-4 ${P?"animate-spin":""}`}),e.jsx("span",{children:"🔄 Ανανέωση"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-green-800 mb-2",children:"💵 Συνολικά Μετρητά"}),e.jsx("p",{className:"text-green-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold text-green-900",children:["€",o.total_cash.toFixed(2)]}),e.jsx("div",{className:"text-sm text-green-600",children:"ευρώ"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"💳 Συνολικά POS"}),e.jsx("p",{className:"text-blue-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-900",children:["€",o.total_pos.toFixed(2)]}),e.jsx("div",{className:"text-sm text-blue-600",children:"ευρώ"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-purple-800 mb-2",children:"📊 Συνολικές Συναλλαγές"}),e.jsx("p",{className:"text-purple-600",children:"Όλες οι συναλλαγές"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-purple-900",children:o.total_transactions}),e.jsx("div",{className:"text-sm text-purple-600",children:"συναλλαγές"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"👥 Ανάλυση Χρηστών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Μετρητά και POS ανά χρήστη"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση χρήστη...",value:N,onChange:g=>ee(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm"})]}),N&&e.jsx("button",{onClick:()=>ee(""),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 ml-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:T,onChange:g=>fe(g.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm"})]}),e.jsx("span",{className:"text-gray-500 text-sm",children:"—"}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:je,onChange:g=>ue(g.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm"})]}),e.jsx("button",{onClick:we,className:"px-3 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700",children:"Φίλτρο"})]})]})]})}),e.jsx("div",{className:"p-6",children:P?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_s,{className:"h-8 w-8 mx-auto mb-4 text-gray-400 animate-spin"}),e.jsx("p",{className:"text-gray-500",children:"Φόρτωση δεδομένων..."})]}):X.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(er,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν υπάρχουν συναλλαγές ακόμα"}),e.jsx("p",{className:"text-sm mt-2",children:"Οι συναλλαγές θα εμφανιστούν εδώ όταν δημιουργηθούν"})]}):e.jsxs("div",{className:"space-y-4",children:[X.map((g,he)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:g.user_name.split(" ").map(u=>u[0]).join("").slice(0,2)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:g.user_name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.user_email}),e.jsxs("div",{className:"flex space-x-4 text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["💵 ",g.cash_count," μετρητά"]}),e.jsxs("span",{children:["💳 ",g.pos_count," POS"]})]})]})]}),e.jsx("div",{className:"text-right space-y-2",children:e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["€",g.cash_total.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Μετρητά"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["€",g.pos_total.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"POS"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["€",(g.cash_total+g.pos_total).toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Σύνολο"})]})]})})]})},g.user_id)),N&&te.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Be,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν βρέθηκαν χρήστες με αυτό το όνομα"}),e.jsx("p",{className:"text-sm mt-2",children:"Δοκιμάστε ένα διαφορετικό όρο αναζήτησης"})]}),!N&&re>1&&e.jsxs("div",{className:"flex items-center justify-between py-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Εμφανίζονται ",m+1,"-",Math.min(ve,w.length)," από ",w.length," χρήστες"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:_e,disabled:I===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"← Προηγούμενη"}),e.jsxs("span",{className:"px-3 py-2 text-sm text-gray-700",children:["Σελίδα ",I," από ",re]}),e.jsx("button",{onClick:ae,disabled:I===re,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Επόμενη →"})]})]})]})})]})]})},mo=({selectedUser:o,programId:p,weeklyFrequency:w,onAssignmentComplete:A})=>{const[P,M]=d.useState([]),[N,z]=d.useState([]),[te,ie]=d.useState(null),[T,fe]=d.useState(null),[je,ue]=d.useState([]),[I,me]=d.useState(!1),[W,L]=d.useState(""),[we,Ue]=d.useState([]),[ee,re]=d.useState("new"),[m,ve]=d.useState([]),[n,_e]=d.useState(!1);d.useEffect(()=>{ae()},[o.id,p]);const ae=async()=>{me(!0);try{await Promise.all([g(),he(),u()])}catch(h){console.error("Failed to load group assignment data:",h),c.error("Σφάλμα κατά τη φόρτωση των δεδομένων")}finally{me(!1)}},X=async h=>{var $;if(h){_e(!0);try{const{data:H,error:De}=await D.from("personal_training_schedules").select("schedule_data, sessions, created_at").eq("user_id",h).order("created_at",{ascending:!1}).limit(1);if(De){console.error("[GroupAssignmentManager] Error loading existing sessions:",De),c.error("Σφάλμα κατά τη φόρτωση των υπαρχόντων σεσιών"),ve([]);return}if(H&&H.length>0){const J=H[0],de=(($=J==null?void 0:J.schedule_data)==null?void 0:$.sessions)||(J==null?void 0:J.sessions)||[];ve(de),de.length>0&&c.success(`Φορτώθηκαν ${de.length} υπάρχουσες σεσίες`)}else ve([])}catch(H){console.error("[GroupAssignmentManager] Exception loading existing sessions:",H),ve([])}finally{_e(!1)}}};d.useEffect(()=>{ee==="existing"&&(o!=null&&o.id)&&X(o.id)},[ee,o==null?void 0:o.id]);const g=async()=>{try{const h=await $n(te||void 0);M(h)}catch(h){throw console.error("Failed to load available slots:",h),h}},he=async()=>{try{const h=await rl(o.id,p);z(h)}catch(h){throw console.error("Failed to load user assignments:",h),h}},u=async()=>{try{const h=await Cn(o.id,p);Ue(h)}catch(h){throw console.error("Failed to load weekly assignment summary:",h),h}},se=async h=>{try{const $=await En(h);ue($)}catch($){console.error("Failed to load slot assignments:",$),c.error("Σφάλμα κατά τη φόρτωση των αναθέσεων")}},v=async h=>{fe(h),await se(h.groupIdentifier)},Z=async()=>{if(!T){c.error("Παρακαλώ επιλέξτε μια ομαδική θέση");return}try{me(!0);const h=await Un(o.id,p,T.groupIdentifier,T.dayOfWeek,T.startTime,T.endTime,w);if(!h.isValid){c.error(`Δεν είναι δυνατή η ανάθεση: ${h.errorMessage}`);return}const $=await Dn(p,o.id,T.groupIdentifier,w,W);if($.success){c.success("Η ανάθεση δημιουργήθηκε επιτυχώς!"),L(""),await ae(),await se(T.groupIdentifier);const H=await rl(o.id,p);H.length>=w&&await In(o.id,p,H)&&c.success(`🎉 Το πρόγραμμα ολοκληρώθηκε! Ο χρήστης ${o.firstName} ${o.lastName} θα λάβει ενημέρωση.`),A&&A()}else c.error(`Σφάλμα: ${$.message}`)}catch(h){console.error("Failed to assign user:",h),c.error("Σφάλμα κατά τη δημιουργία της ανάθεσης")}finally{me(!1)}},Pe=async h=>{if(confirm("Είστε σίγουροι ότι θέλετε να αφαιρέσετε αυτή την ανάθεση;"))try{me(!0),await Mn(h)?(c.success("Η ανάθεση αφαιρέθηκε επιτυχώς"),await ae(),T&&await se(T.groupIdentifier)):c.error("Σφάλμα κατά την αφαίρεση της ανάθεσης")}catch($){console.error("Failed to remove assignment:",$),c.error("Σφάλμα κατά την αφαίρεση της ανάθεσης")}finally{me(!1)}},Se=()=>N.length,le=()=>Math.max(0,w-Se()),K=()=>Se()>=w,a=()=>{const h=Se(),$=w;return h===0?`Δεν έχουν γίνει αναθέσεις ακόμα. Απαιτούνται ${$} αναθέσεις.`:h<$?`Έχουν γίνει ${h} από ${$} απαιτούμενες αναθέσεις. Απομένουν ${$-h}.`:"✅ Ολοκληρώθηκαν όλες οι αναθέσεις! Ο χρήστης θα λάβει ενημέρωση για το πρόγραμμά του."},V=()=>[{value:null,label:"Όλες οι ημέρες"},{value:1,label:"Δευτέρα"},{value:2,label:"Τρίτη"},{value:3,label:"Τετάρτη"},{value:4,label:"Πέμπτη"},{value:5,label:"Παρασκευή"},{value:6,label:"Σάββατο"}],Q=h=>h.isFull?"bg-red-100 border-red-300 text-red-700":h.availableSpots<=1?"bg-yellow-100 border-yellow-300 text-yellow-700":"bg-green-100 border-green-300 text-green-700",be=h=>N.some($=>$.groupIdentifier===h.groupIdentifier);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ve,{className:"h-6 w-6 text-blue-600"}),e.jsxs("h3",{className:"text-xl font-bold text-blue-800",children:["Ανάθεση Ομαδικών Θέσεων - ",o.firstName," ",o.lastName]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:K()?e.jsxs("div",{className:"flex items-center space-x-2 bg-green-100 px-3 py-1 rounded-full",children:[e.jsx(Xt,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Ολοκληρώθηκε"})]}):e.jsxs("div",{className:"flex items-center space-x-2 bg-orange-100 px-3 py-1 rounded-full",children:[e.jsx(tr,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Σε εξέλιξη"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Στόχος Εβδομάδας"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Τρέχουσες Αναθέσεις"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Se()})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Υπολείπονται"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:le()})]})]}),e.jsx("div",{className:`mt-4 p-4 rounded-lg ${K()?"bg-green-50 border border-green-200":"bg-blue-50 border border-blue-200"}`,children:e.jsx("p",{className:`text-sm font-medium ${K()?"text-green-700":"text-blue-700"}`,children:a()})})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Φίλτρο Σεσιών:"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>re("new"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${ee==="new"?"bg-blue-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"🆕 Νέες Σεσίες"}),e.jsxs("button",{onClick:()=>{re("existing"),o!=null&&o.id&&X(o.id)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${ee==="existing"?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:["📚 Υπάρχουσες Σεσίες",n&&e.jsx("span",{className:"ml-2",children:"⏳"})]})]}),ee==="existing"&&m.length>0&&e.jsxs("div",{className:"text-sm text-green-600 bg-green-100 px-3 py-1 rounded-lg",children:["✅ ",m.length," υπάρχουσες σεσίες φορτώθηκαν"]}),ee==="existing"&&m.length===0&&!n&&e.jsx("div",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-lg",children:"ℹ️ Δεν βρέθηκαν υπάρχουσες σεσίες"})]})}),N.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Me,{className:"h-5 w-5 mr-2 text-blue-600"}),"Τρέχουσες Αναθέσεις"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(h=>e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-blue-800",children:[Qt(h.dayOfWeek)," - ",al(h.groupType)]}),e.jsxs("div",{className:"text-sm text-blue-600",children:[Ys(h.startTime)," - ",Ys(h.endTime)]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["Προπονητής: ",h.trainer]})]}),e.jsx("button",{onClick:()=>Pe(h.id),className:"text-red-600 hover:text-red-800 p-1",title:"Αφαίρεση ανάθεσης",children:e.jsx(et,{className:"h-4 w-4"})})]}),h.notes&&e.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Σημειώσεις: ",h.notes]})]},h.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx($t,{className:"h-5 w-5 mr-2 text-green-600"}),"Διαθέσιμες Ομαδικές Θέσεις"]}),e.jsx("select",{value:te||"",onChange:h=>{const $=h.target.value?parseInt(h.target.value):null;ie($),g()},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:V().map(h=>e.jsx("option",{value:h.value||"",children:h.label},h.value||"all"))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(h=>{const $=be(h),H=!$&&!h.isFull&&!K();return e.jsxs("div",{className:`rounded-lg p-4 border-2 cursor-pointer transition-all ${(T==null?void 0:T.id)===h.id?"border-blue-500 bg-blue-50":`border-gray-200 hover:border-gray-300 ${Q(h)}`} ${H?"":"opacity-60"}`,onClick:()=>H&&v(h),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800",children:Qt(h.dayOfWeek)}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center mt-1",children:[e.jsx(st,{className:"h-4 w-4 mr-1"}),Ys(h.startTime)," - ",Ys(h.endTime)]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center mt-1",children:[e.jsx(il,{className:"h-4 w-4 mr-1"}),h.trainer," - ",h.room]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:al(h.groupType)}),e.jsxs("div",{className:"text-xs text-gray-600",children:[h.currentAssignments,"/",h.maxCapacity]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.isFull?"bg-red-100 text-red-800":h.availableSpots<=1?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:h.isFull?"Πλήρες":`${h.availableSpots} διαθέσιμες`})}),$&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"Ανατεθειμένο"})]})]},h.id)})})]}),T&&!K()&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Ct,{className:"h-5 w-5 mr-2 text-green-600"}),"Ανάθεση στη θέση: ",Qt(T.dayOfWeek)," - ",Ys(T.startTime)]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Σημειώσεις (προαιρετικό)"}),e.jsx("textarea",{value:W,onChange:h=>L(h.target.value),placeholder:"Προσθέστε σημειώσεις για αυτή την ανάθεση...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),je.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Τρέχοντα μέλη αυτής της ομάδας:"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:je.map(h=>{var $,H;return e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["• ",($=h.userInfo)==null?void 0:$.first_name," ",(H=h.userInfo)==null?void 0:H.last_name]},h.id)})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:Z,disabled:I,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),I?"Δημιουργία...":"Δημιουργία Ανάθεσης"]}),e.jsx("button",{onClick:()=>fe(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Ακύρωση"})]})]})]}),K()&&e.jsx("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(Xt,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Οι αναθέσεις ολοκληρώθηκαν!"}),e.jsxs("p",{className:"text-green-600",children:["Ο χρήστης έχει ανατεθεί σε ",Se()," ομαδικές θέσεις αυτή την εβδομάδα."]})]})]})})]})},xo=async o=>{if(!o||o==="undefined"||o==="00000000-0000-0000-0000-000000000001")try{const{data:p,error:w}=await D.from("user_profiles").select("user_id").eq("role","admin").limit(1).single();return w||!p?(console.error("No admin user found:",w),null):p.user_id}catch(p){return console.error("Error getting admin user:",p),null}return o},go=({ultimateRequests:o,ultimateLoading:p,ultimateSearchTerm:w,setUltimateSearchTerm:A,selectedRequestOptions:P,handleRequestOptionChange:M,updateInstallmentAmounts:N,deleteUltimateRequest:z,loadUltimateRequests:te,handleApproveRequest:ie,handleRejectRequest:T,loading:fe,requestProgramApprovalStatus:je,handleRequestProgramApprovalChange:ue,handleSaveRequestProgramOptions:I,handleUnfreezeRequestProgramOptions:me,requestPendingUsers:W,requestFrozenOptions:L,ultimateRequestFrozenWithPending:we})=>{const{user:Ue}=dl(),[ee,re]=At.useState(1),m=50,ve=100,[n,_e]=At.useState(!1),[ae,X]=At.useState(null),g=()=>{const a=o.filter(V=>{var be,h,$;return w===""||`${((be=V.user)==null?void 0:be.first_name)||""} ${((h=V.user)==null?void 0:h.last_name)||""}`.toLowerCase().includes(w.toLowerCase())||((($=V.user)==null?void 0:$.email)||"").toLowerCase().includes(w.toLowerCase())});if(a.length>ve){const V=(ee-1)*m,Q=V+m;return a.slice(V,Q)}return a},he=()=>o.filter(a=>{var Q,be,h;return w===""||`${((Q=a.user)==null?void 0:Q.first_name)||""} ${((be=a.user)==null?void 0:be.last_name)||""}`.toLowerCase().includes(w.toLowerCase())||(((h=a.user)==null?void 0:h.email)||"").toLowerCase().includes(w.toLowerCase())}).length,u=()=>{const a=he();return Math.ceil(a/m)},se=()=>he()>ve,v=a=>W.has(a),Z=a=>L[a]||{},Pe=(a,V)=>{X({requestId:a,installmentNumber:V}),_e(!0)},Se=async()=>{if(ae){const{requestId:a,installmentNumber:V}=ae;try{console.log(`[AdminUltimateInstallmentsTab] Locking installment ${V} for request ${a}`);const Q=o.find(J=>J.id===a);if(Q){const J=P[a]||{},de={};V===1?(de.installment_1_amount=parseFloat(String(J.installment1Amount||Q.installment_1_amount||0)).toString(),de.installment_1_payment_method=J.installment1PaymentMethod||Q.installment_1_payment_method||"cash",de.installment_1_due_date=J.installment1DueDate||Q.installment_1_due_date):V===2?(de.installment_2_amount=parseFloat(String(J.installment2Amount||Q.installment_2_amount||0)).toString(),de.installment_2_payment_method=J.installment2PaymentMethod||Q.installment_2_payment_method||"cash",de.installment_2_due_date=J.installment2DueDate||Q.installment_2_due_date):V===3&&(de.installment_3_amount=parseFloat(String(J.installment3Amount||Q.installment_3_amount||0)).toString(),de.installment_3_payment_method=J.installment3PaymentMethod||Q.installment_3_payment_method||"cash",de.installment_3_due_date=J.installment3DueDate||Q.installment_3_due_date);const{error:Fe}=await D.from("ultimate_membership_requests").update(de).eq("id",a);if(Fe){console.error("[AdminUltimateInstallmentsTab] Error saving values before lock:",Fe),c.error("Σφάλμα κατά την αποθήκευση των τιμών");return}console.log("[AdminUltimateInstallmentsTab] Saved values before locking:",de)}const be=await xo(Ue==null?void 0:Ue.id);if(!be){console.error("[AdminUltimateInstallmentsTab] No valid user ID found for locking"),c.error("Σφάλμα: Δεν βρέθηκε έγκυρο ID χρήστη για το κλείδωμα");return}const{error:h}=await D.rpc("lock_installment",{p_request_id:a,p_installment_number:V,p_locked_by:be});if(h){console.error(`[AdminUltimateInstallmentsTab] Error locking installment ${V}:`,h),c.error(`Σφάλμα κατά το κλείδωμα της ${V}ης δόσης`);return}console.log(`[AdminUltimateInstallmentsTab] Successfully locked installment ${V}`);const $=P[a]||{},H=o.find(J=>J.id===a);H&&(V===1?(M(a,"installment1Amount",$.installment1Amount||H.installment_1_amount||""),M(a,"installment1PaymentMethod",$.installment1PaymentMethod||H.installment_1_payment_method||"cash"),M(a,"installment1DueDate",$.installment1DueDate||H.installment_1_due_date)):V===2?(M(a,"installment2Amount",$.installment2Amount||H.installment_2_amount||""),M(a,"installment2PaymentMethod",$.installment2PaymentMethod||H.installment_2_payment_method||"cash"),M(a,"installment2DueDate",$.installment2DueDate||H.installment_2_due_date)):V===3&&(M(a,"installment3Amount",$.installment3Amount||H.installment_3_amount||""),M(a,"installment3PaymentMethod",$.installment3PaymentMethod||H.installment_3_payment_method||"cash"),M(a,"installment3DueDate",$.installment3DueDate||H.installment_3_due_date)));const De=`installment${V}Locked`;M(a,De,!0),c.success(`${V}η δόση κλειδώθηκε επιτυχώς με τις τρέχουσες τιμές`),await te()}catch(Q){console.error("[AdminUltimateInstallmentsTab] Exception locking installment:",Q),c.error("Σφάλμα κατά το κλείδωμα της δόσης")}_e(!1),X(null)}},le=()=>{_e(!1),X(null)},K=(a,V)=>{const Q=`installment_${V}_locked`,be=a[Q]===!0;return console.log(`[AdminUltimateInstallmentsTab] isInstallmentLocked check for request ${a.id}, installment ${V}: locked = ${be}, field = ${Q}, value = ${a[Q]}`),be};return At.useEffect(()=>{re(1)},[w]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-4xl mr-3",children:"👑"}),"Ultimate Συνδρομές"]}),e.jsx("p",{className:"text-gray-300 mt-2 text-lg",children:"Διαχείριση αιτημάτων για πακέτα Ultimate με και χωρίς δόσεις"})]}),e.jsxs("button",{onClick:te,disabled:p,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105 font-medium",children:[p?e.jsx(qs,{className:"h-5 w-5 animate-spin"}):e.jsx(Be,{className:"h-5 w-5"}),e.jsx("span",{children:"Ανανέωση"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-2xl shadow-lg border border-gray-600 p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-blue-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"🔍 Αναζήτηση με όνομα χρήστη ή email...",value:w,onChange:a=>A(a.target.value),className:"w-full pl-12 pr-4 py-4 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400 text-lg font-medium"})]})}),w&&e.jsx("button",{onClick:()=>A(""),className:"px-4 py-4 text-gray-400 hover:text-white transition-colors bg-gray-600 rounded-xl hover:bg-gray-500",children:e.jsx(Ke,{className:"h-5 w-5"})})]})}),se()&&!p&&e.jsx("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-2xl shadow-lg border border-gray-600 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-white font-medium",children:["Σελίδα ",ee," από ",u()," • Σύνολο: ",he()," αιτήματα"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>re(1),disabled:ee===1,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Πρώτη"}),e.jsx("button",{onClick:()=>re(a=>Math.max(a-1,1)),disabled:ee===1,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Προηγούμενη"}),e.jsxs("span",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium",children:[ee," / ",u()]}),e.jsx("button",{onClick:()=>re(a=>Math.min(a+1,u())),disabled:ee===u(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Επόμενη"}),e.jsx("button",{onClick:()=>re(u()),disabled:ee===u(),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Τελευταία"})]})]})}),p?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx(qs,{className:"h-12 w-12 animate-spin text-blue-400 mx-auto mb-4"}),e.jsx("span",{className:"text-gray-300 font-medium text-lg",children:"Φόρτωση Ultimate αιτημάτων..."})]})}):g().length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-full p-6 w-24 h-24 mx-auto mb-6 shadow-2xl",children:e.jsx(cl,{className:"h-12 w-12 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:w?"🔍 Δεν βρέθηκαν αποτελέσματα":"👑 Δεν υπάρχουν Ultimate αιτήματα"}),e.jsx("p",{className:"text-gray-300 text-lg",children:w?"Δοκιμάστε διαφορετικό όνομα για την αναζήτηση.":"Όταν οι χρήστες υποβάλουν αιτήματα για το πακέτο Ultimate, θα εμφανίζονται εδώ."})]}):e.jsx("div",{className:"grid gap-8",children:g().map(a=>{var V,Q,be,h,$,H,De,J,de,Fe,Ps,xs,gs,us,hs,Ss,bs,ks,tt,As,$s,ts,E,Ge,Oe,rt,at,lt,ze,nt,Cs,Ms,rs,ot,as,it,ls,ns,ps,ke,os,We,Us,fs;return e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl shadow-2xl border border-gray-600 p-8 hover:shadow-3xl transition-all duration-300 transform hover:scale-102",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-6 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-start space-x-6",children:[e.jsxs("div",{className:"relative",children:[(V=a.user)!=null&&V.profile_photo?e.jsxs("div",{className:"w-16 h-16 rounded-2xl overflow-hidden shadow-2xl border-3 border-blue-400",children:[e.jsx("img",{src:a.user.profile_photo,alt:`${(Q=a.user)==null?void 0:Q.first_name} ${(be=a.user)==null?void 0:be.last_name}`,className:"w-full h-full object-cover",onError:S=>{S.currentTarget.style.display="none";const Ie=S.currentTarget.nextElementSibling;Ie&&(Ie.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center hidden",children:e.jsx(Ve,{className:"h-8 w-8 text-white"})})]}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-2xl",children:e.jsx(Ve,{className:"h-8 w-8 text-white"})}),a.status==="pending"&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full border-2 border-white shadow-lg animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h4",{className:"text-2xl font-bold text-white mb-2",children:[(h=a.user)==null?void 0:h.first_name," ",($=a.user)==null?void 0:$.last_name]}),e.jsxs("p",{className:"text-gray-300 mb-3 flex items-center text-lg",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),(H=a.user)==null?void 0:H.email]}),e.jsxs("div",{className:"flex items-center space-x-3 flex-wrap",children:[e.jsx("span",{className:"inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",children:"👑 Ultimate Package"}),e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsx("span",{className:"text-gray-200 font-medium",children:qt(a.duration_type)}),a.has_installments&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-xl text-sm font-medium bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg",children:"💳 Με Δόσεις"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-green-400 to-green-500 bg-clip-text text-transparent mb-2",children:Re(a.requested_price)}),e.jsxs("div",{className:"text-gray-300 flex items-center justify-end",children:[e.jsx(Me,{className:"h-4 w-4 mr-2 text-blue-400"}),e.jsx("span",{className:"font-medium",children:new Date(a.created_at).toLocaleDateString("el-GR")})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3",children:[a.status==="pending"&&(Z(a.id)&&Object.keys(Z(a.id)||{}).length>0?e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("button",{onClick:()=>ie(a.id),disabled:fe,className:"px-8 py-4 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-2xl hover:from-green-700 hover:to-green-800 transition-all duration-200 text-lg font-bold shadow-2xl hover:shadow-3xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 transform hover:scale-110",children:[e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"✅ Εγκρίνω Συνδρομή"})]}),e.jsxs("button",{onClick:()=>T(a.id),disabled:fe,className:"px-8 py-4 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-2xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-lg font-bold shadow-2xl hover:shadow-3xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 transform hover:scale-110",children:[e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{children:"❌ Απορρίπτω Συνδρομή"})]})]}):e.jsx("div",{className:"max-w-[340px] text-right",children:e.jsxs("div",{className:"inline-flex items-start bg-yellow-500/10 border border-yellow-500/30 text-yellow-200 rounded-xl px-3 py-2 text-sm",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),e.jsx("span",{children:"Για να ενεργοποιηθούν τα κουμπιά «Εγκρίνω Συνδρομή / Απορρίπτω Συνδρομή», εκτελέστε πρώτα ενέργεια πληρωμής (Έγκριση/Απόρριψη/Αναμονή) και πατήστε «Αποθήκευση Program Options»."})]})})),a.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-green-500/20 to-green-600/20 rounded-xl p-3 border border-green-500/30",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl text-sm font-bold shadow-lg",children:"✅ Εγκεκριμένο"})]}),a.status==="rejected"&&e.jsxs("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-red-500/20 to-red-600/20 rounded-xl p-3 border border-red-500/30",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full animate-pulse"}),e.jsx("span",{className:"px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl text-sm font-bold shadow-lg",children:"❌ Απορριφθέν"})]}),e.jsxs("button",{onClick:()=>{window.confirm("Είστε σίγουροι ότι θέλετε να διαγράψετε αυτό το Ultimate αίτημα; Αυτή η ενέργεια δεν μπορεί να αναιρεθεί.")&&z(a.id)},className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-sm font-medium flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx("span",{children:"🗑️ Διαγραφή"})]})]})]})]}),a.has_installments&&e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-500/20 to-blue-600/20 rounded-2xl p-6 border border-blue-500/30 shadow-xl",children:[e.jsxs("h4",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"text-3xl mr-3",children:"💳"}),"Διαχείριση Δόσεων"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"1️⃣"}),"1η Δόση"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:((De=P[a.id])==null?void 0:De.installment1Amount)||a.installment_1_amount||"",onChange:S=>M(a.id,"installment1Amount",S.target.value),placeholder:"Ποσό",disabled:K(a,1),className:`w-full p-4 border rounded-xl focus:ring-2 text-white placeholder-gray-400 text-lg font-medium ${K(a,1)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200 placeholder-orange-300":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`}),e.jsxs("select",{value:((J=P[a.id])==null?void 0:J.installment1PaymentMethod)||a.installment_1_payment_method||"cash",onChange:S=>M(a.id,"installment1PaymentMethod",S.target.value),disabled:K(a,1),className:`w-full p-4 border rounded-xl focus:ring-2 text-white text-lg font-medium ${K(a,1)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((de=P[a.id])==null?void 0:de.installment1DueDate)||a.installment_1_due_date||"",onChange:S=>M(a.id,"installment1DueDate",S.target.value),disabled:K(a,1),className:`w-full p-3 border rounded-xl focus:ring-2 focus:border-blue-500 text-white ${K(a,1)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500"}`})]}),e.jsx("div",{className:"flex items-center space-x-3 pt-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:K(a,1),onChange:()=>Pe(a.id,1),className:"w-4 h-4 text-orange-600 bg-gray-800 border-gray-600 rounded focus:ring-orange-500 focus:ring-2"}),e.jsxs("span",{className:"text-sm text-gray-300 flex items-center space-x-1",children:[e.jsx(ss,{className:"h-3 w-3"}),e.jsx("span",{children:"Κλείδωμα Δόσης"})]})]})}),K(a,1)&&e.jsxs("div",{className:"mt-3 p-3 bg-orange-500/20 border border-orange-500/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ss,{className:"h-4 w-4 text-orange-400"}),e.jsx("span",{className:"text-sm font-bold text-orange-300",children:"Κλειδωμένες Τιμές"})]}),e.jsxs("div",{className:"space-y-1 text-xs text-orange-200",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💰 Ποσό:"})," ",Re(a.installment_1_amount||0)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💳 Τρόπος Πληρωμής:"})," ",a.installment_1_payment_method==="cash"?"💰 Μετρητά":"💳 POS"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"📅 Ημερομηνία:"})," ",a.installment_1_due_date||"Δεν ορίστηκε"]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"2️⃣"}),"2η Δόση"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:((Fe=P[a.id])==null?void 0:Fe.installment2Amount)||a.installment_2_amount||"",onChange:S=>M(a.id,"installment2Amount",S.target.value),placeholder:"Ποσό",disabled:K(a,2),className:`w-full p-4 border rounded-xl focus:ring-2 text-white placeholder-gray-400 text-lg font-medium ${K(a,2)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200 placeholder-orange-300":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`}),e.jsxs("select",{value:((Ps=P[a.id])==null?void 0:Ps.installment2PaymentMethod)||a.installment_2_payment_method||"cash",onChange:S=>M(a.id,"installment2PaymentMethod",S.target.value),disabled:K(a,2),className:`w-full p-4 border rounded-xl focus:ring-2 text-white text-lg font-medium ${K(a,2)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((xs=P[a.id])==null?void 0:xs.installment2DueDate)||a.installment_2_due_date||"",onChange:S=>M(a.id,"installment2DueDate",S.target.value),disabled:K(a,2),className:`w-full p-3 border rounded-xl focus:ring-2 focus:border-blue-500 text-white ${K(a,2)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500"}`})]}),e.jsx("div",{className:"flex items-center space-x-3 pt-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:K(a,2),onChange:()=>Pe(a.id,2),className:"w-4 h-4 text-orange-600 bg-gray-800 border-gray-600 rounded focus:ring-orange-500 focus:ring-2"}),e.jsxs("span",{className:"text-sm text-gray-300 flex items-center space-x-1",children:[e.jsx(ss,{className:"h-3 w-3"}),e.jsx("span",{children:"Κλείδωμα Δόσης"})]})]})}),K(a,2)&&e.jsxs("div",{className:"mt-3 p-3 bg-orange-500/20 border border-orange-500/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ss,{className:"h-4 w-4 text-orange-400"}),e.jsx("span",{className:"text-sm font-bold text-orange-300",children:"Κλειδωμένες Τιμές"})]}),e.jsxs("div",{className:"space-y-1 text-xs text-orange-200",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💰 Ποσό:"})," ",Re(a.installment_2_amount||0)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💳 Τρόπος Πληρωμής:"})," ",a.installment_2_payment_method==="cash"?"💰 Μετρητά":"💳 POS"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"📅 Ημερομηνία:"})," ",a.installment_2_due_date||"Δεν ορίστηκε"]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsx("label",{className:"block text-lg font-bold text-white mb-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"3️⃣"}),"3η Δόση"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"number",value:((gs=P[a.id])==null?void 0:gs.installment3Amount)||a.installment_3_amount||"",onChange:S=>M(a.id,"installment3Amount",S.target.value),placeholder:"Ποσό",disabled:K(a,3),className:`w-full p-4 border rounded-xl focus:ring-2 text-white placeholder-gray-400 text-lg font-medium ${K(a,3)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200 placeholder-orange-300":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`}),e.jsxs("select",{value:((us=P[a.id])==null?void 0:us.installment3PaymentMethod)||a.installment_3_payment_method||"cash",onChange:S=>M(a.id,"installment3PaymentMethod",S.target.value),disabled:K(a,3),className:`w-full p-4 border rounded-xl focus:ring-2 text-white text-lg font-medium ${K(a,3)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"📅 Ημερομηνία Πληρωμής"]}),e.jsx("input",{type:"date",value:((hs=P[a.id])==null?void 0:hs.installment3DueDate)||a.installment_3_due_date||"",onChange:S=>M(a.id,"installment3DueDate",S.target.value),disabled:K(a,3),className:`w-full p-3 border rounded-xl focus:ring-2 focus:border-blue-500 text-white ${K(a,3)?"border-orange-500 bg-orange-500/20 focus:ring-orange-500 cursor-not-allowed text-orange-200":"border-gray-600 bg-gray-800 focus:ring-blue-500"}`})]}),e.jsx("div",{className:"flex items-center space-x-3 pt-2",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:K(a,3),onChange:()=>Pe(a.id,3),className:"w-4 h-4 text-orange-600 bg-gray-800 border-gray-600 rounded focus:ring-orange-500 focus:ring-2"}),e.jsxs("span",{className:"text-sm text-gray-300 flex items-center space-x-1",children:[e.jsx(ss,{className:"h-3 w-3"}),e.jsx("span",{children:"Κλείδωμα Δόσης"})]})]})}),K(a,3)&&e.jsxs("div",{className:"mt-3 p-3 bg-orange-500/20 border border-orange-500/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ss,{className:"h-4 w-4 text-orange-400"}),e.jsx("span",{className:"text-sm font-bold text-orange-300",children:"Κλειδωμένες Τιμές"})]}),e.jsxs("div",{className:"space-y-1 text-xs text-orange-200",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💰 Ποσό:"})," ",Re(a.installment_3_amount||0)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"💳 Τρόπος Πληρωμής:"})," ",a.installment_3_payment_method==="cash"?"💰 Μετρητά":"💳 POS"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"📅 Ημερομηνία:"})," ",a.installment_3_due_date||"Δεν ορίστηκε"]})]})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-500/30 to-blue-600/30 rounded-2xl border border-blue-500/50 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-blue-300 text-lg",children:"💰 Σύνολο Δόσεων:"}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-green-400 to-green-500 bg-clip-text text-transparent",children:Re(Number(((Ss=P[a.id])==null?void 0:Ss.installment1Amount)||a.installment_1_amount||0)+Number(((bs=P[a.id])==null?void 0:bs.installment2Amount)||a.installment_2_amount||0)+Number(((ks=P[a.id])==null?void 0:ks.installment3Amount)||a.installment_3_amount||0))})]}),e.jsxs("div",{className:"text-blue-200 mt-2 font-medium",children:["📊 Από ",Re(a.requested_price)," (Πακέτο Ultimate)"]})]})]}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-6 border border-purple-500/30 shadow-xl",children:[e.jsxs("h4",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"text-3xl mr-3",children:"⚙️"}),"Program Options"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>{var S;v(a.id)||M(a.id,"oldMembers",!((S=P[a.id])!=null&&S.oldMembers))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${v(a.id)?(tt=Z(a.id))!=null&&tt.oldMembers?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(As=P[a.id])!=null&&As.oldMembers?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:v(a.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"👴 Παλαιά μέλη"}),(v(a.id)?($s=Z(a.id))==null?void 0:$s.oldMembers:(ts=P[a.id])==null?void 0:ts.oldMembers)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),v(a.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-700 to-gray-800 rounded-2xl p-5 border border-gray-600 shadow-lg",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🏋️‍♂️"}),"Kettlebell Points",v(a.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",value:v(a.id)?((E=Z(a.id))==null?void 0:E.kettlebellPoints)||"":((Ge=P[a.id])==null?void 0:Ge.kettlebellPoints)||"",onChange:S=>{v(a.id)||M(a.id,"kettlebellPoints",S.target.value)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${v(a.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-purple-500 focus:border-purple-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε αριθμό...",disabled:v(a.id)})]}),e.jsx("button",{type:"button",onClick:()=>{var S;v(a.id)||M(a.id,"cash",!((S=P[a.id])!=null&&S.cash))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${v(a.id)?(Oe=Z(a.id))!=null&&Oe.cash?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(rt=P[a.id])!=null&&rt.cash?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:v(a.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"💰 Μετρητά"}),(v(a.id)?(at=Z(a.id))==null?void 0:at.cash:(lt=P[a.id])==null?void 0:lt.cash)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),v(a.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})}),e.jsx("button",{type:"button",onClick:()=>{var S;v(a.id)||M(a.id,"pos",!((S=P[a.id])!=null&&S.pos))},className:`w-full px-6 py-4 rounded-2xl font-bold transition-all duration-200 shadow-2xl transform hover:scale-105 text-lg ${v(a.id)?(ze=Z(a.id))!=null&&ze.pos?"bg-gradient-to-r from-green-600 to-green-700 text-white cursor-not-allowed border-2 border-yellow-400":"bg-gradient-to-r from-gray-600 to-gray-700 text-gray-300 cursor-not-allowed border-2 border-yellow-400":(nt=P[a.id])!=null&&nt.pos?"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800 border-2 border-green-400":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 border-2 border-blue-400"}`,disabled:v(a.id),children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"💳 POS"}),(v(a.id)?(Cs=Z(a.id))==null?void 0:Cs.pos:(Ms=P[a.id])==null?void 0:Ms.pos)&&e.jsx("span",{className:"text-green-200 text-xl",children:"✓"}),v(a.id)&&e.jsx("span",{className:"text-yellow-400",children:"🔒"})]})})]}),(((rs=P[a.id])==null?void 0:rs.cash)||((ot=Z(a.id))==null?void 0:ot.cash))&&e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-green-500/20 to-green-600/20 rounded-2xl p-5 border border-green-500/30",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💰"}),"Ποσό Μετρητών (€)",v(a.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:v(a.id)?((it=(as=Z(a.id))==null?void 0:as.cashAmount)==null?void 0:it.toString())||"":((ns=(ls=P[a.id])==null?void 0:ls.cashAmount)==null?void 0:ns.toString())||"",onChange:S=>{v(a.id)||M(a.id,"cashAmount",parseFloat(S.target.value)||0)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${v(a.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-green-500 focus:border-green-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε ποσό σε €...",disabled:v(a.id)}),e.jsx("button",{onClick:()=>{var Ie,He;const S=v(a.id)?(Ie=Z(a.id))==null?void 0:Ie.cashAmount:(He=P[a.id])==null?void 0:He.cashAmount;S&&parseFloat(S.toString())>0?c.success(`💰 Μετρητά €${S} επιλέχθηκαν!`):c.success("💰 Μετρητά μηδενίστηκαν!")},disabled:v(a.id),className:`mt-3 w-full px-4 py-3 text-sm rounded-xl font-medium transition-colors ${v(a.id)?"bg-yellow-500/50 text-yellow-200 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:"✓ Επιλογή Μετρητά"})]}),(((ps=P[a.id])==null?void 0:ps.pos)||((ke=Z(a.id))==null?void 0:ke.pos))&&e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-blue-500/20 to-blue-600/20 rounded-2xl p-5 border border-blue-500/30",children:[e.jsxs("label",{className:"block text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💳"}),"Ποσό POS (€)",v(a.id)&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:v(a.id)?((We=(os=Z(a.id))==null?void 0:os.posAmount)==null?void 0:We.toString())||"":((fs=(Us=P[a.id])==null?void 0:Us.posAmount)==null?void 0:fs.toString())||"",onChange:S=>{v(a.id)||M(a.id,"posAmount",parseFloat(S.target.value)||0)},className:`w-full px-4 py-4 border rounded-xl focus:outline-none focus:ring-2 text-lg font-medium ${v(a.id)?"border-yellow-500 bg-yellow-500/20 focus:ring-yellow-500 cursor-not-allowed text-yellow-200 placeholder-yellow-300":"border-gray-600 bg-gray-800 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400"}`,placeholder:"Εισάγετε ποσό σε €...",disabled:v(a.id)}),e.jsx("button",{onClick:()=>{var Ie,He;const S=v(a.id)?(Ie=Z(a.id))==null?void 0:Ie.posAmount:(He=P[a.id])==null?void 0:He.posAmount;S&&parseFloat(S.toString())>0?c.success(`💳 POS €${S} επιλέχθηκε!`):c.success("💳 POS μηδενίστηκε!")},disabled:v(a.id),className:`mt-3 w-full px-4 py-3 text-sm rounded-xl font-medium transition-colors ${v(a.id)?"bg-yellow-500/50 text-yellow-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:"✓ Επιλογή POS"})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-4",children:[!Z(a.id)&&e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"inline-flex items-start bg-blue-500/10 border border-blue-500/30 text-blue-200 rounded-xl px-3 py-2 text-sm",children:[e.jsx("span",{className:"mr-2",children:"ℹ️"}),e.jsx("span",{children:"Επιλέξτε μια κατάσταση πληρωμής (Έγκριση/Απόρριψη/Αναμονή) και πατήστε «Αποθήκευση Program Options»."})]})}),Z(a.id)&&e.jsx("button",{onClick:()=>ue(a.id,"approved"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${je[a.id]==="approved"?"bg-gradient-to-r from-green-600 to-green-700 text-white border-2 border-green-400":"bg-gradient-to-r from-green-500/20 to-green-600/20 text-green-300 border-2 border-green-500/30 hover:from-green-500/30 hover:to-green-600/30"}`,children:"✅ Έγκριση Πληρωμής"}),Z(a.id)&&e.jsx("button",{onClick:()=>ue(a.id,"rejected"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${je[a.id]==="rejected"?"bg-gradient-to-r from-red-600 to-red-700 text-white border-2 border-red-400":"bg-gradient-to-r from-red-500/20 to-red-600/20 text-red-300 border-2 border-red-500/30 hover:from-red-500/30 hover:to-red-600/30"}`,children:"❌ Απόρριψη Πληρωμής"}),e.jsx("button",{onClick:()=>ue(a.id,"pending"),className:`px-6 py-3 rounded-2xl text-lg font-bold transition-all duration-200 shadow-xl transform hover:scale-105 ${je[a.id]==="pending"?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white border-2 border-yellow-400":"bg-gradient-to-r from-yellow-500/20 to-yellow-600/20 text-yellow-300 border-2 border-yellow-500/30 hover:from-yellow-500/30 hover:to-yellow-600/30"}`,children:"⏳ Αναμονή/Πάγωμα Πληρωμής"}),e.jsxs("button",{onClick:()=>I(a.id),disabled:fe||je[a.id]==="none",className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-2xl hover:from-purple-700 hover:to-purple-800 transition-all duration-200 text-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center shadow-2xl hover:shadow-3xl transform hover:scale-105",children:[fe?e.jsx(qs,{className:"h-5 w-5 animate-spin mr-2"}):e.jsx(Zs,{className:"h-5 w-5 mr-2"}),"💾 Αποθήκευση Program Options"]}),Z(a.id)&&we.has(a.id)&&e.jsxs("button",{onClick:()=>me(a.id),className:"px-6 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-2xl hover:from-orange-700 hover:to-orange-800 transition-all duration-200 text-lg font-bold flex items-center shadow-2xl hover:shadow-3xl transform hover:scale-105",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"🔓 ΞΕΠΑΓΩΜΑ"]})]})]})]},a.id)})}),n&&ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 max-w-md mx-4 border border-gray-600 shadow-2xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ss,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"🔒 Κλείδωμα Δόσης"}),e.jsxs("p",{className:"text-gray-300 mb-6 text-lg",children:["Do you confirm locking installment ",ae.installmentNumber,"?"]}),e.jsx("p",{className:"text-gray-400 mb-8 text-sm",children:"Μόλις κλειδώσετε αυτή τη δόση, δεν θα μπορείτε πλέον να επεξεργαστείτε το ποσό ή την ημερομηνία πληρωμής."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:le,className:"flex-1 px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:"❌ Cancel"}),e.jsxs("button",{onClick:Se,className:"flex-1 px-6 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-xl hover:from-orange-700 hover:to-orange-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl flex items-center justify-center space-x-2",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:"✅ Yes, Lock"})]})]})]})})})]})},uo=()=>{const[o,p]=d.useState(""),[w,A]=d.useState([]),[P,M]=d.useState([]),[N,z]=d.useState(null),[te,ie]=d.useState(!1),[T,fe]=d.useState(!1),[je,ue]=d.useState(!1),[I,me]=d.useState(1),[W,L]=d.useState(1),[we,Ue]=d.useState(0),ee=10,re=async(u=1)=>{try{ie(!0);const[se,v]=await Promise.all([On(u,ee),Rn()]);M(se),Ue(v),L(Math.ceil(v/ee)),me(u)}catch(se){console.error("Error loading random users:",se),c.error("Σφάλμα κατά τη φόρτωση των χρηστών")}finally{ie(!1)}};d.useEffect(()=>{re(1)},[]);const m=async u=>{if(p(u),!u.trim()){A([]);return}try{fe(!0);const se=await Gn(u);A(se)}catch(se){console.error("Error searching users:",se),c.error("Σφάλμα κατά την αναζήτηση")}finally{fe(!1)}},ve=async u=>{try{ue(!0);const se=await zn(u);z(se)}catch(se){console.error("Error loading user details:",se),c.error("Σφάλμα κατά τη φόρτωση των λεπτομερειών χρήστη")}finally{ue(!1)}},n=()=>{I>1&&re(I-1)},_e=()=>{I<W&&re(I+1)},ae=()=>{p(""),A([])},X=u=>new Date(u).toLocaleDateString("el-GR",{year:"numeric",month:"long",day:"numeric"}),g=u=>new Intl.NumberFormat("el-GR",{style:"currency",currency:"EUR"}).format(u),he=o?w:P;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"👥 Χρήστες-Πληροφορίες"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Αναζήτηση και λεπτομέρειες χρηστών"})]}),e.jsxs("button",{onClick:()=>re(1),disabled:te,className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm disabled:opacity-50",children:[e.jsx(_s,{className:`h-4 w-4 ${te?"animate-spin":""}`}),e.jsx("span",{children:"🔄 Ανανέωση"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"🔍 Αναζήτηση με όνομα, email ή ID χρήστη...",value:o,onChange:u=>m(u.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-gray-900 placeholder-gray-500"})]})}),o&&e.jsx("button",{onClick:ae,className:"px-4 py-3 text-gray-400 hover:text-gray-600 transition-colors bg-gray-100 rounded-xl hover:bg-gray-200",children:e.jsx(Ke,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:o?`Αποτελέσματα αναζήτησης (${w.length})`:`Χρήστες (Σελίδα ${I} από ${W})`})}),te||T?e.jsx("div",{className:"p-8 text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500",children:[e.jsx(_s,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Φόρτωση χρηστών..."})]})}):he.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx($t,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν βρέθηκαν χρήστες"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:he.map(u=>{var se,v,Z,Pe,Se,le;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>ve(u.user_id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:[((v=(se=u.first_name)==null?void 0:se.trim())==null?void 0:v.charAt(0))||((Pe=(Z=u.email)==null?void 0:Z.trim())==null?void 0:Pe.charAt(0))||"?",((le=(Se=u.last_name)==null?void 0:Se.trim())==null?void 0:le.charAt(0))||""]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:[u.first_name&&u.first_name.trim().length>0?u.first_name:u.email||"Χρήστης"," ",u.last_name||""]}),e.jsx("p",{className:"text-gray-600",children:u.email||"—"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",u.user_id]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Εγγραφή: ",X(u.created_at)]}),e.jsx("button",{className:"mt-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:"Προβολή Λεπτομερειών"})]})]})},u.user_id)})}),!o&&W>1&&e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Εμφάνιση ",(I-1)*ee+1,"-",Math.min(I*ee,we)," από ",we," χρήστες"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:n,disabled:I===1,className:"flex items-center space-x-1 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx(ro,{className:"h-4 w-4"}),e.jsx("span",{children:"Προηγούμενη"})]}),e.jsxs("button",{onClick:_e,disabled:I===W,className:"flex items-center space-x-1 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx("span",{children:"Επόμενη"}),e.jsx(ao,{className:"h-4 w-4"})]})]})]})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Λεπτομέρειες Χρήστη"}),e.jsx("button",{onClick:()=>z(null),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Ke,{className:"h-6 w-6"})})]})}),je?e.jsx("div",{className:"p-8 text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500",children:[e.jsx(_s,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Φόρτωση λεπτομερειών..."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2"}),"Βασικές Πληροφορίες"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Όνομα"}),e.jsxs("p",{className:"font-medium",children:[N.user_info.first_name," ",N.user_info.last_name]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsxs("p",{className:"font-medium flex items-center",children:[e.jsx(Pn,{className:"h-4 w-4 mr-1"}),N.user_info.email]})]}),N.user_info.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Τηλέφωνο"}),e.jsxs("p",{className:"font-medium flex items-center",children:[e.jsx(Sn,{className:"h-4 w-4 mr-1"}),N.user_info.phone]})]}),N.user_info.date_of_birth&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ημερομηνία Γέννησης"}),e.jsxs("p",{className:"font-medium flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),X(N.user_info.date_of_birth)]})]}),N.user_info.address&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Διεύθυνση"}),e.jsxs("p",{className:"font-medium flex items-center",children:[e.jsx(il,{className:"h-4 w-4 mr-1"}),N.user_info.address]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Εγγραφή"}),e.jsxs("p",{className:"font-medium flex items-center",children:[e.jsx(st,{className:"h-4 w-4 mr-1"}),X(N.user_info.created_at)]})]}),N.user_info.referral_code&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Κωδικός Παραπομπής"}),e.jsx("p",{className:"font-medium font-mono",children:N.user_info.referral_code})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(kn,{className:"h-5 w-5 mr-2 text-green-600"}),"Ενεργές Συνδρομές (",N.active_memberships.length,")"]}),N.active_memberships.length===0?e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχουν ενεργές συνδρομές"}):e.jsx("div",{className:"space-y-3",children:N.active_memberships.map(u=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:u.package_name}),e.jsx("p",{className:"text-sm text-gray-600",children:u.credits_remaining>0?`${u.credits_remaining} / ${u.credits_total} credits`:"Credits not available"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[X(u.start_date)," - ",X(u.end_date)]}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Ενεργή"})]})]})},u.id))})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(st,{className:"h-5 w-5 mr-2 text-orange-600"}),"Εκκρεμή Αιτήματα Συνδρομών (",N.pending_requests.length,")"]}),N.pending_requests.length===0?e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχουν εκκρεμή αιτήματα συνδρομών"}):e.jsx("div",{className:"space-y-3",children:N.pending_requests.map(u=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:u.package_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Διάρκεια: ",u.duration_type," | Τιμή: €",u.requested_price,u.classes_count&&` | Μαθήματα: ${u.classes_count}`]}),u.has_installments&&e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:e.jsxs("p",{children:["Δόσεις: ",u.installment_1_amount&&`€${u.installment_1_amount}`,u.installment_2_amount&&`, €${u.installment_2_amount}`,u.installment_3_amount&&`, €${u.installment_3_amount}`]})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:X(u.created_at)}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"Εκκρεμές"})]})]})},u.id))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Fn,{className:"h-5 w-5 mr-2 text-blue-600"}),"Ιστορικό Συνδρομών (",N.all_memberships.length,")"]}),N.all_memberships.length===0?e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχει ιστορικό συνδρομών"}):e.jsx("div",{className:"space-y-3",children:N.all_memberships.map(u=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:u.package_name}),e.jsx("p",{className:"text-sm text-gray-600",children:u.credits_remaining>0?`${u.credits_remaining} / ${u.credits_total} credits`:"Credits not available"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[X(u.start_date)," - ",X(u.end_date)]}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${u.is_active?"bg-green-100 text-green-800":u.status==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:u.is_active?"Ενεργή":u.status})]})]})},u.id))})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(cl,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Ιστορικό Πληρωμών (",N.payment_history.length,")"]}),e.jsx("div",{className:"mb-4 p-4 bg-white rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["Συνολικό ποσό: ",g(N.total_paid)]})}),N.payment_history.length===0?e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχει ιστορικό πληρωμών"}):e.jsx("div",{className:"space-y-3",children:N.payment_history.map(u=>e.jsx("div",{className:"bg-white rounded-lg p-4 border border-yellow-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[g(u.amount)," ",u.currency]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u.payment_method&&`Μέθοδος: ${u.payment_method}`,u.transaction_id&&` | ID: ${u.transaction_id}`,u.notes&&` | ${u.notes}`]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:X(u.created_at)}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${u.status==="approved"?"bg-green-100 text-green-800":u.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:u.status})]})]})},u.id))})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Xs,{className:"h-5 w-5 mr-2 text-orange-600"}),"Kettlebell Points"]}),e.jsx("div",{className:"mb-4 p-4 bg-white rounded-lg border border-orange-200",children:e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[N.kettlebell_points.total_points," Points"]})}),N.kettlebell_points.points_history.length===0?e.jsx("p",{className:"text-gray-600",children:"Δεν υπάρχει ιστορικό points"}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:"Ιστορικό Points:"}),N.kettlebell_points.points_history.slice(0,10).map(u=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["+",u.points," points"]}),u.program_id&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Program ID: ",u.program_id]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:X(u.created_at)})]})},u.id)),N.kettlebell_points.points_history.length>10&&e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["... και ",N.kettlebell_points.points_history.length-10," ακόμα"]})]})]})]})]})})]})};class ho extends d.Component{constructor(){super(...arguments);kt(this,"state",{hasError:!1});kt(this,"handleRefresh",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0}),window.location.reload()});kt(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})})}static getDerivedStateFromError(w){return{hasError:!0,error:w}}componentDidCatch(w,A){console.error("ErrorBoundary caught an error:",w,A),this.setState({error:w,errorInfo:A}),console.error("Production error:",{error:w,errorInfo:A})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(tr,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Κάτι πήγε στραβά"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Παρουσιάστηκε ένα απροσδόκητο σφάλμα στην εφαρμογή. Παρακαλώ δοκιμάστε να ανανεώσετε τη σελίδα."}),!1,e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:this.handleReset,className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"Δοκιμή Ξανά"}),e.jsxs("button",{onClick:this.handleRefresh,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2",children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{children:"Ανανέωση Σελίδας"})]})]})]})}):this.props.children}}const nl=["Mike","Jordan"],bo=100,ol=async o=>{if(!o||o==="undefined"||o==="00000000-0000-0000-0000-000000000001")try{const{data:p,error:w}=await D.from("user_profiles").select("id").eq("role","admin").limit(1).single();return w||!p?(console.error("No admin user found:",w),null):p.id}catch(p){return console.error("Error getting admin user:",p),null}return o},To=()=>{var wr,vr,Nr,_r,Pr,Sr,kr,Ar,$r,Cr,Mr,Ur,Dr,Ir,Er,Tr,Lr,Fr,Or,Rr,Gr,zr,Kr,Vr,Br,Wr,Hr,Yr,Qr,Jr,Zr,Xr,qr;const{user:o}=dl(),[p,w]=d.useState("personal-training"),[A,P]=d.useState([]),[M,N]=d.useState([]),[z,te]=d.useState(1),[ie]=d.useState(10),[T,fe]=d.useState({"personal-training":!1,"membership-packages":!1,"ultimate-subscriptions":!1,"pilates-schedule":!1,"kettlebell-points":!1,"cash-register":!1,"users-information":!1}),je=d.useMemo(()=>{const s=(z-1)*ie,t=s+ie;return A.slice(s,t)},[A,z,ie]);Math.ceil(A.length/ie);const[ue]=d.useState(null),[I,me]=d.useState(null),[W,L]=d.useState(!1),[we,Ue]=d.useState(!1),[ee,re]=d.useState(!1),[m,ve]=d.useState({code:"",selectedUserId:""}),[n,_e]=d.useState("individual"),[ae,X]=d.useState("personal"),[g,he]=d.useState([]),[u,se]=d.useState(null),[v,Z]=d.useState(null),[Pe,Se]=d.useState(0),[le,K]=d.useState(1),[a,V]=d.useState(2),[Q,be]=d.useState(!1),[h,$]=d.useState(null),[H,De]=d.useState(null),[J,de]=d.useState({}),[Fe,Ps]=d.useState(""),[xs,gs]=d.useState("dropdown"),[us]=d.useState(""),[hs]=d.useState("all"),[Ss]=d.useState(!0),[bs,ks]=d.useState(new Set),[tt,As]=d.useState(new Set),[$s,ts]=d.useState(""),[E,Ge]=d.useState({}),[Oe,rt]=d.useState([]),[at,lt]=d.useState(0),[ze,nt]=d.useState(""),[Cs,Ms]=d.useState([]),[rs,ot]=d.useState(""),[as,it]=d.useState(""),[ls,ns]=d.useState(1),ps=10,[ke,os]=d.useState(""),[We,Us]=d.useState(""),[fs,S]=d.useState(null),[Ie,He]=d.useState("dropdown"),[dt,Mt]=d.useState(""),[Ye,ct]=d.useState(""),[Qe,mt]=d.useState(""),[ml,Ut]=d.useState(!1),[xl,Dt]=d.useState(!1),[Ne,xt]=d.useState("none"),[Ds,gl]=d.useState([]),[It,rr]=d.useState(!1),[ul,hl]=d.useState(""),[po,fo]=d.useState(!1),[yo,jo]=d.useState(1),[Et,ar]=d.useState(new Set),[Tt,lr]=d.useState({}),j=s=>Et.has(s),Ae=s=>Tt[s]||null,b=s=>bt.has(s),R=s=>pt[s]||null;d.useEffect(()=>{Se(v?v*4:0)},[v]),d.useEffect(()=>{n==="individual"&&(se(null),Z(null),Se(0)),n==="combination"&&X("personal")},[n]),d.useEffect(()=>{(n==="group"&&g.length>0||n==="combination"&&m.selectedUserId)&&(u||(console.log("[AdminPanel] Auto-setting default group room to 3 for",n),se("3")))},[n,g.length,m.selectedUserId]),d.useEffect(()=>{var s,t;if((n==="individual"||n==="combination")&&m.selectedUserId){const r=Ae(m.selectedUserId);r&&(ts(r.kettlebellPoints||""),ct(((s=r.cashAmount)==null?void 0:s.toString())||""),mt(((t=r.posAmount)==null?void 0:t.toString())||""))}},[m.selectedUserId,n]);const[nr,Lt]=d.useState([{id:"tmp-1",date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"18:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:""}]),[Je,Ft]=d.useState("new"),[gt,ys]=d.useState([]),[or,ir]=d.useState(!1);d.useEffect(()=>{(n==="individual"||n==="combination")&&m.selectedUserId&&Je==="existing"&&br(m.selectedUserId)},[m.selectedUserId,Je,n]);const[bl,pl]=d.useState([]),[fl,Ot]=d.useState([]),[Ee,yl]=d.useState(null),[Ze,ut]=d.useState(null),[Rt,Is]=d.useState(""),[ht,jl]=d.useState([]),[Xe,$e]=d.useState(1),[Te,qe]=d.useState("all"),[dr,wl]=d.useState(new Set),[js,vl]=d.useState(""),Es=6,[k,cr]=d.useState({}),[mr,Nl]=d.useState({}),[is,Gt]=d.useState({}),[bt,Ts]=d.useState(new Set),[pt,Ls]=d.useState({}),[_l,xr]=d.useState(new Set),[Pl,zt]=d.useState(!1),[ft,Kt]=d.useState(null),[Sl,Vt]=d.useState(!1),[Fs,Bt]=d.useState(null),[kl,gr]=d.useState([]),Al=[{id:"personal-training",name:"Personal Training Πρόγραμμα",icon:Me},{id:"membership-packages",name:"Πακέτα Συνδρομών",icon:Zt},{id:"ultimate-subscriptions",name:"👑 Ultimate Συνδρομές",icon:Ve},{id:"pilates-schedule",name:"Πρόγραμμα Pilates",icon:st},{id:"kettlebell-points",name:"Kettlebell Points",icon:Xs},{id:"cash-register",name:"Ταμείο",icon:er},{id:"users-information",name:"Χρήστες-Πληροφορίες",icon:$t}],$l=["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],Cl=s=>{const t=["user1@freegym.gr","user2@freegym.gr"],r=["PERSONAL2024","KICKBOX2024"],l=!!s.email&&t.includes(s.email),i=!!s.personalTrainingCode&&r.includes(s.personalTrainingCode);return l||i},ur=A.filter(s=>{if(!Fe)return!0;const t=Fe.toLowerCase();return s.firstName.toLowerCase().includes(t)||s.lastName.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)||`${s.firstName} ${s.lastName}`.toLowerCase().includes(t)}),hr=A.filter(s=>{if(!dt)return!0;const t=dt.toLowerCase();return s.firstName.toLowerCase().includes(t)||s.lastName.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)||`${s.firstName} ${s.lastName}`.toLowerCase().includes(t)});M.filter(s=>{const t=!us||(()=>{const l=us.toLowerCase();return s.user.firstName.toLowerCase().includes(l)||s.user.lastName.toLowerCase().includes(l)||s.user.email.toLowerCase().includes(l)||`${s.user.firstName} ${s.user.lastName}`.toLowerCase().includes(l)})(),r=hs==="all"||s.status===hs;return t&&r}),d.useEffect(()=>{te(1)},[us,hs]);const Ml=["06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00"],Ul=async()=>{try{console.log("[AdminPanel] Checking admin role in database...");const{data:s,error:t}=await D.from("user_profiles").select("user_id, role, first_name, last_name, email").eq("user_id",o==null?void 0:o.id).single();return t?(console.error("[AdminPanel] Error checking admin profile:",t),!1):(console.log("[AdminPanel] Admin profile in database:",s),console.log("[AdminPanel] Admin role in database:",s==null?void 0:s.role),(s==null?void 0:s.role)==="admin")}catch(s){return console.error("[AdminPanel] Exception checking admin role:",s),!1}},Dl=async()=>{try{console.log("[AdminPanel] Testing if we can create data...");const s={user_id:o==null?void 0:o.id,month:1,year:2e3,schedule_data:{sessions:[]},status:"pending",created_by:o==null?void 0:o.id},{data:t,error:r}=await D.from("personal_training_schedules").insert(s).select();return r?(console.log("[AdminPanel] Cannot create data - RLS blocking:",r.message),!1):t&&t.length>0?(await D.from("personal_training_schedules").delete().eq("id",t[0].id),console.log("[AdminPanel] Can create data - RLS working correctly"),!0):!1}catch(s){return console.error("[AdminPanel] Exception testing data creation:",s),!1}},Il=async(s,t)=>{if(!t){console.log("[AdminPanel] No admin ID available for test data creation");return}try{console.log("[AdminPanel] Creating test schedule for user:",s.email);const r={user_id:s.id,month:new Date().getMonth()+1,year:new Date().getFullYear(),schedule_data:{sessions:[{id:"test-1",date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"18:00",endTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",notes:"Test session created by admin"}],notes:"Test program created by admin",specialInstructions:"This is test data"},status:"pending",created_by:t},{data:l,error:i}=await D.from("personal_training_schedules").insert(r).select();i?console.error("[AdminPanel] Error creating test schedule:",i):(console.log("[AdminPanel] Test schedule created successfully:",l),setTimeout(()=>{Wt()},1e3))}catch(r){console.error("[AdminPanel] Exception creating test schedule:",r)}},Wt=d.useCallback(async()=>{console.log("[AdminPanel] ===== DATA LOADING STARTED ====="),console.log("[AdminPanel] Current user:",o==null?void 0:o.email,"Role:",o==null?void 0:o.role);try{L(!0),console.log("[AdminPanel] Querying user_profiles table...");const{data:s,error:t}=await D.from("user_profiles").select("*").order("created_at",{ascending:!1});if(console.log("[AdminPanel] User profiles query result - rows:",s==null?void 0:s.length,"error:",t),t)throw console.error("[AdminPanel] User profiles error:",t),t;console.log("[AdminPanel] Querying personal_training_schedules table..."),console.log("[AdminPanel] Current auth user ID:",o==null?void 0:o.id),console.log("[AdminPanel] Current auth user role:",o==null?void 0:o.role),console.log("[AdminPanel] Attempting to query personal_training_schedules...");let r=[],l=null;const{data:i,error:x}=await D.from("personal_training_schedules").select("id,user_id,month,year,schedule_data,status,created_by,created_at,updated_at,trainer_name,accepted_at,declined_at").order("created_at",{ascending:!1});if(x){console.log("[AdminPanel] Direct query failed:",x);const{data:f,error:Y}=await D.from("personal_training_schedules").select("id, user_id, status").limit(10);if(Y){console.log("[AdminPanel] Limited query also failed:",Y);const{count:ne,error:F}=await D.from("personal_training_schedules").select("*",{count:"exact",head:!0});console.log("[AdminPanel] Count query result:",ne,"error:",F)}else console.log("[AdminPanel] Limited query succeeded:",f),r=f||[]}else console.log("[AdminPanel] Direct query succeeded:",i),r=i||[];if(l=x,console.log("[AdminPanel] Schedules query result - rows:",r==null?void 0:r.length,"error:",l),(r==null?void 0:r.length)===0&&!l){console.log("[AdminPanel] Query succeeded but returned 0 rows - checking RLS policies...");const f=await Ul();console.log("[AdminPanel] Is admin in database:",f);const{count:Y,error:ne}=await D.from("personal_training_schedules").select("*",{count:"exact",head:!0});console.log("[AdminPanel] Total rows in table (bypassing RLS):",Y,"error:",ne),Y&&Y>0&&(console.warn("[AdminPanel] RLS is blocking access to existing data! Table has",Y,"rows but query returns 0."),console.warn("[AdminPanel] Admin role might not be properly configured in RLS policies."),console.warn("[AdminPanel] Please run the SQL script: database/fix_admin_rls_policies.sql"))}if(l){console.error("[AdminPanel] Schedules query failed with error:",l),console.log("[AdminPanel] Error code:",l.code),console.log("[AdminPanel] Error message:",l.message),console.log("[AdminPanel] Error details:",l.details),console.log("[AdminPanel] Error hint:",l.hint),console.log("[AdminPanel] Attempting to check table existence...");const{data:f,error:Y}=await D.from("personal_training_schedules").select("count").limit(1);console.log("[AdminPanel] Table check result:",f,"error:",Y)}if(l&&(console.error("[AdminPanel] Schedules error:",l),console.log("[AdminPanel] RLS might be blocking access. Checking if we can insert test data..."),console.log("[AdminPanel] Continuing with empty schedules due to RLS restrictions")),!s||s.length===0){console.log("[AdminPanel] No users found in database - setting empty states"),P([]),N([]);return}console.log("[AdminPanel] Transforming user profiles...");const y=s.map(f=>({id:f.user_id,email:f.email||`user-${f.user_id.slice(0,8)}@example.com`,firstName:f.first_name||"",lastName:f.last_name||"",profile_photo:f.profile_photo||"",profile_photo_locked:f.profile_photo_locked||!1,dob:f.dob||"",address:f.address||"",emergency_contact:f.emergency_contact||"",dob_locked:f.dob_locked||!1,hasPersonalTrainingCode:!1,personalTrainingCode:void 0,packageType:void 0}));console.log("[AdminPanel] Transformed users count:",y.length),P(y),fe(f=>({...f,"personal-training":!0})),console.log("[AdminPanel] Creating program statuses from schedules..."),console.log("[AdminPanel] Schedules data:",r);const C=(r||[]).map(f=>{console.log("[AdminPanel] Processing schedule:",f.id,"for user:",f.user_id);const Y=y.find(F=>F.id===f.user_id);if(!Y)return console.warn(`[AdminPanel] User not found for schedule ${f.id}, user_id: ${f.user_id}`),null;const ne={user:Y,schedule:{id:f.id,userId:f.user_id,month:f.month,year:f.year,status:f.status,scheduleData:f.schedule_data,createdBy:f.created_by,createdAt:f.created_at,updatedAt:f.updated_at,acceptedAt:f.accepted_at,declinedAt:f.declined_at},status:f.status};return console.log("[AdminPanel] Created program status:",ne),ne}).filter(f=>f!==null);console.log("[AdminPanel] Final program statuses count:",C.length),C.length===0&&y.length>0&&(console.log("[AdminPanel] No schedules found. Creating test data to verify system..."),await Dl()?await Il(y[0],o==null?void 0:o.id):(console.warn("[AdminPanel] Cannot create test data due to RLS restrictions."),console.warn("[AdminPanel] Please fix RLS policies by running: database/fix_admin_rls_policies.sql"))),N(C),console.log("[AdminPanel] Checking personal training codes...");const{data:U,error:_}=await D.from("personal_training_codes").select("*").limit(5);console.log("[AdminPanel] Personal training codes check - rows:",U==null?void 0:U.length,"error:",_),await El(y),fe(f=>({...f,"personal-training":!0})),console.log("[AdminPanel] ===== DATA LOADING COMPLETED SUCCESSFULLY =====")}catch(s){console.error("[AdminPanel] ===== DATA LOADING FAILED ====="),console.error("[AdminPanel] Error details:",s);const t=s instanceof Error?s.message:"Unknown error";c.error(`Σφάλμα κατά τη φόρτωση των χρηστών: ${t}`),P([]),N([])}finally{L(!1)}},[o==null?void 0:o.email,o==null?void 0:o.role]),El=async s=>{try{const{data:t,error:r}=await D.from("personal_training_codes").select("user_id, code, package_type, sessions_remaining").eq("is_active",!0);if(r){console.error("Error fetching personal training codes:",r),P(s);return}const l=s.map(i=>{const x=t==null?void 0:t.find(y=>y.user_id===i.id);return x?{...i,hasPersonalTrainingCode:!0,personalTrainingCode:x.code,packageType:x.package_type}:i});P(l)}catch(t){console.error("Error checking personal training codes:",t)}},[Tl,ws]=d.useState({});d.useEffect(()=>{if(console.log("[AdminPanel] useEffect triggered - user:",o==null?void 0:o.email,"role:",o==null?void 0:o.role,"activeTab:",p),!o){console.log("[AdminPanel] No user logged in");return}if(o.role!=="admin"){console.warn("[AdminPanel] User is not admin! Role:",o.role,"Email:",o.email);return}if(Tl[p]){console.log(`[AdminPanel] ${p} is already loading, skipping...`);return}p==="personal-training"&&!T["personal-training"]?(console.log("[AdminPanel] Loading data for personal-training tab"),ws(s=>({...s,[p]:!0})),Wt().finally(()=>ws(s=>({...s,[p]:!1})))):p==="membership-packages"&&!T["membership-packages"]?(console.log("[AdminPanel] Loading membership packages"),ws(s=>({...s,[p]:!0})),pr().finally(()=>ws(s=>({...s,[p]:!1})))):p==="kettlebell-points"&&!T["kettlebell-points"]?(console.log("[AdminPanel] Loading kettlebell points"),ws(s=>({...s,[p]:!0})),jt().finally(()=>ws(s=>({...s,[p]:!1})))):console.log(`[AdminPanel] ${p} data already loaded, skipping reload`)},[o==null?void 0:o.id,p]);const Ll=()=>{if(!I)return;const s={id:Date.now().toString(),date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"09:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",notes:""},t={...I,scheduleData:{...I.scheduleData,sessions:[...I.scheduleData.sessions,s]}};me(t)},Os=(s,t,r)=>{if(!I)return;const l=I.scheduleData.sessions.map(x=>x.id===s?{...x,[t]:r}:x),i={...I,scheduleData:{...I.scheduleData,sessions:l}};me(i)},Fl=s=>{if(!I)return;const t=I.scheduleData.sessions.filter(l=>l.id!==s),r={...I,scheduleData:{...I.scheduleData,sessions:t}};me(r)},Ol=async()=>{if(!(!I||!ue))try{L(!0),c.success(`Το πρόγραμμα για τον ${ue.firstName} ${ue.lastName} αποθηκεύτηκε!`),Ue(!1)}catch{c.error("Σφάλμα κατά την αποθήκευση του προγράμματος")}finally{L(!1)}},Rl=async()=>{if(Ne==="none"||!o){c.error("Παρακαλώ επιλέξτε μια κατάσταση έγκρισης");return}try{L(!0);const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.length===0){c.error("Δεν υπάρχουν επιλεγμένοι χρήστες");return}if(n==="group"){if(!u||!v){c.error("Παρακαλώ επιλέξτε Ομαδική Αίθουσα και συχνότητα εβδομάδας");return}if(g.length===0){c.error("Παρακαλώ επιλέξτε τουλάχιστον έναν χρήστη για το ομαδικό πρόγραμμα");return}}if(n==="combination"&&a>0&&(!u||!v)){c.error("Για συνδυασμένο πρόγραμμα με ομαδικές σεσίες, παρακαλώ επιλέξτε Ομαδική Αίθουσα και συχνότητα εβδομάδας");return}for(const l of s){const i=j(l),x=i?Ae(l):E[l];if(!x)continue;await Jt(l,Ne||"pending",{oldMembersUsed:x.oldMembers||!1,kettlebellPoints:x.kettlebellPoints?parseInt(x.kettlebellPoints):0,cashAmount:x.cashAmount||0,posAmount:x.posAmount||0,createdBy:o.id,groupRoomSize:n==="group"||n==="combination"?parseInt(u):null,weeklyFrequency:n==="group"||n==="combination"?v:null,monthlyTotal:n==="group"||n==="combination"?Pe:null,notes:`Program options saved with ${Ne} status${i?" (from frozen state)":""}${n==="group"||n==="combination"?` - Ομαδική Αίθουσα: ${u} χρήστες, ${v} φορές/εβδομάδα`:""}`})?console.log(`Program approval state saved for user ${l}: ${Ne}${i?" (from frozen state)":""}`):console.warn(`Failed to save program approval state for user ${l}`)}if(Ne==="approved")await Gl(s);else if(Ne==="rejected")console.log("Program options rejected - no actions executed"),c("Program Options απορρίφθηκαν - δεν εκτελέστηκαν ενέργειες",{icon:"ℹ️"});else if(Ne==="pending"){console.log("Program options pending - saving locally and freezing UI");const l={...Tt},i=new Set(Et);for(const x of s){const y=E[x];y&&(l[x]={oldMembers:y.oldMembers,first150Members:y.first150Members,kettlebellPoints:y.kettlebellPoints,cash:y.cash,pos:y.pos,cashAmount:y.cashAmount,posAmount:y.posAmount,groupRoomSize:n==="group"||n==="combination"?parseInt(u):null,weeklyFrequency:n==="group"||n==="combination"?v:null,monthlyTotal:n==="group"||n==="combination"?Pe:null},i.add(x))}lr(l),ar(i),c("Program Options τοποθετήθηκαν στην αναμονή - οι επιλογές παγώθηκαν",{icon:"⏳"})}if(xt("none"),Ne==="approved"||Ne==="rejected"){const l=new Set(Et),i={...Tt};for(const x of s)j(x)&&(l.delete(x),delete i[x]);ar(l),lr(i)}const t=s.some(l=>j(l)),r={approved:t?"εγκρίθηκε και εκτελέστηκαν οι ενέργειες (από frozen state)":"εγκρίθηκε και εκτελέστηκαν οι ενέργειες",rejected:t?"απορρίφθηκε (από frozen state)":"απορρίφθηκε",pending:"τοποθετήθηκε στην αναμονή"};c.success(`Program Options ${r[Ne]} επιτυχώς!`)}catch(s){console.error("Error saving program options:",s),c.error("Σφάλμα κατά την αποθήκευση των Program Options")}finally{L(!1)}},Gl=async s=>{console.log("Executing approved program actions for users:",s);try{for(const t of s){const r=j(t),l=r?Ae(t):E[t];if(!l)continue;l.oldMembers&&(await Js(t,(o==null?void 0:o.id)||"")?(console.log(`[APPROVED] Old Members marked as used for user: ${t}${r?" (from frozen state)":""}`),ks(U=>new Set([...U,t])),As(U=>new Set([...U,t])),Ge(U=>({...U,[t]:{...U[t],oldMembers:!1,first150Members:!1,cash:!1,pos:!1,cashAmount:void 0,posAmount:void 0}}))):console.warn(`[APPROVED] Failed to mark Old Members as used for user: ${t}${r?" (from frozen state)":""}`));const i=l.kettlebellPoints&&l.kettlebellPoints.trim()!==""&&parseInt(l.kettlebellPoints)||0;i>0?await Qs(t,i,void 0,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] Kettlebell Points saved for user: ${t}, Points: ${i}${r?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save Kettlebell Points for user: ${t}${r?" (from frozen state)":""}`):console.log(`[APPROVED] Kettlebell Points set to 0 for user: ${t}${r?" (from frozen state)":""}`);const x=l.cashAmount&&l.cashAmount>0?l.cashAmount:0;x>0?await Ns(t,x,"cash",void 0,(o==null?void 0:o.id)||"","Cash transaction from approved program creation")?console.log(`[APPROVED] Cash transaction saved for user: ${t}, Amount: €${x}${r?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save Cash transaction for user: ${t}${r?" (from frozen state)":""}`):console.log(`[APPROVED] Cash amount set to 0 for user: ${t}${r?" (from frozen state)":""}`);const y=l.posAmount&&l.posAmount>0?l.posAmount:0;y>0?await Ns(t,y,"pos",void 0,(o==null?void 0:o.id)||"","POS transaction from approved program creation")?console.log(`[APPROVED] POS transaction saved for user: ${t}, Amount: €${y}${r?" (from frozen state)":""}`):console.warn(`[APPROVED] Failed to save POS transaction for user: ${t}${r?" (from frozen state)":""}`):console.log(`[APPROVED] POS amount set to 0 for user: ${t}${r?" (from frozen state)":""}`)}c.success("Έγιναν όλες οι απαραίτητες ενέργειες για τα εγκεκριμένα προγράμματα!")}catch(t){console.error("Error executing approved program actions:",t),c.error("Σφάλμα κατά την εκτέλεση των ενεργειών")}},xe=()=>(Je==="existing"?gt:nr).sort((t,r)=>{const l=new Date(`${t.date}T${t.startTime}`),i=new Date(`${r.date}T${r.startTime}`);return l.getTime()-i.getTime()}),Le=s=>{Je==="existing"?ys(s):Lt(s)},br=async s=>{var t;if(s){ir(!0);try{console.log("[AdminPanel] Loading existing sessions for user:",s);const{data:r,error:l}=await D.from("personal_training_schedules").select("schedule_data, created_at").eq("user_id",s).order("created_at",{ascending:!1}).limit(1);if(l){console.error("[AdminPanel] Error loading existing sessions:",l),c.error("Σφάλμα κατά τη φόρτωση των υπαρχόντων σεσιών"),ys([]);return}r&&r.length>0&&((t=r[0].schedule_data)!=null&&t.sessions)?(console.log("[AdminPanel] Found existing sessions:",r[0].schedule_data.sessions),ys(r[0].schedule_data.sessions),c.success(`Φορτώθηκαν ${r[0].schedule_data.sessions.length} υπάρχουσες σεσίες`)):(console.log("[AdminPanel] No existing sessions found for user"),ys([]),c("Δεν βρέθηκαν υπάρχουσες σεσίες για αυτόν τον χρήστη",{icon:"ℹ️"}))}catch(r){console.error("[AdminPanel] Exception loading existing sessions:",r),c.error("Σφάλμα κατά τη φόρτωση των υπαρχόντων σεσιών"),ys([])}finally{ir(!1)}}},zl=async()=>{var t,r,l;const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.length===0){c.error("Παρακαλώ επιλέξτε χρήστη/ες");return}try{L(!0),console.log("[ADMIN] Starting to create personal training program..."),console.log("[ADMIN] User type:",ae);for(const U of s){const _=A.find(q=>q.id===U);if(!_){c.error(`Δεν βρέθηκε ο χρήστης με ID: ${U}`);continue}console.log("[ADMIN] Selected user:",_.firstName,_.lastName,"ID:",_.id),console.log("[ADMIN] Admin user ID:",o==null?void 0:o.id);let f=[];if(n==="group")if(ae==="paspartu"){const q=J[_.id]||[];q.length>0?f=q.map((G,B)=>({id:`group-session-${B+1}`,date:G.date,startTime:G.startTime,endTime:G.endTime,type:"personal",trainer:G.trainer||"Mike",room:G.room||"Αίθουσα Mike",notes:`Group Paspartu Session ${B+1} - ${G.notes||""}`})):(f=xe().map(B=>({id:B.id,date:B.date,startTime:B.startTime,type:B.type,trainer:B.trainer||"Mike",room:B.room,notes:B.notes+" (Group Paspartu)"})),console.log(`[ADMIN] Using ${f.length} current sessions for Group Paspartu user: ${_.email}`))}else f=[];else n==="combination"?f=xe().slice(0,le).map(G=>({id:G.id,date:G.date,startTime:G.startTime,type:G.type,trainer:G.trainer||"Mike",room:G.room,notes:G.notes+" (Personal - Συνδυασμός)"})):f=xe().map(G=>({id:G.id,date:G.date,startTime:G.startTime,type:G.type,trainer:G.trainer||"Mike",room:G.room,notes:G.notes}));const Y={user_id:_.id,trainer_name:n==="group"?"Mike":((t=f[0])==null?void 0:t.trainer)||"Mike",month:new Date().getMonth()+1,year:new Date().getFullYear(),schedule_data:{sessions:f,notes:n==="group"?"Group program - Οι σεσίες θα προστεθούν μέσω του Group Assignment Interface":n==="combination"?`Combination program - ${le} Personal + ${a} Group sessions`:"",trainer:n==="group"?"Mike":((r=f[0])==null?void 0:r.trainer)||"Mike",specialInstructions:n==="group"?"Ομαδικό πρόγραμμα - Οι λεπτομέρειες των σεσίων διαχειρίζονται ξεχωριστά":n==="combination"?`Συνδυασμένο πρόγραμμα - Περιλαμβάνει ${le} ατομικές σεσίες και ${a} ομαδικές σεσίες`:"",groupRoomSize:n==="group"||n==="combination"?parseInt(u):null,weeklyFrequency:n==="group"||n==="combination"?v:null,monthlyTotal:n==="group"||n==="combination"?Pe:null,combinationPersonalSessions:n==="combination"?le:null,combinationGroupSessions:n==="combination"?a:null},status:"accepted",created_by:o==null?void 0:o.id,user_type:ae,is_flexible:ae==="paspartu",training_type:n,group_room_size:n==="group"||n==="combination"?parseInt(u):null,weekly_frequency:n==="group"||n==="combination"?v:null,monthly_total:n==="group"||n==="combination"?Pe:null};console.log("[ADMIN] Schedule payload:",Y),console.log("[ADMIN] Inserting schedule into personal_training_schedules...");const{data:ne,error:F}=await D.from("personal_training_schedules").insert(Y).select().single();if(F)throw console.error("[ADMIN] Schedule insertion error:",F),F;if(console.log("[ADMIN] Schedule inserted successfully for user:",_.email),n==="combination"&&f.length>0){console.log("[ADMIN] Creating group_sessions for combination individual sessions...",f);const q=f.map(ge=>{const ms=ge.startTime,[_t,Pt]=ms.split(":").map(Number),St=`${((_t+1)%24).toString().padStart(2,"0")}:${Pt.toString().padStart(2,"0")}`;return{session_date:ge.date,start_time:ge.startTime,end_time:St,trainer:ge.trainer,room:ge.room,group_type:null,notes:ge.notes+" (Individual - Combination Program)"}});console.log("[ADMIN] Individual group sessions to insert:",q);const{data:G,error:B}=await D.from("group_sessions").insert(q.map(ge=>({program_id:ne.id,user_id:_.id,session_date:ge.session_date,start_time:ge.start_time,end_time:ge.end_time,trainer:ge.trainer,room:ge.room,group_type:ge.group_type,notes:ge.notes,is_active:!0,created_by:(o==null?void 0:o.id)||""})));B?(console.error("[ADMIN] Error creating group_sessions for combination individual sessions:",B),console.error("[ADMIN] Error details:",{message:B.message,details:B.details,hint:B.hint,code:B.code}),c.error("Σφάλμα κατά τη δημιουργία των ατομικών σεσίων του συνδυασμού")):(console.log("[ADMIN] Created group_sessions for combination individual sessions:",G),console.log("[ADMIN] Individual sessions created successfully"))}else console.log("[ADMIN] Skipping individual sessions creation:",{trainingType:n,scheduleSessionsLength:f.length,willCreate:n==="combination"&&f.length>0});const oe=E[_.id];if(oe&&(oe.oldMembers&&(await Js(_.id,(o==null?void 0:o.id)||"")?console.log("[ADMIN] Old Members marked as used for user:",_.email):console.warn("[ADMIN] Failed to mark Old Members as used for user:",_.email)),oe.kettlebellPoints&&parseInt(oe.kettlebellPoints)>0&&(await Qs(_.id,parseInt(oe.kettlebellPoints),ne.id,(o==null?void 0:o.id)||"")?console.log("[ADMIN] Kettlebell Points saved for user:",_.email,"Points:",oe.kettlebellPoints):console.warn("[ADMIN] Failed to save Kettlebell Points for user:",_.email))),ae==="paspartu"){console.log("[ADMIN] Handling Paspartu user - replacing old schedule and managing deposits...");const{error:q}=await D.rpc("replace_paspartu_schedule",{p_user_id:_.id,p_new_schedule_id:ne.id});q?(console.error("[ADMIN] Error replacing old Paspartu schedule:",q),console.warn("[ADMIN] Failed to replace old schedule, but new schedule was created successfully")):console.log("[ADMIN] Old Paspartu schedule replaced successfully for user:",_.email);let G=5,B=0;n==="combination"?(B=le+a,console.log(`[ADMIN] Combination Paspartu: ${le} personal + ${a} group = ${B} used deposits`)):n==="individual"?(B=0,console.log("[ADMIN] Individual Paspartu: Credit 5 lessons, no deduction (original behavior)")):n==="group"&&(B=0,console.log("[ADMIN] Group Paspartu: Credit 5 lessons, no deduction (same as Individual)")),B>G&&(console.warn(`[ADMIN] Warning: Used deposits (${B}) exceeds total deposits (${G}). Setting to max.`),B=G);const{error:ge}=await D.rpc("reset_lesson_deposit_for_new_program",{p_user_id:_.id,p_total_lessons:G,p_created_by:o==null?void 0:o.id});if(ge)console.error("[ADMIN] Lesson deposit reset error:",ge),console.warn("[ADMIN] Failed to reset lesson deposit, but schedule was created successfully");else if(console.log(`[ADMIN] Lesson deposit reset successfully for Paspartu user: ${_.email}`),console.log(`[ADMIN] Deposits: ${G} total, ${B} will be used, ${G-B} remaining`),B>0){const{error:ms}=await D.from("lesson_deposits").update({used_lessons:B,updated_at:new Date().toISOString()}).eq("user_id",_.id);ms?console.error("[ADMIN] Error updating used deposits:",ms):console.log(`[ADMIN] Updated used deposits to ${B} for user: ${_.email}`)}}if(ae==="paspartu"){console.log("[ADMIN] Ensuring lesson deposit exists for Paspartu user:",_.email);const{data:q}=await D.from("lesson_deposits").select("id").eq("user_id",_.id).single();if(q)console.log("[ADMIN] Lesson deposit already exists for Paspartu user:",_.email);else{const{error:G}=await D.from("lesson_deposits").insert({user_id:_.id,total_lessons:5,used_lessons:0});G?console.error("[ADMIN] Error creating lesson deposit:",G):console.log("[ADMIN] Lesson deposit created successfully for Paspartu user:",_.email)}}console.log("[ADMIN] Creating Personal Training membership...");const{data:cs,error:Ks}=await D.from("membership_packages").select("id").eq("name","Personal Training").eq("is_active",!0).single();if(Ks||!cs){console.error("[ADMIN] Error finding Personal Training package:",Ks),console.warn("[ADMIN] Personal Training package not found, skipping membership creation");continue}const Nt={user_id:_.id,package_id:cs.id,duration_type:"lesson",start_date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,end_date:(()=>{const q=new Date;return q.setDate(q.getDate()+30),`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}-${String(q.getDate()).padStart(2,"0")}`})(),is_active:!0,approved_by:o==null?void 0:o.id,approved_at:new Date().toISOString()},{error:Vs}=await D.from("memberships").insert(Nt);Vs?(console.error("[ADMIN] Membership insertion error:",Vs),console.warn("[ADMIN] Failed to create membership, but schedule was created successfully")):console.log("[ADMIN] Personal Training membership created successfully for user:",_.email)}const i=s.map(U=>{const _=A.find(f=>f.id===U);return _?`${_.firstName} ${_.lastName}`:"Άγνωστος"}).join(", "),x=ae==="personal"?"Personal":"Paspartu",y=n==="individual"?"Ατομικό":n==="combination"?"Συνδυασμένο":"Ομαδικό",C=n==="individual"||n==="combination"?"τον χρήστη":"τους χρήστες";if(c.success(`Το πρόγραμμα ${y} ${x} Training δημιουργήθηκε επιτυχώς για ${C}: ${i}!`),(n==="group"||n==="combination")&&s.length>0&&Object.keys(J).length>0){console.log("[AdminPanel] Creating group sessions for selected slots:",J);for(const U of s){const _=J[U];if(_&&_.length>0){const{data:f}=await D.from("personal_training_schedules").select("id").eq("user_id",U).in("training_type",["group","combination"]).order("created_at",{ascending:!1}).limit(1);if(f&&f.length>0){const Y=f[0].id,ne=_.map(oe=>({session_date:oe.date,start_time:oe.startTime,end_time:oe.endTime,trainer:oe.trainer,room:oe.room,group_type:oe.groupType,notes:oe.notes||"Group session created by admin"})),F=await Tn(U,Y,ne,(o==null?void 0:o.id)||"");if(F.success){if(console.log(`[AdminPanel] Created ${F.createdCount} group sessions for user ${U}`),F.blockedSessions&&F.blockedSessions.length>0){const oe=F.blockedSessions.length,cs=F.createdCount||0;c.error(`Δημιουργήθηκαν ${cs} σεσίες, αλλά ${oe} σεσίες αποκλείστηκαν λόγω γεμάτου capacity. Λεπτομέρειες: ${F.blockedSessions.slice(0,2).join(", ")}${oe>2?"...":""}`)}}else console.error("[AdminPanel] Error creating group sessions:",F.error),(l=F.error)!=null&&l.includes("capacity")?c.error(`Δεν μπορούν να δημιουργηθούν σεσίες: ${F.error}`):c.error(`Σφάλμα δημιουργίας σεσίων: ${F.error}`)}}}c.success("Το ομαδικό πρόγραμμα και οι αναθέσεις δημιουργήθηκαν επιτυχώς!")}else(n==="group"||n==="combination")&&s.length>0&&c(`Το ${n==="combination"?"συνδυασμένο":"ομαδικό"} πρόγραμμα δημιουργήθηκε. ${n==="combination"?"Μπορείτε να κάνετε ομαδικές αναθέσεις αργότερα από το Group Programs Overview.":"Μπορείτε να κάνετε αναθέσεις αργότερα από το Group Programs Overview."}`,{icon:"ℹ️"});re(!1),ve({code:"",selectedUserId:""}),_e("individual"),X("personal"),he([]),de({}),se(null),Z(null),Se(0),Ps(""),gs("dropdown"),Lt([{id:"tmp-1",date:new Date().toISOString().split("T")[0],startTime:"18:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:""}]),Ft("new"),ys([]),Wt()}catch(i){if(console.error("[ADMIN] Error creating personal training program:",i),i&&typeof i=="object"&&"code"in i){const x=i;x.code==="23505"?c.error("Το πρόγραμμα υπάρχει ήδη για αυτόν τον χρήστη."):x.code==="23503"?c.error("Πρόβλημα με τα δεδομένα χρήστη. Ελέγξτε ότι ο χρήστης υπάρχει."):x.code==="PGRST301"?c.error("Πρόβλημα αυθεντικοποίησης. Κάντε επανασύνδεση."):c.error(`Σφάλμα βάσης δεδομένων: ${x.message||"Άγνωστο σφάλμα"}`)}else c.error("Σφάλμα κατά τη δημιουργία του προγράμματος")}finally{L(!1)}};if(!o||o.role!=="admin")return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Δεν έχετε δικαίωμα πρόσβασης"}),e.jsx("p",{className:"text-gray-600",children:"Μόνο οι διαχειριστές μπορούν να έχουν πρόσβαση σε αυτή τη σελίδα."})]})});const pr=d.useCallback(async()=>{try{L(!0);const s=await Yn(),t=["Personal Training","Premium","Βασικό + προσωπική προπόνηση","VIP","Premium + όλα τα προνόμια","Όλα από το premium","Απεριόριστη προσωπική προπόνηση","Βασικό","Πρόσβαση σε όλες τις αίθουσες","Όλες οι ομαδικές τάξεις"],r=s.filter(i=>!t.includes(i.name)&&!t.some(x=>{var y;return(y=i.description)==null?void 0:y.includes(x)}));pl(r),fe(i=>({...i,"membership-packages":!0}));const l=await Qn();gr(l)}catch(s){console.error("Error loading membership packages:",s),c.error("Σφάλμα κατά τη φόρτωση των πακέτων")}finally{L(!1)}},[]),fr=async s=>{try{const t=await to(s);Ot(t)}catch(t){console.error("Error loading package durations:",t),c.error("Σφάλμα κατά τη φόρτωση των επιλογών διάρκειας")}},vs=async()=>{try{const s=await Jn();jl(s),$e(1)}catch(s){console.error("Error loading membership requests:",s),c.error("Σφάλμα κατά τη φόρτωση των αιτημάτων")}},Rs=()=>ht.filter(t=>{var C,U,_,f;const r=((C=t.package)==null?void 0:C.name)==="Free Gym",l=((U=t.package)==null?void 0:U.name)==="Pilates",i=t.has_installments===!0;let x=r||l;Te==="freegym"&&(x=r),Te==="pilates"&&(x=l),Te==="installments"&&(x=i);const y=js===""||`${((_=t.user)==null?void 0:_.first_name)||""} ${((f=t.user)==null?void 0:f.last_name)||""}`.toLowerCase().includes(js.toLowerCase());return x&&y}).sort((t,r)=>new Date(r.created_at).getTime()-new Date(t.created_at).getTime()),Kl=()=>{const s=Rs(),t=(Xe-1)*Es,r=t+Es;return s.slice(t,r)},ds=()=>{const s=Rs();return Math.ceil(s.length/Es)},Vl=()=>{$e(s=>Math.max(s-1,1))},Bl=()=>{$e(s=>Math.min(s+1,ds()))},Wl=()=>{$e(1)},Hl=()=>{$e(ds())},Yl=s=>{vl(s.target.value),$e(1)},Ql=s=>{yl(s),s.name==="Pilates"?Ot(kl):fr(s.id)},Jl=s=>{ut(s),Is(s.price.toString())},Zl=async()=>{if(!Ze||!Rt)return;const s=parseFloat(Rt);if(isNaN(s)||s<0){c.error("Παρακαλώ εισάγετε έγκυρη τιμή");return}try{L(!0),(Ee==null?void 0:Ee.name)==="Pilates"?await Xn(Ze.duration_type,s)&&(Ot(r=>r.map(l=>l.id===Ze.id?{...l,price:s}:l)),gr(r=>r.map(l=>l.id===Ze.id?{...l,price:s}:l)),ut(null),Is(""),c.success("Η τιμή Pilates ενημερώθηκε επιτυχώς")):await qn(Ze.id,s)&&(ut(null),Is(""),fr((Ee==null?void 0:Ee.id)||""))}catch(t){console.error("Error updating price:",t)}finally{L(!1)}},Xl=async s=>{var t,r;try{L(!0);const l=ht.find(x=>x.id===s);((t=l==null?void 0:l.package)==null?void 0:t.name)==="Ultimate"||((r=l==null?void 0:l.package)==null?void 0:r.name)==="Ultimate Medium"?await eo(s)&&(c.success("Το Ultimate αίτημα εγκρίθηκε επιτυχώς! Δημιουργήθηκαν 2 συνδρομές: Pilates + Open Gym"),vs()):await so(s)&&(c.success("Το αίτημα εγκρίθηκε επιτυχώς!"),vs())}catch(l){console.error("Error approving request:",l),c.error("Σφάλμα κατά την έγκριση του αιτήματος")}finally{L(!1)}},ql=async s=>{const t=prompt("Παρακαλώ εισάγετε τον λόγο απόρριψης:");if(t)try{L(!0),await ll(s,t)&&(c.success("Το αίτημα απορρίφθηκε επιτυχώς!"),vs())}catch(r){console.error("Error rejecting request:",r),c.error("Σφάλμα κατά την απόρριψη του αιτήματος")}finally{L(!1)}},ye=(s,t,r)=>{cr(l=>({...l,[s]:{...l[s],[t]:r}}))},en=(s,t,r)=>{Nl(l=>({...l,[s]:{...l[s],[t]:r}}))},yt=(s,t)=>{Gt(r=>({...r,[s]:t}))},sn=async s=>{const t=is[s];if(t==="none"||!o){c.error("Παρακαλώ επιλέξτε μια κατάσταση έγκρισης");return}try{L(!0);const r=k[s];if(!r){c.error("Δεν υπάρχουν επιλογές για αυτό το αίτημα");return}const l=ht.find(x=>x.id===s);if(!l){c.error("Αίτημα δεν βρέθηκε");return}if(await Jt(l.user_id,t||"pending",{oldMembersUsed:r.oldMembers||!1,kettlebellPoints:r.kettlebellPoints?parseInt(r.kettlebellPoints):0,cashAmount:r.cashAmount||0,posAmount:r.posAmount||0,createdBy:o.id,notes:`Program options saved for membership request ${s} with ${t} status`})){console.log(`Program approval state saved for membership request: ${s}`);const x=new Set(dr);if(x.add(s),wl(x),t==="pending"){const C=new Set(bt),U={...pt};C.add(s),U[s]=r,Ts(C),Ls(U),c("Program Options τοποθετήθηκαν στην αναμονή - οι επιλογές παγώθηκαν",{icon:"⏳"})}else if(t==="approved"&&await an(s,l.user_id,r),b(s)){const C=new Set(bt),U={...pt};C.delete(s),delete U[s],Ts(C),Ls(U)}Gt(C=>({...C,[s]:"none"}));const y={approved:"εγκρίθηκε και εκτελέστηκαν οι ενέργειες",rejected:"απορρίφθηκε",pending:"τοποθετήθηκε στην αναμονή"};c.success(`Program Options ${y[t]} επιτυχώς!`)}else c.error("Σφάλμα κατά την αποθήκευση των Program Options")}catch(r){console.error("Error saving request program options:",r),c.error("Σφάλμα κατά την αποθήκευση των Program Options")}finally{L(!1)}},tn=async s=>{const t=is[s];if(t==="none"||!o){c.error("Παρακαλώ επιλέξτε μια κατάσταση έγκρισης");return}try{L(!0);const r=mr[s];if(!r){c.error("Δεν υπάρχουν επιλογές για αυτό το αίτημα");return}const l=Ds.find(x=>x.id===s);if(!l){c.error("Ultimate αίτημα δεν βρέθηκε");return}if(await Jt(l.user_id,t||"pending",{oldMembersUsed:r.oldMembers||!1,kettlebellPoints:r.kettlebellPoints?parseInt(r.kettlebellPoints):0,cashAmount:r.cashAmount??0,posAmount:r.posAmount??0,createdBy:o.id,notes:`Program options saved for ultimate membership request ${s} with ${t} status`})){console.log(`[AdminPanel] Successfully saved program options for ultimate request ${s}`),t==="pending"?(Ts(y=>new Set([...y,s])),Ls(y=>({...y,[s]:{...r,oldMembers:r.oldMembers||!1,kettlebellPoints:r.kettlebellPoints||"",cash:r.cash||!1,pos:r.pos||!1,cashAmount:r.cashAmount??0,posAmount:r.posAmount??0}})),xr(y=>new Set([...y,s])),c("Ultimate Program Options τοποθετήθηκαν στην αναμονή - οι επιλογές παγώθηκαν",{icon:"⏳"})):(t==="approved"&&await ln(s,l.user_id,r),Ts(y=>new Set([...y,s])),Ls(y=>({...y,[s]:{...r,oldMembers:r.oldMembers||!1,kettlebellPoints:r.kettlebellPoints||"",cash:r.cash||!1,pos:r.pos||!1,cashAmount:r.cashAmount??0,posAmount:r.posAmount??0}}))),Gt(y=>({...y,[s]:"none"}));const x={approved:"εγκρίθηκε και εκτελέστηκαν οι ενέργειες",rejected:"απορρίφθηκε",pending:"τοποθετήθηκε στην αναμονή"};c.success(`Ultimate Program Options ${x[t]} επιτυχώς!`),await es()}else c.error("Σφάλμα κατά την αποθήκευση των Ultimate Program Options")}catch(r){console.error("[AdminPanel] Error saving ultimate program options:",r),c.error("Σφάλμα κατά την αποθήκευση των Ultimate Program Options")}finally{L(!1)}},rn=async s=>{try{Ts(t=>{const r=new Set(t);return r.delete(s),r}),xr(t=>{const r=new Set(t);return r.delete(s),r}),Ls(t=>{const r={...t};return delete r[s],r}),c.success("Program Options ξεπαγώθηκαν επιτυχώς!")}catch(t){console.error("[AdminPanel] Error unfreezing ultimate program options:",t),c.error("Σφάλμα κατά το ξεπάγωμα των Program Options")}},an=async(s,t,r)=>{console.log("Executing approved program actions for membership request:",s);try{r.oldMembers&&(await Js(t,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] Old Members marked as used for membership request: ${s}`):console.warn(`[APPROVED] Failed to mark Old Members as used for membership request: ${s}`)),r.first150Members&&(await Js(t,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] First 150 Members - Old Members marked as used for membership request: ${s}`):console.warn(`[APPROVED] First 150 Members - Failed to mark Old Members as used for membership request: ${s}`),console.log(`[APPROVED] First 150 Members selected - Cash set to 45€ and POS locked for membership request: ${s}`)),r.kettlebellPoints&&parseInt(r.kettlebellPoints)>0&&(await Qs(t,parseInt(r.kettlebellPoints),void 0,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] Kettlebell Points saved for membership request: ${s}, Points: ${r.kettlebellPoints}`):console.warn(`[APPROVED] Failed to save Kettlebell Points for membership request: ${s}`)),r.cashAmount&&r.cashAmount>0&&(await Ns(t,r.cashAmount,"cash",void 0,(o==null?void 0:o.id)||"","Cash transaction from approved membership request")?console.log(`[APPROVED] Cash transaction saved for membership request: ${s}, Amount: €${r.cashAmount}`):console.warn(`[APPROVED] Failed to save Cash transaction for membership request: ${s}`)),r.posAmount&&r.posAmount>0&&(await Ns(t,r.posAmount,"pos",void 0,(o==null?void 0:o.id)||"","POS transaction from approved membership request")?console.log(`[APPROVED] POS transaction saved for membership request: ${s}, Amount: €${r.posAmount}`):console.warn(`[APPROVED] Failed to save POS transaction for membership request: ${s}`)),c.success("Έγιναν όλες οι απαραίτητες ενέργειες για το εγκεκριμένο αίτημα!")}catch(l){console.error("Error executing approved program actions for membership request:",l)}},ln=async(s,t,r)=>{console.log("[AdminPanel] Executing approved program actions for Ultimate membership request:",s);try{r.oldMembers&&(await Js(t,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] Old Members marked as used for Ultimate membership request: ${s}`):console.warn(`[APPROVED] Failed to mark Old Members as used for Ultimate membership request: ${s}`)),r.kettlebellPoints&&parseInt(r.kettlebellPoints)>0&&(await Qs(t,parseInt(r.kettlebellPoints),s,(o==null?void 0:o.id)||"")?console.log(`[APPROVED] Kettlebell Points saved for Ultimate membership request: ${s}, Points: ${r.kettlebellPoints}`):console.warn(`[APPROVED] Failed to save Kettlebell Points for Ultimate membership request: ${s}`)),r.cashAmount&&r.cashAmount>0&&(await Ns(t,r.cashAmount,"cash",s,(o==null?void 0:o.id)||"","Cash transaction from approved Ultimate membership request")?console.log(`[APPROVED] Cash transaction saved for Ultimate membership request: ${s}, Amount: €${r.cashAmount}`):console.warn(`[APPROVED] Failed to save Cash transaction for Ultimate membership request: ${s}`)),r.posAmount&&r.posAmount>0&&(await Ns(t,r.posAmount,"pos",s,(o==null?void 0:o.id)||"","POS transaction from approved Ultimate membership request")?console.log(`[APPROVED] POS transaction saved for Ultimate membership request: ${s}, Amount: €${r.posAmount}`):console.warn(`[APPROVED] Failed to save POS transaction for Ultimate membership request: ${s}`)),c.success("Έγιναν όλες οι απαραίτητες ενέργειες για το εγκεκριμένο Ultimate αίτημα!")}catch(l){console.error("[AdminPanel] Error executing approved program actions for Ultimate membership request:",l),c.error("Σφάλμα κατά την εκτέλεση των ενεργειών")}},jt=d.useCallback(async()=>{try{L(!0);const[s,t]=await Promise.all([Kn(rs||void 0,as||void 0),Vn(rs||void 0,as||void 0)]);lt(s),rt(t),fe(r=>({...r,"kettlebell-points":!0}))}catch(s){console.error("Error loading kettlebell points data:",s),c.error("Σφάλμα κατά τη φόρτωση των Kettlebell Points")}finally{L(!1)}},[rs,as]),nn=async s=>{try{const r=(await Hn(s)).reduce((l,i)=>l+i.points,0);ts(r.toString())}catch(t){console.error("Error loading user kettlebell points:",t),ts("")}},on=s=>{if(!s.trim()){Ms([]);return}const t=Oe.filter(r=>r.user_name.toLowerCase().includes(s.toLowerCase())||r.user_email.toLowerCase().includes(s.toLowerCase()));Ms(t)},yr=s=>{nt(s),on(s),ns(1)},wt=Math.ceil(Oe.length/ps),vt=(ls-1)*ps,jr=vt+ps,dn=Oe.slice(vt,jr),cn=()=>{ns(s=>Math.max(s-1,1))},mn=()=>{ns(s=>Math.min(s+1,wt))};d.useEffect(()=>{p==="membership-packages"&&(pr(),vs())},[p]),d.useEffect(()=>{p==="kettlebell-points"&&jt()},[p]),d.useEffect(()=>{(async()=>{if(o)try{const{data:t,error:r}=await D.from("user_old_members_usage").select("user_id");if(r){console.error("Error loading old members usage:",r);return}const l=new Set((t==null?void 0:t.map(i=>i.user_id))||[]);ks(l),As(l)}catch(t){console.error("Exception loading old members usage:",t)}})()},[o]);const es=async()=>{try{rr(!0);const s=await Gs(()=>Zn(),"φόρτωση Ultimate αιτημάτων");s.length>bo&&(console.log(`[AdminPanel] Large Ultimate dataset detected: ${s.length} items`),c(`Φορτώθηκαν ${s.length} Ultimate αιτήματα. Χρησιμοποιείται σελιδοποίηση.`,{icon:"👑"})),gl(s),fe(t=>({...t,"ultimate-subscriptions":!0}))}catch(s){zs(s,"φόρτωση Ultimate αιτημάτων")}finally{rr(!1)}},xn=async s=>{try{await Gs(async()=>{const{error:t}=await D.from("membership_requests").delete().eq("id",s);if(t)throw t;return!0},"διαγραφή Ultimate αιτήματος"),c.success("Το Ultimate αίτημα διαγράφηκε επιτυχώς"),await es()}catch(t){zs(t,"διαγραφή Ultimate αιτήματος")}},gn=async s=>{var t,r;try{L(!0);const l=Ds.find(x=>x.id===s);(((t=l==null?void 0:l.package)==null?void 0:t.name)==="Ultimate"||((r=l==null?void 0:l.package)==null?void 0:r.name)==="Ultimate Medium")&&(await Gs(async()=>{const{approveUltimateMembershipRequest:x}=await An(async()=>{const{approveUltimateMembershipRequest:C}=await import("./membershipApi-BWxw4nWA.js");return{approveUltimateMembershipRequest:C}},__vite__mapDeps([0,1,2])),y=await x(s);if(!y)throw new Error("Approval failed");return y},"έγκριση Ultimate αιτήματος"),c.success("Το Ultimate αίτημα εγκρίθηκε επιτυχώς! Δημιουργήθηκαν 2 συνδρομές: Pilates + Open Gym"),es())}catch(l){zs(l,"έγκριση Ultimate αιτήματος")}finally{L(!1)}},un=async s=>{const t=prompt("Παρακαλώ εισάγετε τον λόγο απόρριψης:");if(t)try{L(!0),await Gs(async()=>{const r=await ll(s,t);if(!r)throw new Error("Rejection failed");return r},"απόρριψη Ultimate αιτήματος"),c.success("Το Ultimate αίτημα απορρίφθηκε επιτυχώς!"),es()}catch(r){zs(r,"απόρριψη Ultimate αιτήματος")}finally{L(!1)}},Ht=(s,t)=>{Kt({requestId:s,installmentNumber:t}),zt(!0)},hn=async()=>{if(ft){const{requestId:s,installmentNumber:t}=ft;try{const r=ht.find(y=>y.id===s);if(r){const y=k[s]||{},C={};t===1?(C.installment_1_amount=parseFloat(y.installment1Amount||r.installment_1_amount||0),C.installment_1_payment_method=y.installment1PaymentMethod||r.installment_1_payment_method||"cash",C.installment_1_due_date=y.installment1DueDate||r.installment_1_due_date):t===2?(C.installment_2_amount=parseFloat(y.installment2Amount||r.installment_2_amount||0),C.installment_2_payment_method=y.installment2PaymentMethod||r.installment_2_payment_method||"cash",C.installment_2_due_date=y.installment2DueDate||r.installment_2_due_date):t===3&&(C.installment_3_amount=parseFloat(y.installment3Amount||r.installment_3_amount||0),C.installment_3_payment_method=y.installment3PaymentMethod||r.installment_3_payment_method||"cash",C.installment_3_due_date=y.installment3DueDate||r.installment_3_due_date);const{error:U}=await D.from("membership_requests").update(C).eq("id",s);if(U){console.error("[AdminPanel] Error saving values before lock:",U),c.error("Σφάλμα κατά την αποθήκευση των τιμών");return}console.log("[AdminPanel] Saved values before locking:",C)}const l=await ol(o==null?void 0:o.id),{error:i}=await D.rpc("lock_installment",{p_request_id:s,p_installment_number:t,p_locked_by:l});if(i){console.error(`Error locking installment ${t}:`,i),c.error(`Σφάλμα κατά το κλείδωμα της ${t}ης δόσης`);return}const x=`installment${t}Locked`;ye(s,x,!0),c.success(`${t}η δόση κλειδώθηκε επιτυχώς με τις τρέχουσες τιμές`),await vs()}catch(r){console.error("Exception locking installment:",r),c.error("Σφάλμα κατά το κλείδωμα της δόσης")}zt(!1),Kt(null)}},bn=()=>{zt(!1),Kt(null)},pn=s=>{Bt(s),Vt(!0)},fn=async()=>{if(Fs){try{const s=await ol(o==null?void 0:o.id);console.log("Deleting third installment for request:",Fs,"by user:",s);const{error:t}=await D.rpc("delete_third_installment_permanently",{p_request_id:Fs,p_deleted_by:s});if(t){console.error("Error deleting third installment:",t),c.error("Σφάλμα κατά τη διαγραφή της 3ης δόσης");return}ye(Fs,"deleteThirdInstallment",!0),c.success("3η δόση διαγράφηκε επιτυχώς"),await vs()}catch(s){console.error("Exception deleting third installment:",s),c.error("Σφάλμα κατά τη διαγραφή της 3ης δόσης")}Vt(!1),Bt(null)}},yn=()=>{Vt(!1),Bt(null)},ce=(s,t)=>{const r=`installment_${t}_locked`,l=s[r]===!0;return console.log(`[AdminPanel] isInstallmentLocked check for request ${s.id}, installment ${t}: locked = ${l}, field = ${r}, value = ${s[r]}`),s[r]!==void 0&&s[r]!==null?l:(console.log(`[AdminPanel] Field ${r} is undefined/null, checking old locked_installments table...`),!1)},jn=async(s,t,r,l,i,x,y,C,U,_)=>{try{const f={installment_1_amount:t,installment_2_amount:r,installment_3_amount:l,installment_1_payment_method:i,installment_2_payment_method:x,installment_3_payment_method:y};C&&(f.installment_1_due_date=C),U&&(f.installment_2_due_date=U),_&&(f.installment_3_due_date=_);const Y=k[s];if(Y){const ne=F=>!F||F==="undefined"?null:F;if(Y.installment1Locked){const{error:F}=await D.rpc("lock_installment",{p_request_id:s,p_installment_number:1,p_locked_by:ne(o==null?void 0:o.id)});F&&console.error("Error locking installment 1:",F)}if(Y.installment2Locked){const{error:F}=await D.rpc("lock_installment",{p_request_id:s,p_installment_number:2,p_locked_by:ne(o==null?void 0:o.id)});F&&console.error("Error locking installment 2:",F)}if(Y.installment3Locked){const{error:F}=await D.rpc("lock_installment",{p_request_id:s,p_installment_number:3,p_locked_by:ne(o==null?void 0:o.id)});F&&console.error("Error locking installment 3:",F)}if(Y.deleteThirdInstallment){const F=ne(o==null?void 0:o.id);if(F){const{error:oe}=await D.rpc("delete_third_installment_permanently",{request_id:s,deleted_by_user_id:F==="00000000-0000-0000-0000-000000000001"?null:F});oe&&console.error("Error deleting third installment:",oe)}else console.error("No valid user ID for third installment deletion")}}await Gs(async()=>{const{error:ne}=await D.from("membership_requests").update(f).eq("id",s);if(ne)throw ne;return!0},"ενημέρωση δόσεων"),c.success("Οι δόσεις και ημερομηνίες ενημερώθηκαν επιτυχώς"),await es()}catch(f){zs(f,"ενημέρωση δόσεων")}};d.useEffect(()=>{p==="ultimate-subscriptions"&&!T["ultimate-subscriptions"]&&(console.log("[AdminPanel] Loading Ultimate Subscriptions data..."),es())},[p]),d.useEffect(()=>{p==="ultimate-subscriptions"&&Ds.length===0&&!It&&(console.log("[AdminPanel] Ultimate Subscriptions tab active but no data, reloading..."),es())},[p,Ds.length,It]);const Gs=async(s,t="operation",r=3)=>{for(let l=1;l<=r;l++)try{return await s()}catch(i){if(console.error(`[AdminPanel] Database ${t} failed (attempt ${l}/${r}):`,i),l===r){const y=`Σφάλμα σύνδεσης με τη βάση δεδομένων κατά ${t}. Παρακαλώ ελέγξτε τη σύνδεσή σας και δοκιμάστε ξανά.`;throw c.error(y),i}const x=1e3*l;console.log(`[AdminPanel] Retrying ${t} in ${x}ms...`),await new Promise(y=>setTimeout(y,x))}throw new Error(`Failed to complete ${t} after ${r} attempts`)},zs=(s,t)=>{var r,l,i;console.error(`[AdminPanel] Database error in ${t}:`,s),(r=s.message)!=null&&r.includes("network")||(l=s.message)!=null&&l.includes("connection")?c.error("Πρόβλημα σύνδεσης δικτύου. Παρακαλώ ελέγξτε τη σύνδεσή σας."):(i=s.message)!=null&&i.includes("timeout")?c.error("Η λειτουργία διήρκησε πολύ. Παρακαλώ δοκιμάστε ξανά."):c.error(`Παρουσιάστηκε σφάλμα κατά ${t}. Παρακαλώ δοκιμάστε ξανά.`)};d.useEffect(()=>{m.selectedUserId&&nn(m.selectedUserId)},[m.selectedUserId]);const wn=async()=>{if(!ke||!We){S({type:"error",message:"Παρακαλώ επιλέξτε χρήστη και εισάγετε αριθμό points"});return}const s=parseInt(We);if(s<=0){S({type:"error",message:"Ο αριθμός των points πρέπει να είναι μεγαλύτερος από 0"});return}try{S(null),L(!0);const t=A.find(i=>i.id===ke);if(!t){S({type:"error",message:"Δεν βρέθηκε ο επιλεγμένος χρήστης"});return}if(console.log("[OpenGym] Starting Open Gym action for user:",t.email,"Extra Service:",s),!await Qs(ke,s,void 0,(o==null?void 0:o.id)||"")){S({type:"error",message:"Σφάλμα κατά την αποθήκευση των Kettlebell Points"});return}if(console.log("[OpenGym] Kettlebell Points saved successfully"),!await vn(ke)){S({type:"error",message:"Σφάλμα κατά τη δημιουργία της Free Gym συνδρομής"});return}console.log("[OpenGym] Free Gym membership created successfully"),S({type:"success",message:`Επιτυχής εφαρμογή Open Gym για ${t.firstName} ${t.lastName}! Ενεργοποιήθηκε η 1μηνη Free Gym συνδρομή.`}),os(""),Us(""),Mt(""),c.success(`Open Gym εφαρμογή επιτυχής για ${t.firstName} ${t.lastName}`)}catch(t){console.error("[OpenGym] Error during Open Gym action:",t),S({type:"error",message:"Σφάλμα κατά την εκτέλεση της ενέργειας Open Gym"})}finally{L(!1)}},vn=async s=>{try{const{data:t,error:r}=await D.from("membership_packages").select("id").eq("name","Free Gym").eq("is_active",!0).single();if(r||!t)return console.error("[OpenGym] Error finding Free Gym package:",r),!1;const l=new Date,i=new Date;i.setMonth(i.getMonth()+1);const{error:x}=await D.from("memberships").insert({user_id:s,package_id:t.id,start_date:l.toISOString().split("T")[0],end_date:i.toISOString().split("T")[0],is_active:!0,expires_at:i.toISOString(),source_package_name:"Open Gym"});return x?(console.error("[OpenGym] Error creating Free Gym membership:",x),!1):!0}catch(t){return console.error("[OpenGym] Exception creating Free Gym membership:",t),!1}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-xl shadow-xl p-4 sm:p-8 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-3xl font-bold mb-2",children:"🏋️‍♂️ Διαχείριση Γυμναστηρίου"}),e.jsxs("p",{className:"text-blue-100 text-sm sm:text-lg",children:["Καλώς ήρθες, ",e.jsx("span",{className:"font-semibold",children:o.firstName}),"!"]})]}),e.jsx("div",{className:"bg-white/20 rounded-xl p-3 sm:p-4 backdrop-blur-sm self-start sm:self-auto",children:e.jsx($t,{className:"h-8 w-8 sm:h-12 sm:w-12"})})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex overflow-x-auto space-x-2 sm:space-x-8 px-3 sm:px-6",children:Al.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>w(s.id),className:`py-3 sm:py-4 px-2 sm:px-1 border-b-3 font-semibold text-xs sm:text-sm flex items-center space-x-2 sm:space-x-3 transition-all duration-200 whitespace-nowrap ${p===s.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(t,{className:`h-4 w-4 sm:h-5 sm:w-5 ${p===s.id?"text-blue-500":"text-gray-400"}`}),e.jsx("span",{className:"hidden sm:inline",children:s.name}),e.jsx("span",{className:"sm:hidden",children:s.name.split(" ")[0]})]},s.id)})})}),e.jsxs("div",{className:"p-3 sm:p-6",children:[W&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Φόρτωση δεδομένων χρήστη… Αυτό μπορεί να διαρκέσει λίγα δευτερόλεπτα."})]}),p==="personal-training"&&!W&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"💪 Personal Training Πρόγραμμα"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Διαχείριση προγραμμάτων προπόνησης"})]}),e.jsxs("button",{onClick:()=>re(!0),className:"flex items-center space-x-2 sm:space-x-3 px-4 sm:px-6 py-2 sm:py-3 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm sm:text-base",children:[e.jsx(Me,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{children:"🏋️‍♂️ Δημιουργία Προγράμματος"})]})]})}),ue&&I&&!Cl({email:ue.email,personalTrainingCode:ue.personalTrainingCode})&&e.jsxs("div",{className:"bg-gradient-to-br from-white to-blue-50 border-2 border-blue-200 rounded-xl shadow-xl p-4 sm:p-8",id:"schedule-editor",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 sm:p-6 rounded-xl shadow-lg flex-1 sm:flex-none",children:[e.jsxs("h3",{className:"text-lg sm:text-2xl font-bold mb-1 sm:mb-2",children:["🏋️‍♂️ Πρόγραμμα για ",ue.firstName," ",ue.lastName]}),e.jsxs("p",{className:"text-blue-100 text-sm sm:text-lg",children:["📅 ",$l[I.month-1]," ",I.year]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 sm:space-x-2 sm:gap-0",children:we?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Ll,className:"flex items-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors text-sm",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Προσθήκη Σεσίας"}),e.jsx("span",{className:"sm:hidden",children:"Προσθήκη"})]}),e.jsxs("button",{onClick:Ol,className:"flex items-center space-x-1 px-3 py-2 bg-primary-100 text-primary-700 rounded-md hover:bg-primary-200 transition-colors text-sm",children:[e.jsx(Zs,{className:"h-4 w-4"}),e.jsx("span",{children:"Αποθήκευση"})]}),e.jsx("button",{onClick:()=>Ue(!1),className:"flex items-center space-x-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-sm",children:e.jsx("span",{children:"Ακύρωση"})})]}):e.jsxs("button",{onClick:()=>Ue(!0),className:"flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(tl,{className:"h-4 w-4"}),e.jsx("span",{children:"Επεξεργασία"})]})})]}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:I.scheduleData.sessions.sort((s,t)=>{const r=new Date(`${s.date}T${s.startTime}`),l=new Date(`${t.date}T${t.startTime}`);return r.getTime()-l.getTime()}).map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"sm:col-span-2 lg:col-span-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Ημέρα"}),we?e.jsx("input",{type:"date",value:s.date,onChange:t=>Os(s.id,"date",t.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",lang:"el"}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:new Date(s.date).toLocaleDateString("el-GR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Ώρα Έναρξης"}),we?e.jsx("select",{value:s.startTime,onChange:t=>Os(s.id,"startTime",t.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:Ml.map(t=>e.jsx("option",{value:t,children:t},t))}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Τύπος"}),we?e.jsxs("select",{value:s.type,onChange:t=>Os(s.id,"type",t.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:[e.jsx("option",{value:"personal",children:"Personal Training"}),e.jsx("option",{value:"kickboxing",children:"Kick Boxing"}),e.jsx("option",{value:"combo",children:"Combo"})]}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900 capitalize",children:s.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Προπονητής"}),we?e.jsx("select",{value:s.trainer,onChange:t=>Os(s.id,"trainer",t.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",children:nl.map(t=>e.jsx("option",{value:t,children:t},t))}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.trainer})]}),e.jsx("div",{className:"flex items-end sm:col-span-2 lg:col-span-1",children:we&&e.jsxs("button",{onClick:()=>Fl(s.id),className:"flex items-center space-x-1 px-3 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors text-sm w-full sm:w-auto",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx("span",{children:"Διαγραφή"})]})})]}),s.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Σημειώσεις"}),we?e.jsx("input",{type:"text",value:s.notes,onChange:t=>Os(s.id,"notes",t.target.value),className:"w-full border border-gray-300 rounded px-2 py-2 text-sm",placeholder:"Σημειώσεις για τη σέσια"}):e.jsx("p",{className:"text-xs sm:text-sm text-gray-900",children:s.notes})]})]},s.id))}),e.jsxs("div",{className:"mt-4 sm:mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Γενικές Σημειώσεις"}),we?e.jsx("textarea",{value:I.scheduleData.notes||"",onChange:s=>{const t={...I,scheduleData:{...I.scheduleData,notes:s.target.value}};me(t)},className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",rows:3,placeholder:"Γενικές σημειώσεις για το πρόγραμμα..."}):e.jsx("p",{className:"text-sm text-gray-900",children:I.scheduleData.notes||"Δεν υπάρχουν σημειώσεις"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl shadow-lg border-2 border-orange-200",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg sm:text-2xl font-bold text-orange-800 mb-2",children:"🏋️‍♂️ Open Gym"}),e.jsx("p",{className:"text-orange-600 text-sm sm:text-base",children:"Διαχείριση εξτρα υπηρεσιών και Free Gym συνδρομών"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["👤 Επιλογή Χρήστη",e.jsxs("span",{className:"ml-2 text-xs bg-orange-100 text-orange-600 px-2 py-1 rounded",children:["Selected: ",ke?"✅":"❌"]})]}),e.jsxs("div",{className:"flex space-x-3 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>He("dropdown"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${Ie==="dropdown"?"bg-orange-600 text-white shadow-lg":"bg-white text-orange-600 border-2 border-orange-200 hover:border-orange-400"}`,children:"📋 Dropdown"}),e.jsx("button",{type:"button",onClick:()=>He("search"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${Ie==="search"?"bg-orange-600 text-white shadow-lg":"bg-white text-orange-600 border-2 border-orange-200 hover:border-orange-400"}`,children:"🔍 Αναζήτηση"})]}),Ie==="dropdown"?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:ke,onChange:s=>os(s.target.value),children:[e.jsx("option",{value:"",children:"-- Επιλέξτε χρήστη --"}),A.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName," (",s.email,")"]},s.id))]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 placeholder-gray-400",placeholder:"🔍 Αναζήτηση με όνομα ή email...",value:dt,onChange:s=>Mt(s.target.value)}),dt&&e.jsx("div",{className:"max-h-48 overflow-y-auto border-2 border-orange-200 rounded-xl bg-white shadow-lg",children:hr.length>0?hr.map(s=>e.jsxs("div",{className:`p-4 hover:bg-orange-50 cursor-pointer border-b border-orange-100 last:border-b-0 transition-all duration-200 ${ke===s.id?"bg-orange-100 border-l-4 border-l-orange-500":""}`,onClick:()=>{os(s.id),Mt("")},children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.email})]},s.id)):e.jsx("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Δεν βρέθηκαν χρήστες"})})]}),ke&&e.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"✓"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:[(wr=A.find(s=>s.id===ke))==null?void 0:wr.firstName," ",(vr=A.find(s=>s.id===ke))==null?void 0:vr.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:(Nr=A.find(s=>s.id===ke))==null?void 0:Nr.email})]}),e.jsx("button",{onClick:()=>os(""),className:"ml-auto text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ke,{className:"h-4 w-4"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"🏋️‍♂️ Kettlebell Points"}),e.jsx("input",{type:"number",min:"0",step:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Εισάγετε αριθμό...",value:We,onChange:s=>Us(s.target.value)})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:wn,disabled:!ke||!We||parseInt(We)<=0,className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl hover:from-orange-600 hover:to-red-600 transition-all duration-200 font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-orange-500 disabled:hover:to-red-500",children:"🏋️‍♂️ Εφαρμογή Open Gym"})}),fs&&e.jsx("div",{className:`p-3 rounded-lg text-sm font-medium ${fs.type==="success"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:fs.message})]})]})}),Ss&&e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl shadow-lg border-2 border-green-200",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(Bn,{featureEnabled:Ss})})})]}),p==="membership-packages"&&!W&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Διαχείριση Πακέτων Συνδρομών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Ενημερώστε τις τιμές για κάθε πακέτο και διάρκεια"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:bl.map(s=>e.jsxs("div",{className:`border-2 rounded-xl p-6 cursor-pointer transition-all duration-200 ${(Ee==null?void 0:Ee.id)===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>Ql(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s.name==="Pilates"?e.jsx("span",{className:"text-2xl",children:"🧘"}):e.jsx(Xs,{className:"h-6 w-6 text-blue-500"}),e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:s.name})]}),e.jsx(Zt,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:s.description}),s.features&&e.jsx("ul",{className:"space-y-1",children:s.features.slice(0,3).map((t,r)=>e.jsxs("li",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mr-2"}),t]},r))})]},s.id))})})]}),Ee&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Τιμές για ",Ee.name]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Ενημερώστε τις τιμές για κάθε διάρκεια"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:fl.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(st,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:qt(s.duration_type)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.duration_days," ημέρες"]})]})]}),e.jsx("button",{onClick:()=>Jl(s),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(tl,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{qe("all"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="all"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Όλα"}),e.jsx("button",{onClick:()=>{qe("freegym"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="freegym"?"bg-green-600 text-white border-green-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Open Gym"}),e.jsx("button",{onClick:()=>{qe("pilates"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="pilates"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Pilates"}),e.jsx("button",{onClick:()=>{qe("installments"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="installments"?"bg-orange-600 text-white border-orange-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Δόσεις"})]}),(Ze==null?void 0:Ze.id)===s.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",value:Rt,onChange:t=>Is(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Νέα τιμή",step:"0.01",min:"0"})}),e.jsx("button",{onClick:Zl,disabled:W,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm disabled:opacity-50",children:e.jsx(Zs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{ut(null),Is("")},className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:e.jsx(Ke,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Re(s.price)}),e.jsx("div",{className:"text-sm text-gray-600",children:"EUR"})]})]},s.id))})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/10 rounded-xl backdrop-blur-sm",children:e.jsx(Ve,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Αιτήματα Συνδρομών"}),e.jsx("p",{className:"text-slate-200 mt-1",children:"Διαχειριστείτε τα αιτήματα συνδρομών από χρήστες"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση με όνομα χρήστη...",value:js,onChange:Yl,className:"pl-12 pr-6 py-3 bg-white/10 border border-white/20 rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 w-full lg:w-80 text-white placeholder-slate-300 backdrop-blur-sm"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 border border-slate-200 rounded-xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"h-6 w-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Οδηγίες Διαχείρισης Αιτημάτων"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(Be,{className:"h-3 w-3 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800 mb-1",children:"Αναζήτηση & Πλοήγηση"}),e.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed",children:["Χρησιμοποιήστε το πεδίο αναζήτησης για να βρείτε γρήγορα αιτήματα με όνομα χρήστη. Η λίστα εμφανίζεται σε ",e.jsx("span",{className:"font-semibold text-blue-700",children:"6άδες"})," - ελέγξτε την επόμενη σελίδα αν δεν βρείτε το επιθυμητό αίτημα."]})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg p-4 border border-amber-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(er,{className:"h-3 w-3 text-amber-600"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-amber-800 mb-1 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full mr-2"}),"Σημαντική Προσοχή - Διαδικασία Πληρωμής"]}),e.jsxs("p",{className:"text-sm text-amber-700 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"ΠΡΩΤΑ"})," αποθηκεύουμε τα χρήματα στο σύστημα (Cash Register) και",e.jsx("span",{className:"font-semibold",children:" ΕΠΕΙΤΑ"})," επιλέγουμε για το αίτημα του χρήστη εάν εγκρίνεται ή απορρίπτεται."]})]})]})})]})]})]})}),e.jsx("div",{className:"p-8",children:Rs().length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ve,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:js?"Δεν βρέθηκαν αποτελέσματα":"Δεν υπάρχουν αιτήματα"}),e.jsx("p",{className:"text-gray-500",children:js?`Για την αναζήτηση "${js}"`:"Δεν έχουν υποβληθεί αιτήματα συνδρομών ακόμα"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-slate-50 rounded-xl p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Me,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-700",children:["Εμφάνιση ",(Xe-1)*Es+1,"-",Math.min(Xe*Es,Rs().length)," από ",Rs().length," αιτήματα"]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Οργανωμένα σε 6άδες για εύκολη πλοήγηση"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-y-2",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mr-4",children:[e.jsx("span",{className:"text-xs sm:text-sm font-semibold text-slate-600 mr-1",children:"Φίλτρα αιτημάτων συνδρομών:"}),e.jsx("button",{onClick:()=>{qe("all"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="all"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Όλα"}),e.jsx("button",{onClick:()=>{qe("freegym"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="freegym"?"bg-green-600 text-white border-green-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Open Gym"}),e.jsx("button",{onClick:()=>{qe("pilates"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="pilates"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Pilates"}),e.jsx("button",{onClick:()=>{qe("installments"),$e(1)},className:`px-3 py-1.5 rounded-full text-xs sm:text-sm font-semibold border transition-colors ${Te==="installments"?"bg-orange-600 text-white border-orange-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,children:"Δόσεις"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[ds()>3&&e.jsx("button",{onClick:Wl,disabled:Xe===1,className:"px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-200",title:"Πρώτη σελίδα",children:"««"}),e.jsxs("button",{onClick:Vl,disabled:Xe===1,className:"px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed flex items-center space-x-2 transition-all duration-200",children:[e.jsx("span",{children:"←"}),e.jsx("span",{children:"Προηγούμενο"})]}),e.jsxs("div",{className:"px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-lg min-w-[120px] text-center",children:[Xe," / ",ds()]}),e.jsxs("button",{onClick:Bl,disabled:Xe>=ds(),className:"px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed flex items-center space-x-2 transition-all duration-200",children:[e.jsx("span",{children:"Επόμενο"}),e.jsx("span",{children:"→"})]}),ds()>3&&e.jsx("button",{onClick:Hl,disabled:Xe>=ds(),className:"px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-200",title:"Τελευταία σελίδα",children:"»»"})]})]})]})}),e.jsx("div",{className:"space-y-8",children:Kl().map(s=>{var t,r,l,i,x,y,C,U,_,f,Y,ne,F,oe,cs,Ks,Nt,Vs,q,G,B,ge,ms,_t,Pt,Yt,St,ea,sa,ta,ra,aa,la,na,oa,ia,da,ca,ma,xa,ga,ua,ha,ba,pa,fa,ya,ja,wa,va,Na,_a,Pa,Sa,ka,Aa,$a,Ca,Ma,Ua,Da,Ia,Ea,Ta,La,Fa,Oa,Ra,Ga,za,Ka,Va,Ba,Wa,Ha,Ya,Qa,Ja,Za,Xa,qa;return e.jsxs("div",{className:"relative bg-slate-100 border-2 border-slate-300 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:`absolute left-0 top-0 h-full w-2 
                            ${s.status==="approved"?"bg-green-400":""}
                            ${s.status==="pending"?"bg-yellow-400":""}
                            ${s.status==="rejected"?"bg-red-400":""}
                          `}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[(t=s.user)!=null&&t.profile_photo?e.jsxs("div",{className:"w-12 h-12 rounded-xl overflow-hidden shadow-lg border-2 border-white",children:[e.jsx("img",{src:s.user.profile_photo,alt:`${(r=s.user)==null?void 0:r.first_name} ${(l=s.user)==null?void 0:l.last_name}`,className:"w-full h-full object-cover",onError:O=>{O.currentTarget.style.display="none";const pe=O.currentTarget.nextElementSibling;pe&&(pe.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center hidden",children:e.jsx(Ve,{className:"h-6 w-6 text-white"})})]}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Ve,{className:"h-6 w-6 text-white"})}),s.status==="pending"&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h4",{className:"text-lg font-bold text-slate-900 mb-1",children:[(i=s.user)==null?void 0:i.first_name," ",(x=s.user)==null?void 0:x.last_name]}),e.jsxs("p",{className:"text-sm text-slate-600 mb-2 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-slate-300 rounded-full mr-2"}),(y=s.user)==null?void 0:y.email]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:(C=s.package)==null?void 0:C.name}),e.jsx("span",{className:"text-sm text-slate-500",children:"•"}),e.jsx("span",{className:"text-sm text-slate-600",children:qt(s.duration_type)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:Re(s.requested_price)}),e.jsxs("div",{className:"text-sm text-slate-500 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),new Date(s.created_at).toLocaleDateString("el-GR")]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3",children:[s.status==="pending"&&(dr.has(s.id)||R(s.id)?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>Xl(s.id),disabled:W,className:"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"Εγκρίνω Συνδρομή"})]}),e.jsxs("button",{onClick:()=>ql(s.id),disabled:W,className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{children:"Απορρίπτω Συνδρομή"})]})]}):e.jsx("div",{className:"max-w-[280px] text-right",children:e.jsxs("div",{className:"inline-flex items-start bg-amber-50 border border-amber-200 text-amber-800 rounded-lg px-3 py-2 text-xs",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),e.jsx("span",{children:"Για να ενεργοποιηθούν τα κουμπιά «Εγκρίνω Συνδρομή / Απορρίπτω Συνδρομή», εκτελέστε πρώτα ενέργεια πληρωμής (Έγκριση/Απόρριψη/Αναμονή) και πατήστε «Αποθήκευση Program Options»."})]})})),(s.status==="approved"||s.status==="rejected")&&s.has_installments&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.status==="approved"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:`text-sm font-medium ${s.status==="approved"?"text-green-700":"text-red-700"}`,children:s.status==="approved"?"✅ Εγκεκριμένο":"❌ Απορριφθέν"}),e.jsx("span",{className:"text-xs text-gray-500",children:"(Διαχείριση δόσεων διαθέσιμη)"})]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:"Εγκεκριμένο"})]}),s.status==="rejected"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-semibold",children:"Απορριφθέν"})]})]})]})]})}),(s.status==="pending"||s.status==="approved"&&b(s.id)||s.status==="rejected"&&b(s.id))&&e.jsx("div",{className:`border-t border-slate-200 ${b(s.id)?"bg-yellow-50":"bg-slate-50"}`,children:e.jsxs("div",{className:"p-6 sm:p-7",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${b(s.id)?"bg-yellow-100":"bg-slate-100"}`,children:e.jsx(Zt,{className:`h-5 w-5 ${b(s.id)?"text-yellow-600":"text-slate-600"}`})}),e.jsx("h5",{className:`text-xl font-bold ${b(s.id)?"text-yellow-800":"text-slate-800"} flex items-center`,children:"🎛️ Επιλογές Προγράμματος"})]}),b(s.id)&&e.jsx("span",{className:"px-3 py-1 rounded-full bg-yellow-200 text-yellow-900 text-xs font-semibold",children:"🔒 Κλειδωμένο"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl border-2 ${b(s.id)?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200"}`,children:e.jsx("button",{onClick:()=>{var O;if(b(s.id)){c("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}ye(s.id,"oldMembers",!((O=k[s.id])!=null&&O.oldMembers))},className:`w-full p-3 rounded-full text-left transition-colors ${(U=k[s.id])!=null&&U.oldMembers||(_=R(s.id))!=null&&_.oldMembers?"bg-green-100 text-green-800 border-2 border-green-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":"bg-slate-100 text-slate-700 border-2 border-slate-200 hover:bg-slate-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ","👴 Παλαιά μέλη"]}),(((f=k[s.id])==null?void 0:f.oldMembers)||((Y=R(s.id))==null?void 0:Y.oldMembers))&&e.jsx("span",{className:"text-green-600",children:"✓"})]})})}),(()=>{var Ce,Bs,Ws,Hs;const O=((Ce=k[s.id])==null?void 0:Ce.oldMembers)||((Bs=R(s.id))==null?void 0:Bs.oldMembers),pe=((Ws=k[s.id])==null?void 0:Ws.first150Members)===!1||((Hs=R(s.id))==null?void 0:Hs.first150Members)===!1;return O&&!pe})()&&e.jsxs("div",{className:`p-3 rounded-xl border-2 ${b(s.id)?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"mb-3 text-xs text-gray-600 bg-blue-50 p-2 rounded-lg border border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"ℹ️ Πληροφορίες:"})," Ισχύει μόνο για τα πρώτα 150 παλιά μέλη του γυμναστηρίου με τιμή 45€ ετήσιος (προσφορά), τα οποία εμφανίζονται στην καρτέλα Ταμείο"]}),e.jsx("button",{onClick:()=>{if(b(s.id)){c("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}cr(O=>{var Bs,Ws,Hs,el,sl;const pe={...O},Ce=!((Bs=pe[s.id])!=null&&Bs.first150Members);return pe[s.id]={...pe[s.id],first150Members:Ce,cash:Ce?!0:((Ws=pe[s.id])==null?void 0:Ws.cash)||!1,cashAmount:Ce?45:(Hs=pe[s.id])==null?void 0:Hs.cashAmount,pos:Ce?!1:((el=pe[s.id])==null?void 0:el.pos)||!1,posAmount:Ce?0:(sl=pe[s.id])==null?void 0:sl.posAmount},pe})},className:`w-full px-4 py-3 rounded-full font-semibold transition-all duration-200 relative shadow ${(ne=k[s.id])!=null&&ne.first150Members||(F=R(s.id))!=null&&F.first150Members?"bg-orange-500 text-white hover:bg-orange-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"🏆 Πρώτα 150 Μέλη"}),(((oe=k[s.id])==null?void 0:oe.first150Members)||((cs=R(s.id))==null?void 0:cs.first150Members))&&e.jsx("span",{className:"text-orange-200",children:"✓"}),b(s.id)&&e.jsx("span",{className:"text-yellow-600",children:"🔒"})]})})]}),e.jsxs("div",{className:`p-3 rounded-xl border-2 ${b(s.id)?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[b(s.id)&&"🔒 ","🏋️ Kettlebell Points"]}),e.jsx("input",{type:"number",value:b(s.id)?((Ks=R(s.id))==null?void 0:Ks.kettlebellPoints)||"":((Nt=k[s.id])==null?void 0:Nt.kettlebellPoints)||"",onChange:O=>{b(s.id)||ye(s.id,"kettlebellPoints",O.target.value)},placeholder:"Εισάγετε πόντους",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,disabled:b(s.id)})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border-2 border-slate-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("span",{className:"text-2xl",children:"💳"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"SECTION ΠΛΗΡΩΜΩΝ"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-3 rounded-xl border-2 ${b(s.id)?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200"}`,children:[e.jsx("button",{onClick:()=>{var O,pe,Ce;if(b(s.id)){c("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}if((O=k[s.id])!=null&&O.first150Members||(pe=R(s.id))!=null&&pe.first150Members){c('Το Μετρητά είναι κλειδωμένο όταν είναι επιλεγμένο το "Πρώτα 150 Μέλη"',{icon:"🔒"});return}ye(s.id,"cash",!((Ce=k[s.id])!=null&&Ce.cash))},className:`w-full p-3 rounded-full text-left transition-colors ${(Vs=k[s.id])!=null&&Vs.first150Members||(q=R(s.id))!=null&&q.first150Members?"bg-gray-100 text-gray-500 border-2 border-gray-300 cursor-not-allowed":(G=k[s.id])!=null&&G.cash||(B=R(s.id))!=null&&B.cash?"bg-green-100 text-green-800 border-2 border-green-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":"bg-slate-100 text-slate-700 border-2 border-slate-200 hover:bg-slate-200"}`,disabled:b(s.id)||((ge=k[s.id])==null?void 0:ge.first150Members)||((ms=R(s.id))==null?void 0:ms.first150Members),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ",(((_t=k[s.id])==null?void 0:_t.first150Members)||((Pt=R(s.id))==null?void 0:Pt.first150Members))&&"🔒 ","💰 Μετρητά"]}),(((Yt=k[s.id])==null?void 0:Yt.cash)||((St=R(s.id))==null?void 0:St.cash))&&!((ea=k[s.id])!=null&&ea.first150Members||(sa=R(s.id))!=null&&sa.first150Members)&&e.jsx("span",{className:"text-green-600",children:"✓"})]})}),(((ta=k[s.id])==null?void 0:ta.cash)||((ra=R(s.id))==null?void 0:ra.cash))&&!((aa=k[s.id])!=null&&aa.first150Members||(la=R(s.id))!=null&&la.first150Members)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((na=R(s.id))==null?void 0:na.cashAmount)||"":((oa=k[s.id])==null?void 0:oa.cashAmount)||"",onChange:O=>{b(s.id)||ye(s.id,"cashAmount",parseFloat(O.target.value)||0)},placeholder:"Ποσό σε €",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-green-500 focus:border-green-500"}`,disabled:b(s.id)}),e.jsx("button",{onClick:()=>{b(s.id)},className:`mt-2 w-full px-3 py-1 text-sm rounded-lg ${b(s.id)?"bg-yellow-200 text-yellow-700 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,disabled:b(s.id),children:"✓ Επιλογή"})]})]}),e.jsxs("div",{className:`p-3 rounded-xl border-2 ${b(s.id)?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200"}`,children:[e.jsx("button",{onClick:()=>{var O,pe,Ce;if(b(s.id)){c("Οι επιλογές είναι παγωμένες - αλλάξτε status για να τις τροποποιήσετε",{icon:"🔒"});return}if((O=k[s.id])!=null&&O.first150Members||(pe=R(s.id))!=null&&pe.first150Members){c('Το POS είναι κλειδωμένο όταν είναι επιλεγμένο το "Πρώτα 150 Μέλη"',{icon:"🔒"});return}ye(s.id,"pos",!((Ce=k[s.id])!=null&&Ce.pos))},className:`w-full p-3 rounded-full text-left transition-colors ${(ia=k[s.id])!=null&&ia.pos||(da=R(s.id))!=null&&da.pos?"bg-blue-100 text-blue-800 border-2 border-blue-300":b(s.id)?"bg-yellow-100 text-yellow-700 border-2 border-yellow-300 cursor-not-allowed":(ca=k[s.id])!=null&&ca.first150Members||(ma=R(s.id))!=null&&ma.first150Members?"bg-gray-100 text-gray-500 border-2 border-gray-300 cursor-not-allowed":"bg-slate-100 text-slate-700 border-2 border-slate-200 hover:bg-slate-200"}`,disabled:b(s.id)||((xa=k[s.id])==null?void 0:xa.first150Members)||((ga=R(s.id))==null?void 0:ga.first150Members),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:[b(s.id)&&"🔒 ",(((ua=k[s.id])==null?void 0:ua.first150Members)||((ha=R(s.id))==null?void 0:ha.first150Members))&&"🔒 ","💳 POS"]}),(((ba=k[s.id])==null?void 0:ba.pos)||((pa=R(s.id))==null?void 0:pa.pos))&&e.jsx("span",{className:"text-blue-600",children:"✓"})]})}),(((fa=k[s.id])==null?void 0:fa.pos)||((ya=R(s.id))==null?void 0:ya.pos))&&e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((ja=R(s.id))==null?void 0:ja.posAmount)||"":((wa=k[s.id])==null?void 0:wa.posAmount)||"",onChange:O=>{b(s.id)||ye(s.id,"posAmount",parseFloat(O.target.value)||0)},placeholder:"Ποσό σε €",className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,disabled:b(s.id)}),e.jsx("button",{onClick:()=>{b(s.id)},className:`mt-2 w-full px-3 py-1 text-sm rounded-full ${b(s.id)?"bg-yellow-200 text-yellow-700 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,disabled:b(s.id),children:"✓ Επιλογή"})]})]})]})]}),s.has_installments&&lo(((va=s.package)==null?void 0:va.name)||"",s.duration_type)&&e.jsxs("div",{className:`col-span-2 p-4 rounded-lg border ${b(s.id)?"bg-yellow-100 border-yellow-300":"bg-orange-50 border-orange-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("span",{className:"text-2xl",children:"💳"}),e.jsxs("h4",{className:"text-lg font-semibold text-orange-800",children:[b(s.id)&&"🔒 ","Διαχείριση Δόσεων"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"1η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((Na=R(s.id))==null?void 0:Na.installment1Amount)||"":((_a=k[s.id])==null?void 0:_a.installment1Amount)||s.installment_1_amount||"",onChange:O=>{b(s.id)||ye(s.id,"installment1Amount",O.target.value)},placeholder:"Ποσό",disabled:b(s.id)||ce(s,1),className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,1)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("select",{value:b(s.id)?((Pa=R(s.id))==null?void 0:Pa.installment1PaymentMethod)||"cash":((Sa=k[s.id])==null?void 0:Sa.installment1PaymentMethod)||s.installment_1_payment_method||"cash",onChange:O=>{b(s.id)||ye(s.id,"installment1PaymentMethod",O.target.value)},disabled:b(s.id)||ce(s,1),className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,1)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((ka=R(s.id))==null?void 0:ka.installment1DueDate)||"":((Aa=k[s.id])==null?void 0:Aa.installment1DueDate)||s.installment_1_due_date||"",onChange:O=>{b(s.id)||ye(s.id,"installment1DueDate",O.target.value)},disabled:b(s.id)||ce(s,1),className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,1)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:ce(s,1),onChange:()=>Ht(s.id,1),className:"h-4 w-4 text-orange-600 border-gray-300 rounded",disabled:b(s.id)}),e.jsx("span",{className:"text-xs text-gray-600",children:"Κλείδωμα Δόσης"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"2η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?(($a=R(s.id))==null?void 0:$a.installment2Amount)||"":((Ca=k[s.id])==null?void 0:Ca.installment2Amount)||s.installment_2_amount||"",onChange:O=>{b(s.id)||ye(s.id,"installment2Amount",O.target.value)},placeholder:"Ποσό",disabled:b(s.id)||ce(s,2),className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,2)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("select",{value:b(s.id)?((Ma=R(s.id))==null?void 0:Ma.installment2PaymentMethod)||"cash":((Ua=k[s.id])==null?void 0:Ua.installment2PaymentMethod)||s.installment_2_payment_method||"cash",onChange:O=>{b(s.id)||ye(s.id,"installment2PaymentMethod",O.target.value)},disabled:b(s.id)||ce(s,2),className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,2)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((Da=R(s.id))==null?void 0:Da.installment2DueDate)||"":((Ia=k[s.id])==null?void 0:Ia.installment2DueDate)||s.installment_2_due_date||"",onChange:O=>{b(s.id)||ye(s.id,"installment2DueDate",O.target.value)},disabled:b(s.id)||ce(s,2),className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,2)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:ce(s,2),onChange:()=>Ht(s.id,2),className:"h-4 w-4 text-orange-600 border-gray-300 rounded",disabled:b(s.id)}),e.jsx("span",{className:"text-xs text-gray-600",children:"Κλείδωμα Δόσης"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"3η Δόση"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",value:b(s.id)?((Ea=R(s.id))==null?void 0:Ea.installment3Amount)||"":((Ta=k[s.id])==null?void 0:Ta.installment3Amount)||s.installment_3_amount||"",onChange:O=>{b(s.id)||ye(s.id,"installment3Amount",O.target.value)},placeholder:"Ποσό",disabled:b(s.id)||ce(s,3)||((La=k[s.id])==null?void 0:La.deleteThirdInstallment)||s.third_installment_deleted,className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,3)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":(Fa=k[s.id])!=null&&Fa.deleteThirdInstallment||s.third_installment_deleted?"bg-red-50 border-red-300 cursor-not-allowed text-red-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("select",{value:b(s.id)?((Oa=R(s.id))==null?void 0:Oa.installment3PaymentMethod)||"cash":((Ra=k[s.id])==null?void 0:Ra.installment3PaymentMethod)||s.installment_3_payment_method||"cash",onChange:O=>{b(s.id)||ye(s.id,"installment3PaymentMethod",O.target.value)},disabled:b(s.id)||ce(s,3)||((Ga=k[s.id])==null?void 0:Ga.deleteThirdInstallment)||s.third_installment_deleted,className:`w-full p-2 border rounded-lg ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,3)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":(za=k[s.id])!=null&&za.deleteThirdInstallment||s.third_installment_deleted?"bg-red-50 border-red-300 cursor-not-allowed text-red-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`,children:[e.jsx("option",{value:"cash",children:"💰 Μετρητά"}),e.jsx("option",{value:"pos",children:"💳 POS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"📅 Ημερομηνία Πληρωμής"}),e.jsx("input",{type:"date",value:b(s.id)?((Ka=R(s.id))==null?void 0:Ka.installment3DueDate)||"":((Va=k[s.id])==null?void 0:Va.installment3DueDate)||s.installment_3_due_date||"",onChange:O=>{b(s.id)||ye(s.id,"installment3DueDate",O.target.value)},disabled:b(s.id)||ce(s,3)||((Ba=k[s.id])==null?void 0:Ba.deleteThirdInstallment)||s.third_installment_deleted,className:`w-full p-2 border rounded-lg text-sm ${b(s.id)?"bg-yellow-100 border-yellow-300 cursor-not-allowed":ce(s,3)?"bg-orange-50 border-orange-300 cursor-not-allowed text-orange-600":(Wa=k[s.id])!=null&&Wa.deleteThirdInstallment||s.third_installment_deleted?"bg-red-50 border-red-300 cursor-not-allowed text-red-600":"border-gray-300 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}`}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:ce(s,3),onChange:()=>Ht(s.id,3),disabled:((Ha=k[s.id])==null?void 0:Ha.deleteThirdInstallment)||s.third_installment_deleted||b(s.id),className:"h-4 w-4 text-orange-600 border-gray-300 rounded"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Κλείδωμα Δόσης"})]}),e.jsx("button",{type:"button",onClick:()=>pn(s.id),disabled:b(s.id),className:`text-xs px-2 py-1 rounded-md ${b(s.id)?"bg-yellow-200 text-yellow-700 cursor-not-allowed":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:"Διαγραφή 3ης Δόσης"})]})]})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-orange-100 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-orange-800",children:"Σύνολο Δόσεων:"}),e.jsx("span",{className:"text-lg font-bold text-orange-900",children:Re((Number(((Ya=k[s.id])==null?void 0:Ya.installment1Amount)||0)||Number(((Qa=R(s.id))==null?void 0:Qa.installment1Amount)||0))+(Number(((Ja=k[s.id])==null?void 0:Ja.installment2Amount)||0)||Number(((Za=R(s.id))==null?void 0:Za.installment2Amount)||0))+(Number(((Xa=k[s.id])==null?void 0:Xa.installment3Amount)||0)||Number(((qa=R(s.id))==null?void 0:qa.installment3Amount)||0)))})]}),e.jsxs("div",{className:"text-sm text-orange-700 mt-1",children:["Από ",Re(s.requested_price)," (Πακέτο Ultimate)"]})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>yt(s.id,"approved"),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${is[s.id]==="approved"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:"✅ Έγκριση Πληρωμής"}),e.jsx("button",{onClick:()=>yt(s.id,"rejected"),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${is[s.id]==="rejected"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:"❌ Απόρριψη Πληρωμής"}),e.jsx("button",{onClick:()=>yt(s.id,"pending"),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${is[s.id]==="pending"?"bg-yellow-600 text-white":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,children:"⏳ Αναμονή/Πάγωμα Πληρωμής"}),e.jsxs("button",{onClick:()=>sn(s.id),disabled:W||is[s.id]==="none",className:"px-4 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[W?e.jsx(qs,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Αποθήκευση Program Options"]})]})]})})]},s.id)})})]})})]})]}),p==="pilates-schedule"&&!W&&e.jsx(no,{}),p==="cash-register"&&!W&&e.jsx(co,{}),p==="users-information"&&!W&&e.jsx(uo,{}),p==="kettlebell-points"&&!W&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 rounded-xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:"🏋️‍♂️ Kettlebell Points Ranking"}),e.jsx("p",{className:"text-orange-100 text-sm sm:text-base",children:"Συνολικοί βαθμοί και κατάταξη χρηστών"})]}),e.jsxs("button",{onClick:jt,className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg text-sm",children:[e.jsx(Xs,{className:"h-4 w-4"}),e.jsx("span",{children:"🔄 Ανανέωση"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"📊 Συνολικοί Βαθμοί"}),e.jsx("p",{className:"text-blue-600",children:"Όλοι οι χρήστες συνολικά"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-blue-900",children:at}),e.jsx("div",{className:"text-sm text-blue-600",children:"βαθμοί"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"🏆 Κατάταξη Χρηστών"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Βαθμοί Kettlebell ανά χρήστη"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Αναζήτηση χρήστη...",value:ze,onChange:s=>yr(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),ze&&e.jsx("button",{onClick:()=>yr(""),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 ml-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:rs,onChange:s=>ot(s.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),e.jsx("span",{className:"text-gray-500 text-sm",children:"—"}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:as,onChange:s=>it(s.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),e.jsx("button",{onClick:()=>{ns(1),jt()},className:"px-3 py-2 bg-orange-600 text-white rounded-lg text-sm hover:bg-orange-700",children:"Φίλτρο"})]})]})]})}),e.jsx("div",{className:"p-6",children:Oe.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Xs,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν υπάρχουν βαθμοί Kettlebell ακόμα"}),e.jsx("p",{className:"text-sm mt-2",children:"Οι βαθμοί θα εμφανιστούν εδώ όταν δημιουργηθούν προγράμματα με Kettlebell Points"})]}):e.jsxs("div",{className:"space-y-4",children:[(ze?Cs:dn).map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ${t===0?"bg-yellow-500":t===1?"bg-gray-400":t===2?"bg-orange-500":"bg-blue-500"}`,children:ze?Oe.findIndex(r=>r.user_id===s.user_id)+1:vt+t+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.user_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.user_email}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.points_count," ",s.points_count===1?"πρόγραμμα":"προγράμματα"," • Τελευταία ενημέρωση: ",new Date(s.last_updated).toLocaleDateString("el-GR")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.total_points}),e.jsx("div",{className:"text-sm text-gray-600",children:"βαθμοί"})]})]})},s.user_id)),ze&&Cs.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Be,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Δεν βρέθηκαν χρήστες με αυτό το όνομα"}),e.jsx("p",{className:"text-sm mt-2",children:"Δοκιμάστε ένα διαφορετικό όρο αναζήτησης"})]}),!ze&&wt>1&&e.jsxs("div",{className:"flex items-center justify-between py-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Εμφανίζονται ",vt+1,"-",Math.min(jr,Oe.length)," από ",Oe.length," χρήστες"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:cn,disabled:ls===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"← Προηγούμενη"}),e.jsxs("span",{className:"px-3 py-2 text-sm text-gray-700",children:["Σελίδα ",ls," από ",wt]}),e.jsx("button",{onClick:mn,disabled:ls===wt,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Επόμενη →"})]})]})]})})]})]}),p!=="personal-training"&&p!=="membership-packages"&&p!=="ultimate-subscriptions"&&p!=="pilates-schedule"&&p!=="kettlebell-points"&&p!=="cash-register"&&!W&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Αυτή η κατηγορία θα υλοποιηθεί σύντομα."})})]})]}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-t-xl sm:rounded-t-2xl p-4 sm:p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-2xl font-bold mb-1 sm:mb-2",children:"🏋️‍♂️ Δημιουργία Προγράμματος"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Δημιουργήστε νέο πρόγραμμα Personal Training"})]}),e.jsx("button",{onClick:()=>re(!1),className:"text-white/80 hover:text-white hover:bg-white/20 rounded-full p-2 transition-all duration-200 flex-shrink-0 ml-2",children:e.jsx(Ke,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})}),e.jsxs("div",{className:"p-4 sm:p-8",children:[e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 sm:p-6 border border-indigo-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-indigo-800 mb-3 sm:mb-4 flex items-center",children:"🏋️‍♂️ Τύπος Προπόνησης"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>_e("individual"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${n==="individual"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"👤 Ατομικό"}),e.jsx("button",{type:"button",onClick:()=>_e("group"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${n==="group"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"👥 Group"}),e.jsx("button",{type:"button",onClick:()=>_e("combination"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${n==="combination"?"bg-indigo-600 text-white shadow-lg":"bg-white text-indigo-600 border-2 border-indigo-200 hover:border-indigo-400"}`,children:"🔀 Συνδυασμός"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-4 sm:p-6 border border-blue-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-blue-800 mb-3 sm:mb-4 flex items-center",children:"👥 Τύπος Χρήστη"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>X("personal"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${ae==="personal"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🏋️‍♂️ Personal User"}),n!=="combination"&&e.jsx("button",{type:"button",onClick:()=>X("paspartu"),className:`px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg transition-all duration-200 ${ae==="paspartu"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🎯 Paspartu User"})]}),e.jsx("div",{className:"mt-3 text-sm text-blue-700",children:n==="combination"?e.jsx("span",{children:"📋 Combination Training: Μόνο Personal Users - κλειδωμένο πρόγραμμα με συγκεκριμένες ώρες"}):ae==="personal"?e.jsx("span",{children:"📋 Personal Users: Παίρνουν κλειδωμένο πρόγραμμα με συγκεκριμένες ώρες"}):e.jsx("span",{children:"💳 Paspartu Users: Παίρνουν 5 μαθήματα και επιλέγουν ελεύθερα τις ώρες"})})]}),n==="combination"&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 sm:p-6 border border-purple-200",children:[e.jsx("label",{className:"block text-base sm:text-lg font-bold text-purple-800 mb-3 sm:mb-4 flex items-center",children:"🔀 Διαμόρφωση Συνδυασμού"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[e.jsx("label",{className:"block text-sm font-bold text-purple-700 mb-2",children:"👤 Ατομικές Σεσίες"}),e.jsx("select",{value:le,onChange:s=>K(parseInt(s.target.value)),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs("option",{value:s,children:[s," σεσίες"]},s))})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[e.jsx("label",{className:"block text-sm font-bold text-purple-700 mb-2",children:"👥 Ομαδικές Σεσίες"}),e.jsx("select",{value:a,onChange:s=>V(parseInt(s.target.value)),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[1,2,3,4,5].map(s=>e.jsxs("option",{value:s,children:[s," ",s===1?"φορά":"φορές","/εβδομάδα"]},s))})]})]}),e.jsxs("div",{className:"mt-3 text-sm text-purple-700 bg-purple-100 p-3 rounded-lg",children:[e.jsx("strong",{children:"📊 Σύνολο:"})," ",le," ατομικές σεσίες + ",a," ",a===1?"φορά":"φορές","/εβδομάδα ομαδικές"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("label",{className:"block text-lg font-bold text-blue-800 mb-4 flex items-center",children:["👤 ",n==="individual"?"Επιλογή Χρήστη":n==="combination"?"Επιλογή Χρήστη (Συνδυασμός)":"Επιλογή Χρηστών (Group)",(n==="individual"||n==="combination")&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded",children:["Selected: ",m.selectedUserId?"✅":"❌"]})]}),e.jsxs("div",{className:"flex space-x-3 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>gs("dropdown"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${xs==="dropdown"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"📋 Dropdown"}),e.jsx("button",{type:"button",onClick:()=>gs("search"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${xs==="search"?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-600 border-2 border-blue-200 hover:border-blue-400"}`,children:"🔍 Αναζήτηση"})]}),xs==="dropdown"?n==="individual"||n==="combination"?e.jsxs("select",{className:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-gray-700",value:m.selectedUserId,onChange:s=>{console.log("[AdminPanel] User selected:",s.target.value),ve({...m,selectedUserId:s.target.value})},children:[e.jsx("option",{value:"",children:"-- Επιλέξτε χρήστη --"}),A.length>0?A.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName," (",s.email,")"]},s.id)):e.jsx("option",{value:"",disabled:!0,children:"Δεν υπάρχουν χρήστες"})]}):e.jsx("div",{className:"max-h-48 overflow-y-auto border-2 border-blue-200 rounded-xl bg-white",children:je.length>0?je.map(s=>e.jsx("div",{className:`p-3 hover:bg-blue-50 cursor-pointer border-b border-blue-100 last:border-b-0 transition-all duration-200 ${g.includes(s.id)?"bg-blue-100 border-l-4 border-l-blue-500":""}`,onClick:()=>{g.includes(s.id)?he(t=>t.filter(r=>r!==s.id)):he(t=>[...t,s.id])},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:g.includes(s.id),onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.email})]})]})},s.id)):e.jsx("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Δεν υπάρχουν χρήστες"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",className:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-gray-700 placeholder-gray-400",placeholder:"🔍 Αναζήτηση με όνομα ή email...",value:Fe,onChange:s=>Ps(s.target.value)}),Fe&&e.jsx("div",{className:"max-h-48 overflow-y-auto border-2 border-blue-200 rounded-xl bg-white shadow-lg",children:ur.length>0?ur.map(s=>e.jsxs("div",{className:`p-4 hover:bg-blue-50 cursor-pointer border-b border-blue-100 last:border-b-0 transition-all duration-200 ${n==="individual"||n==="combination"?m.selectedUserId===s.id?"bg-blue-100 border-l-4 border-l-blue-500":"":g.includes(s.id)?"bg-blue-100 border-l-4 border-l-blue-500":""}`,onClick:()=>{n==="individual"||n==="combination"?ve({...m,selectedUserId:s.id}):g.includes(s.id)?he(t=>t.filter(r=>r!==s.id)):he(t=>[...t,s.id])},children:[n==="group"&&e.jsx("input",{type:"checkbox",checked:g.includes(s.id),onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.email})]},s.id)):e.jsx("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Δεν βρέθηκαν χρήστες"})})]}),(n==="individual"||n==="combination"?m.selectedUserId:g.length>0)&&e.jsx("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white text-sm",children:"✓"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold text-green-800",children:["✅ ",n==="individual"||n==="combination"?"Επιλεγμένος:":"Επιλεγμένοι:"]}),n==="individual"||n==="combination"?e.jsxs("div",{className:"text-xs text-green-600",children:[(_r=A.find(s=>s.id===m.selectedUserId))==null?void 0:_r.firstName," ",(Pr=A.find(s=>s.id===m.selectedUserId))==null?void 0:Pr.lastName," (",(Sr=A.find(s=>s.id===m.selectedUserId))==null?void 0:Sr.email,")"]}):e.jsxs("div",{className:"text-xs text-green-600",children:[g.map(s=>{const t=A.find(r=>r.id===s);return t?`${t.firstName} ${t.lastName}`:"Άγνωστος"}).join(", ")," (",g.length," χρήστες)"]})]})]})})]}),(n==="group"&&g.length>0||n==="combination"&&m.selectedUserId)&&e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-4 sm:p-6 border border-orange-200 mt-4",children:[e.jsxs("h4",{className:"text-lg sm:text-xl font-bold text-orange-800 mb-4 sm:mb-6 flex items-center",children:["🏠 ",n==="combination"?"Επιλογές Ομαδικής Αίθουσας (για Group Sessions)":"Επιλογές Ομαδικής Αίθουσας"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-purple-600",children:"💡"}),e.jsxs("div",{className:"text-sm text-purple-700",children:[e.jsx("strong",{children:"Νέα Λειτουργία:"})," Θα επιλέξετε το Group Size (2, 3, 6, ή 10 άτομα) για κάθε σεσία ξεχωριστά στη Διαχείριση Ομαδικών Αναθέσεων"]})]})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold text-orange-700 mb-3",children:"Πόσες φορές την εβδομάδα θα παρακολουθούν οι χρήστες;"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>Z(s),className:`p-3 rounded-lg border-2 transition-all duration-200 ${v===s?"bg-orange-600 text-white border-orange-600 shadow-lg":"bg-white text-orange-600 border-orange-300 hover:border-orange-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold",children:s}),e.jsxs("div",{className:"text-xs opacity-75",children:[s===1?"φορά":"φορές","/εβδομάδα"]})]})},s))})]})}),u&&v&&e.jsx("div",{className:"bg-orange-100 border border-orange-300 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Μηνιαίο Σύνολο"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[Pe," συνεδρίες/μήνα"]}),e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(",v," φορές/εβδομάδα × 4 εβδομάδες)"]})]})}),u&&v&&e.jsx(Wn,{selectedGroupRoom:u,weeklyFrequency:v,monthlyTotal:Pe,selectedUserIds:n==="combination"?[m.selectedUserId]:g,onSlotsChange:de})]})]}),(n==="individual"||n==="combination"?m.selectedUserId:g.length>0)&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 sm:p-6 border border-purple-200 mt-4",children:[e.jsx("h4",{className:"text-lg sm:text-xl font-bold text-purple-800 mb-4 sm:mb-6 flex items-center",children:"⚙️ Επιλογές Προγράμματος"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[!(n==="individual"||n==="combination"?bs.has(m.selectedUserId):g.some(s=>bs.has(s)))&&e.jsx("div",{className:`rounded-lg p-4 border ${(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(r=>j(r))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ge(r=>{const l={...r};return s.forEach(i=>{var y,C,U,_,f,Y;const x=!((y=l[i])!=null&&y.oldMembers);l[i]={...l[i],oldMembers:x,first150Members:x?(C=l[i])==null?void 0:C.first150Members:!1,cash:x?(U=l[i])==null?void 0:U.cash:!1,pos:x?(_=l[i])==null?void 0:_.pos:!1,cashAmount:x?(f=l[i])==null?void 0:f.cashAmount:void 0,posAmount:x?(Y=l[i])==null?void 0:Y.posAmount:void 0}}),l})},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 relative shadow-lg ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(kr=Ae(m.selectedUserId))!=null&&kr.oldMembers?"bg-green-500 text-white":"bg-blue-500 text-white":(Ar=E[m.selectedUserId])!=null&&Ar.oldMembers?"bg-green-500 text-white hover:bg-green-600":"bg-blue-500 text-white hover:bg-blue-600":g.some(s=>{var t;return(t=E[s])==null?void 0:t.oldMembers})?"bg-green-500 text-white hover:bg-green-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"👴 Παλαιά μέλη"}),((n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?($r=Ae(m.selectedUserId))==null?void 0:$r.oldMembers:(Cr=E[m.selectedUserId])==null?void 0:Cr.oldMembers:g.some(s=>{var t;return(t=E[s])==null?void 0:t.oldMembers}))&&e.jsx("span",{className:"text-green-200",children:"✓"}),(n==="individual"?j(m.selectedUserId):g.some(s=>j(s)))&&e.jsx("span",{className:"text-yellow-600",children:"🔒"})]})})}),(()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g,t=s.some(i=>{var x;return(x=E[i])==null?void 0:x.oldMembers}),r=s.some(i=>bs.has(i)||tt.has(i)),l=s.some(i=>{var x;return((x=E[i])==null?void 0:x.oldMembers)===!1});return t&&!r&&!l})()&&e.jsxs("div",{className:`rounded-lg p-4 border ${(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"mb-3 text-xs text-gray-600 bg-blue-50 p-2 rounded-lg border border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"ℹ️ Πληροφορίες:"})," Ισχύει μόνο για τα πρώτα 150 παλιά μέλη του γυμναστηρίου με τιμή 45€ ετήσιος (προσφορά), τα οποία εμφανίζονται στην καρτέλα Ταμείο"]}),e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(r=>j(r))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ge(r=>{const l={...r};return s.forEach(i=>{var y,C,U,_,f;const x=!((y=l[i])!=null&&y.first150Members);l[i]={...l[i],first150Members:x,cash:x?!0:((C=l[i])==null?void 0:C.cash)||!1,cashAmount:x?45:(U=l[i])==null?void 0:U.cashAmount,pos:x?!1:((_=l[i])==null?void 0:_.pos)||!1,posAmount:x?0:(f=l[i])==null?void 0:f.posAmount}}),l})},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 relative shadow-lg ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(Mr=Ae(m.selectedUserId))!=null&&Mr.first150Members?"bg-orange-500 text-white":"bg-blue-500 text-white":(Ur=E[m.selectedUserId])!=null&&Ur.first150Members?"bg-orange-500 text-white hover:bg-orange-600":"bg-blue-500 text-white hover:bg-blue-600":g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})?"bg-orange-500 text-white hover:bg-orange-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"🏆 Πρώτα 150 Μέλη"}),((n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(Dr=Ae(m.selectedUserId))==null?void 0:Dr.first150Members:(Ir=E[m.selectedUserId])==null?void 0:Ir.first150Members:g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members}))&&e.jsx("span",{className:"text-orange-200",children:"✓"}),(n==="individual"?j(m.selectedUserId):g.some(s=>j(s)))&&e.jsx("span",{className:"text-yellow-600",children:"🔒"})]})})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["🏋️‍♂️ Kettlebell Points",(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),e.jsx("input",{type:"number",value:(n==="individual"||n==="combination")&&m.selectedUserId&&j(m.selectedUserId)?((Er=Ae(m.selectedUserId))==null?void 0:Er.kettlebellPoints)||"":$s,onChange:s=>{const t=n==="individual"?[m.selectedUserId]:g;if(t.some(l=>j(l))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}ts(s.target.value),Ge(l=>{const i={...l};return t.forEach(x=>{i[x]={...i[x],kettlebellPoints:s.target.value||""}}),i})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(n==="individual"?j(m.selectedUserId):g.some(s=>j(s)))?"border-yellow-300 bg-yellow-50 focus:ring-yellow-500":"border-gray-300 focus:ring-purple-500 focus:border-purple-500"}`,placeholder:"Εισάγετε αριθμό...",disabled:n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s))})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["💰 Μετρητά (€)",(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),ml?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",value:(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?((Rr=(Or=Ae(m.selectedUserId))==null?void 0:Or.cashAmount)==null?void 0:Rr.toString())||"":(Gr=E[m.selectedUserId])!=null&&Gr.first150Members?"45":Ye:g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})?"45":Ye,onChange:s=>{const t=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(t.some(i=>j(i))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}if(t.some(i=>{var x;return(x=E[i])==null?void 0:x.first150Members})){c('Το πεδίο Μετρητά είναι κλειδωμένο όταν είναι επιλεγμένο "Πρώτα 150 Μέλη"',{icon:"🔒"});return}ct(s.target.value)},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(n==="individual"?j(m.selectedUserId)||(zr=E[m.selectedUserId])!=null&&zr.first150Members:g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members}))?"border-orange-300 bg-orange-50 focus:ring-orange-500":"border-gray-300 focus:ring-green-500 focus:border-green-500"}`,placeholder:"Εισάγετε ποσό σε €...",autoFocus:!0,disabled:n==="individual"||n==="combination"?j(m.selectedUserId)||((Kr=E[m.selectedUserId])==null?void 0:Kr.first150Members):g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(r=>j(r))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ge(r=>{const l={...r};return s.forEach(i=>{const x=Ye&&parseFloat(Ye)>0?parseFloat(Ye):0;l[i]={...l[i],cash:x>0,cashAmount:x}}),l}),Ye&&parseFloat(Ye)>0?c.success(`Μετρητά €${Ye} προστέθηκαν! Θα αποθηκευτούν με το Save.`):c.success("Μετρητά μηδενίστηκαν! Θα αποθηκευτεί με το Save."),Ut(!1),ct("")},className:`flex-1 px-3 py-2 text-white rounded-lg transition-colors text-sm ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(Vr=Ae(m.selectedUserId))!=null&&Vr.cash?"bg-green-600 cursor-not-allowed":"bg-yellow-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700":g.some(s=>j(s))?"bg-yellow-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,disabled:n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)),children:"✓ Επιλογή"}),e.jsx("button",{type:"button",onClick:()=>{Ut(!1),ct("")},className:"flex-1 px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Ακύρωση"})]})]}):e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(l=>j(l))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}if(s.some(l=>{var i;return(i=E[l])==null?void 0:i.first150Members})){c('Το πεδίο Μετρητά είναι κλειδωμένο όταν είναι επιλεγμένο "Πρώτα 150 Μέλη"',{icon:"🔒"});return}Ut(!0)},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(Tr=Ae(m.selectedUserId))!=null&&Tr.cash?"bg-green-500 text-white cursor-not-allowed":"bg-yellow-500 text-white cursor-not-allowed":(Lr=E[m.selectedUserId])!=null&&Lr.first150Members?"bg-orange-500 text-white cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600":g.some(s=>j(s))?"bg-yellow-500 text-white cursor-not-allowed":g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})?"bg-orange-500 text-white cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"}`,disabled:n==="individual"||n==="combination"?j(m.selectedUserId)||((Fr=E[m.selectedUserId])==null?void 0:Fr.first150Members):g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members}),children:"💰 Μετρητά"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))?"bg-yellow-100 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["💳 POS (€)",(n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)))&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"🔒"})]}),xl?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",value:(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?((Qr=(Yr=Ae(m.selectedUserId))==null?void 0:Yr.posAmount)==null?void 0:Qr.toString())||"":(Jr=E[m.selectedUserId])!=null&&Jr.first150Members?"0":Qe:g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})?"0":Qe,onChange:s=>{const t=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(t.some(i=>j(i))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}if(t.some(i=>{var x;return(x=E[i])==null?void 0:x.first150Members})){c('Το πεδίο POS είναι κλειδωμένο όταν είναι επιλεγμένο "Πρώτα 150 Μέλη"',{icon:"🔒"});return}mt(s.target.value)},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${(n==="individual"?j(m.selectedUserId)||(Zr=E[m.selectedUserId])!=null&&Zr.first150Members:g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members}))?"border-orange-300 bg-orange-50 focus:ring-orange-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Εισάγετε ποσό σε €...",autoFocus:!0,disabled:n==="individual"||n==="combination"?j(m.selectedUserId)||((Xr=E[m.selectedUserId])==null?void 0:Xr.first150Members):g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(r=>j(r))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}Ge(r=>{const l={...r};return s.forEach(i=>{const x=Qe&&parseFloat(Qe)>0?parseFloat(Qe):0;l[i]={...l[i],pos:x>0,posAmount:x}}),l}),Qe&&parseFloat(Qe)>0?c.success(`POS €${Qe} προστέθηκε! Θα αποθηκευτεί με το Save.`):c.success("POS μηδενίστηκε! Θα αποθηκευτεί με το Save."),Dt(!1),mt("")},className:`flex-1 px-3 py-2 text-white rounded-lg transition-colors text-sm ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(qr=Ae(m.selectedUserId))!=null&&qr.pos?"bg-blue-600 cursor-not-allowed":"bg-yellow-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700":g.some(s=>j(s))?"bg-yellow-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,disabled:n==="individual"||n==="combination"?j(m.selectedUserId):g.some(s=>j(s)),children:"✓ Επιλογή"}),e.jsx("button",{type:"button",onClick:()=>{Dt(!1),mt("")},className:"flex-1 px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm",children:"Ακύρωση"})]})]}):e.jsx("button",{type:"button",onClick:()=>{const s=n==="individual"||n==="combination"?[m.selectedUserId]:g;if(s.some(l=>j(l))){c("Οι επιλογές είναι παγωμένες - αλλάξτε το status για να τις τροποποιήσετε",{icon:"🔒"});return}if(s.some(l=>{var i;return(i=E[l])==null?void 0:i.first150Members})){c('Το πεδίο POS είναι κλειδωμένο όταν είναι επιλεγμένο "Πρώτα 150 Μέλη"',{icon:"🔒"});return}Dt(!0)},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg ${(n==="individual"||n==="combination")&&m.selectedUserId?j(m.selectedUserId)?(Br=Ae(m.selectedUserId))!=null&&Br.pos?"bg-blue-500 text-white cursor-not-allowed":"bg-yellow-500 text-white cursor-not-allowed":(Wr=E[m.selectedUserId])!=null&&Wr.first150Members?"bg-orange-500 text-white cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600":g.some(s=>j(s))?"bg-yellow-500 text-white cursor-not-allowed":g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members})?"bg-orange-500 text-white cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,disabled:n==="individual"||n==="combination"?j(m.selectedUserId)||((Hr=E[m.selectedUserId])==null?void 0:Hr.first150Members):g.some(s=>j(s))||g.some(s=>{var t;return(t=E[s])==null?void 0:t.first150Members}),children:"💳 POS"})]}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{xt("approved")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${Ne==="approved"?"bg-green-600 text-white shadow-lg":"bg-green-500 text-white hover:bg-green-600 shadow-lg"}`,children:"✅ Έγκριση Πληρωμής"})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{xt("rejected")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${Ne==="rejected"?"bg-red-600 text-white shadow-lg":"bg-red-500 text-white hover:bg-red-600 shadow-lg"}`,children:"❌ Απόρριψη Πληρωμής"})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("button",{type:"button",onClick:()=>{xt("pending")},className:`w-full px-4 py-3 rounded-lg font-semibold transition-all duration-200 ${Ne==="pending"?"bg-yellow-600 text-white shadow-lg":"bg-yellow-500 text-white hover:bg-yellow-600 shadow-lg"}`,children:"⏳ Αναμονή/Πάγωμα Πληρωμής"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4 border border-purple-200",children:[e.jsx("button",{type:"button",onClick:Rl,disabled:Ne==="none"||W,className:`w-full px-6 py-4 rounded-lg font-bold text-lg transition-all duration-200 ${Ne==="none"||W?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 shadow-lg hover:shadow-xl"}`,children:W?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(qs,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Αποθήκευση..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Zs,{className:"h-5 w-5"}),e.jsx("span",{children:"💾 Αποθήκευση Program Options"})]})}),Ne==="none"&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:"Επιλέξτε Έγκριση, Απόρριψη ή Στην Αναμονή για να αποθηκεύσετε"})]})]})]}),n!=="group"&&e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-4 sm:p-6 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[e.jsxs("h4",{className:"text-lg sm:text-xl font-bold text-orange-800 flex items-center",children:["🏋️‍♂️ Προσωποποιημένο Πρόγραμμα",n==="combination"&&e.jsx("span",{className:"ml-2 text-sm bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:"Personal Sessions"})]}),e.jsxs("div",{className:`text-sm px-3 py-2 rounded-lg ${n==="combination"&&xe().length>le?"bg-red-100 text-red-700 border border-red-300":"text-gray-600 bg-gray-100"}`,children:["📊 Σύνολο: ",xe().length," σεσίας",n==="combination"&&e.jsxs("span",{className:`ml-2 ${xe().length>le?"text-red-600":"text-purple-600"}`,children:["(",le," θα χρησιμοποιηθούν)",xe().length>le&&e.jsx("span",{className:"ml-1 font-bold",children:"⚠️ Περισσότερες από όσες θα χρησιμοποιηθούν!"})]})]})]}),e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Φίλτρο Σεσιών:"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{Ft("new"),nr.length===0&&Lt([{id:"tmp-1",date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"18:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:""}])},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${Je==="new"?"bg-blue-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"🆕 Νέες Σεσίες"}),e.jsxs("button",{onClick:()=>{Ft("existing"),(n==="individual"||n==="combination")&&m.selectedUserId&&br(m.selectedUserId)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${Je==="existing"?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:!m.selectedUserId,children:["📚 Υπάρχουσες Σεσίες",or&&e.jsx("span",{className:"ml-2",children:"⏳"})]})]}),Je==="existing"&&gt.length>0&&e.jsxs("div",{className:"text-sm text-green-600 bg-green-100 px-3 py-1 rounded-lg",children:["✅ ",gt.length," υπάρχουσες σεσίες φορτώθηκαν"]}),Je==="existing"&&gt.length===0&&!or&&e.jsx("div",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-lg",children:"ℹ️ Δεν βρέθηκαν υπάρχουσες σεσίες"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border-2 border-gray-300 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 border-b-2 border-gray-400",children:e.jsxs("div",{className:`grid gap-0 text-sm font-bold text-gray-800 ${n==="individual"?"grid-cols-6":"grid-cols-7"}`,children:[e.jsx("div",{className:"col-span-1 text-center py-3 border-r border-gray-300 bg-gray-200",children:"#"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"📅 Ημερομηνία"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"🕐 Έναρξη"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"💪 Τύπος"}),e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"🏠 Αίθουσα"}),n!=="individual"&&e.jsx("div",{className:"col-span-1 py-3 px-2 border-r border-gray-300",children:"👥 Group"}),e.jsx("div",{className:"col-span-1 py-3 px-2",children:"👨‍🏫 Προπονητής"})]})}),e.jsx("div",{className:"divide-y divide-gray-300",children:xe().map((s,t)=>e.jsxs("div",{className:`grid gap-0 hover:bg-blue-50 transition-colors ${n==="individual"?"grid-cols-6":"grid-cols-7"}`,children:[e.jsxs("div",{className:"col-span-1 flex items-center justify-center space-x-2 py-3 border-r border-gray-300 bg-gray-50",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700",children:t+1}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>Le(xe().filter((r,l)=>l!==t)),className:"text-red-600 hover:text-red-800 p-1 text-xs bg-red-100 rounded hover:bg-red-200",title:"Διαγραφή Σέσιας",children:e.jsx(et,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>{const r=xe(),l={...s,id:`tmp-${Date.now()}`};Le([...r.slice(0,t+1),l,...r.slice(t+1)])},className:"text-blue-600 hover:text-blue-800 p-1 text-xs bg-blue-100 rounded hover:bg-blue-200",title:"Αντιγραφή Σέσιας",children:e.jsx(Ct,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsx("input",{type:"date",className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.date,onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,date:r.target.value}:i))},lang:"el"})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsx("input",{type:"time",className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.startTime,onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,startTime:r.target.value}:i))}})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.type,onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,type:r.target.value}:i))},children:[e.jsx("option",{value:"personal",children:"Προσωπική"}),e.jsx("option",{value:"kickboxing",children:"Kick Boxing"}),e.jsx("option",{value:"combo",children:"Combo"})]})}),e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.room,onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,room:r.target.value}:i))},children:[e.jsx("option",{value:"Αίθουσα Mike",children:"Αίθουσα Mike"}),e.jsx("option",{value:"Αίθουσα Jordan",children:"Αίθουσα Jordan"})]})}),n!=="individual"&&e.jsx("div",{className:"col-span-1 p-2 border-r border-gray-300",children:n==="combination"?e.jsx("div",{className:"w-full px-2 py-2 text-sm border-2 border-gray-200 rounded bg-gray-100 text-gray-600 font-medium",children:"🔒 1 άτομο (Ατομική)"}):e.jsxs("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.group||"",onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,group:r.target.value}:i))},children:[e.jsx("option",{value:"",children:"Επιλέξτε Group"}),e.jsx("option",{value:"2ΑτομαGroup",children:"2ΑτομαGroup"}),e.jsx("option",{value:"3ΑτομαGroup",children:"3ΑτομαGroup"}),e.jsx("option",{value:"6ΑτομαGroup",children:"6ΑτομαGroup"})]})}),e.jsx("div",{className:"col-span-1 p-2",children:e.jsx("select",{className:"w-full px-2 py-2 text-sm border-2 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:s.trainer,onChange:r=>{const l=xe();Le(l.map((i,x)=>x===t?{...i,trainer:r.target.value}:i))},children:nl.map(r=>e.jsx("option",{value:r,children:r},r))})})]},s.id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mt-4 space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>{var t;const s=xe();if(n==="combination"&&s.length>=le){c.error(`Για συνδυασμένο πρόγραμμα μπορείτε να έχετε μέγιστο ${le} ατομικές σεσίες`);return}Le([...s,{id:`tmp-${Date.now()}`,date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:n==="combination"?void 0:"2ΑτομαGroup",notes:((t=s[0])==null?void 0:t.notes)||""}])},children:"➕ Προσθήκη Σέσιας"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>{var r;const s=xe();if(n==="combination"&&s.length>=le){c.error(`Για συνδυασμένο πρόγραμμα μπορείτε να έχετε μέγιστο ${le} ατομικές σεσίες`);return}const t={id:`tmp-${Date.now()}`,date:`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`,startTime:"19:00",type:"personal",trainer:"Mike",room:"Αίθουσα Mike",group:"2ΑτομαGroup",notes:((r=s[0])==null?void 0:r.notes)||""};Le([...s,t])},children:"📋 Αντιγραφή Τελευταίας"}),xe().length>1&&e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-medium flex items-center justify-center",onClick:()=>{const s=xe();Le(s.slice(0,-1))},children:"➖ Διαγραφή Τελευταίας"})]}),e.jsx("div",{className:"text-center sm:text-right",children:e.jsx("div",{className:"text-xs text-gray-500",children:"💡 Κάντε κλικ στα κελιά για επεξεργασία • Χρησιμοποιήστε τα κουμπιά για διαχείριση"})})]})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>re(!1),className:"flex-1 px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl hover:from-gray-600 hover:to-gray-700 transition-all duration-200 font-semibold shadow-lg",children:"❌ Ακύρωση"}),e.jsxs("button",{onClick:()=>{console.log("[AdminPanel] Button clicked - trainingType:",n,"selectedUserId:",m.selectedUserId),zl()},disabled:n==="individual"||n==="combination"?!m.selectedUserId:g.length===0,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-200 font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-green-500 disabled:hover:to-emerald-500",title:n==="individual"||n==="combination"?m.selectedUserId?"Δημιουργία Προγράμματος":"Παρακαλώ επιλέξτε χρήστη":g.length===0?"Παρακαλώ επιλέξτε χρήστες":"Δημιουργία Προγράμματος",children:["✅ Δημιουργία Προγράμματος",(n==="individual"||n==="combination")&&!m.selectedUserId&&e.jsx("span",{className:"ml-2 text-xs opacity-75",children:"(Επιλέξτε χρήστη)"})]})]})]})]})}),Pl&&ft&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 max-w-md mx-4 border border-gray-600 shadow-2xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ss,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Κλείδωμα Δόσης"}),e.jsxs("p",{className:"text-gray-300 mb-8 text-lg",children:["Είστε σίγουροι ότι θέλετε να κλειδώσετε την ",ft.installmentNumber,"η δόση; Αυτή η ενέργεια δεν μπορεί να αναιρεθεί."]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:bn,className:"flex-1 px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors font-medium",children:"Ακύρωση"}),e.jsx("button",{onClick:hn,className:"flex-1 px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl hover:from-orange-600 hover:to-orange-700 transition-all font-medium",children:"Κλείδωμα"})]})]})})}),Sl&&Fs&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 max-w-md mx-4 border border-gray-600 shadow-2xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(et,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Διαγραφή 3ης Δόσης"}),e.jsx("p",{className:"text-gray-300 mb-8 text-lg",children:"Είστε σίγουροι ότι θέλετε να διαγράψετε την 3η δόση; Αυτή η ενέργεια δεν μπορεί να αναιρεθεί."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:yn,className:"flex-1 px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors font-medium",children:"Ακύρωση"}),e.jsx("button",{onClick:fn,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all font-medium",children:"Διαγραφή"})]})]})})}),Q&&h&&H&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Διαχείριση Ομαδικών Αναθέσεων"}),e.jsx("button",{onClick:()=>{be(!1),$(null),De(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ke,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx(mo,{selectedUser:h,programId:H,weeklyFrequency:v,onAssignmentComplete:()=>{const s=g.findIndex(t=>t===h.id);if(s<g.length-1){const t=g[s+1],r=A.find(l=>l.id===t);r&&D.from("personal_training_schedules").select("id").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(1).then(({data:l})=>{l&&l.length>0&&($(r),De(l[0].id),c.success(`Μετάβαση στον επόμενο χρήστη: ${r.firstName} ${r.lastName}`))})}else c.success("Όλες οι αναθέσεις ολοκληρώθηκαν!"),be(!1),$(null),De(null)}})})]})}),p==="ultimate-subscriptions"&&!W&&e.jsx(ho,{fallback:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-6 w-24 h-24 mx-auto mb-6",children:e.jsx(tr,{className:"h-12 w-12 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Σφάλμα στη φόρτωση Ultimate Συνδρομών"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Παρουσιάστηκε ένα σφάλμα. Παρακαλώ ανανεώστε τη σελίδα ή δοκιμάστε ξανά."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Ανανέωση Σελίδας"})]}),children:e.jsx("div",{className:"space-y-6",children:e.jsx(go,{ultimateRequests:Ds,ultimateLoading:It,ultimateSearchTerm:ul,setUltimateSearchTerm:hl,selectedRequestOptions:mr,handleRequestOptionChange:en,updateInstallmentAmounts:jn,deleteUltimateRequest:xn,loadUltimateRequests:es,handleApproveRequest:gn,handleRejectRequest:un,loading:W,requestProgramApprovalStatus:is,handleRequestProgramApprovalChange:yt,handleSaveRequestProgramOptions:tn,handleUnfreezeRequestProgramOptions:rn,requestPendingUsers:bt,requestFrozenOptions:pt,ultimateRequestFrozenWithPending:_l})})})]})};export{To as default};
